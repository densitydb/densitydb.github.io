{"version":3,"file":"881.js","sources":["webpack://assets/./src/urban-stats-script/DebugEditorPanel.tsx"],"sourcesContent":["import React, { ReactNode, useEffect } from 'react'\n\nimport { PageTemplate } from '../page_template/template'\nimport { TestUtils } from '../utils/TestUtils'\n\nimport { Editor } from './Editor'\nimport { useStandaloneEditorState } from './StandaloneEditor'\nimport { Range } from './editor-utils'\n\ntype Selections = [Range | null, Range | null]\n\n/**\n * This panel used for developing + debugging editor functionality.\n */\nexport function DebugEditorPanel(props: { undoChunking?: number }): ReactNode {\n    const { uss, setUss, typeEnvironment, results, selection, setSelection, undoRedoUi } = useStandaloneEditorState<Selections>({\n        ident: 'editor-panel',\n        getCode: () => localStorage.getItem('editor-code') ?? '',\n        onChange: (newScript) => { localStorage.setItem('editor-code', newScript) },\n        getSelection: () => [null, null],\n        undoRedoOptions: {\n            undoChunking: props.undoChunking,\n        },\n    })\n\n    useEffect(() => {\n        const listener = (e: KeyboardEvent): void => {\n            const isMac = navigator.userAgent.includes('Mac') && !TestUtils.shared.isTesting\n            // TestCafe doesn't send `e.code`, so we need to use `toLowerCase` otherwise the char is capitalized on Mac\n            if (e.key.toLowerCase() === 's' && (isMac ? e.metaKey : e.ctrlKey) && e.shiftKey) {\n                e.preventDefault()\n                setSelection([selection[1], selection[0]])\n            }\n            if (e.key.toLowerCase() === 'd' && (isMac ? e.metaKey : e.ctrlKey) && e.shiftKey) {\n                e.preventDefault()\n                setSelection([null, null])\n            }\n        }\n        window.addEventListener('keydown', listener)\n        return () => { window.removeEventListener('keydown', listener) }\n    })\n\n    return (\n        <PageTemplate>\n            {/* Most props to the editors are purposely not memoized for testing purposes. */}\n            <div id=\"test-editor-panel\">\n                <Editor\n                    uss={uss}\n                    setUss={setUss}\n                    typeEnvironment={typeEnvironment}\n                    results={results}\n                    placeholder=\"Enter Urban Stats Script\"\n                    selection={selection[0]}\n                    setSelection={(newSelection) => {\n                        setSelection([newSelection, selection[1]])\n                    }}\n                />\n                <Editor\n                    uss={uss}\n                    setUss={setUss}\n                    typeEnvironment={typeEnvironment}\n                    results={results}\n                    placeholder=\"Enter Urban Stats Script\"\n                    selection={selection[1]}\n                    setSelection={(newSelection) => {\n                        setSelection([selection[0], newSelection])\n                    }}\n                />\n                {undoRedoUi}\n            </div>\n        </PageTemplate>\n    )\n}\n"],"names":["DebugEditorPanel","props","_useStandaloneEditorState","_localStorage_getItem","newScript","localStorage","uss","setUss","typeEnvironment","results","selection","setSelection","undoRedoUi","useEffect","listener","e","isMac","navigator","TestUtils","window","PageTemplate","Editor","newSelection"],"mappings":"wMAcO,SAASA,EAAiBC,CAAgC,EAC7D,IAAuFC,EAAAA,AAAAA,GAAAA,EAAAA,CAAAA,AAAAA,EAAqC,CACxH,MAAO,eACP,QAAS,W,IAAMC,E,OAAAA,MAAAA,CAAAA,EAAAA,aAAa,OAAO,CAAC,cAAa,EAAlCA,EAAuC,E,EACtD,SAAU,SAACC,CAAS,EAAOC,aAAa,OAAO,CAAC,cAAeD,EAAW,EAC1E,aAAc,W,MAAM,CAAC,KAAM,KAAK,A,EAChC,gBAAiB,CACb,aAAcH,EAAM,YAAY,AACpC,CACJ,GARQK,EAA+EJ,EAA/EI,GAAG,CAAEC,EAA0EL,EAA1EK,MAAM,CAAEC,EAAkEN,EAAlEM,eAAe,CAAEC,EAAiDP,EAAjDO,OAAO,CAAEC,EAAwCR,EAAxCQ,SAAS,CAAEC,EAA6BT,EAA7BS,YAAY,CAAEC,EAAeV,EAAfU,UAAU,CA2BlF,MAjBAC,AAAAA,GAAAA,EAAAA,SAAAA,AAAAA,EAAU,WACN,IAAMC,EAAW,SAACC,CAAC,EACf,IAAMC,EAAQC,UAAU,SAAS,CAAC,QAAQ,CAAC,QAAU,CAACC,EAAAA,CAAAA,CAAAA,MAAAA,CAAAA,SAA0B,AAEpD,OAAxBH,EAAE,GAAG,CAAC,WAAW,IAAeC,CAAAA,EAAQD,EAAE,OAAO,CAAGA,EAAE,OAAM,GAAMA,EAAE,QAAQ,GAC5EA,EAAE,cAAc,GAChBJ,EAAa,CAACD,CAAS,CAAC,EAAE,CAAEA,CAAS,CAAC,EAAE,CAAC,GAEjB,MAAxBK,EAAE,GAAG,CAAC,WAAW,IAAeC,CAAAA,EAAQD,EAAE,OAAO,CAAGA,EAAE,OAAM,GAAMA,EAAE,QAAQ,GAC5EA,EAAE,cAAc,GAChBJ,EAAa,CAAC,KAAM,KAAK,EAEjC,EAEA,OADAQ,OAAO,gBAAgB,CAAC,UAAWL,GAC5B,WAAQK,OAAO,mBAAmB,CAAC,UAAWL,EAAU,CACnE,GAGI,gBAACM,EAAAA,CAAYA,CAAAA,KAET,gBAAC,OAAI,GAAG,mB,EACJ,gBAACC,EAAAA,EAAMA,CAAAA,CACH,IAAKf,EACL,OAAQC,EACR,gBAAiBC,EACjB,QAASC,EACT,YAAY,2BACZ,UAAWC,CAAS,CAAC,EAAE,CACvB,aAAc,SAACY,CAAY,EACvBX,EAAa,CAACW,EAAcZ,CAAS,CAAC,EAAE,CAAC,CAC7C,C,GAEJ,gBAACW,EAAAA,EAAMA,CAAAA,CACH,IAAKf,EACL,OAAQC,EACR,gBAAiBC,EACjB,QAASC,EACT,YAAY,2BACZ,UAAWC,CAAS,CAAC,EAAE,CACvB,aAAc,SAACY,CAAY,EACvBX,EAAa,CAACD,CAAS,CAAC,EAAE,CAAEY,EAAa,CAC7C,C,GAEHV,GAIjB,C"}