"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([["134"],{64455:function(e,t,n){n.d(t,{JZ:()=>s,gw:()=>f,$k:()=>c});var r=n(72668),a=n(69610),o=n(27281),i=n(59070);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){var t,n,a=l((0,o.yu)("use_imperial"),1)[0],u=l((0,o.yu)("temperature_unit"),1)[0],c=(function(e){switch(e){case"percentage":return{renderValue:function(e){return{value:r.createElement("span",null,(100*e).toFixed(2)),unit:r.createElement("span",null,"%")}}};case"fatalities":return{renderValue:function(e){return{value:r.createElement("span",null,(0,i.HT)(e.toFixed(0))),unit:r.createElement("span",null,"\xa0")}}};case"fatalitiesPerCapita":return{renderValue:function(e){return{value:r.createElement("span",null,(1e5*e).toFixed(2)),unit:r.createElement("span",null,"/100k")}}};case"density":return{renderValue:function(e,t){var n="km",a=e;t&&(n="mi",a*=2.5899752356);var o=2;return a>10?o=0:a>1&&(o=1),{value:r.createElement("span",null,(0,i.HT)(a.toFixed(o))),unit:r.createElement("span",null,"/\xa0",n,r.createElement("sup",null,"2"))}}};case"population":return{renderValue:function(e){return e>1e9?{value:r.createElement("span",null,(e/1e9).toPrecision(3)),unit:r.createElement("span",null,"B")}:e>1e6?{value:r.createElement("span",null,(e/1e6).toPrecision(3)),unit:r.createElement("span",null,"m")}:e>1e4?{value:r.createElement("span",null,(e/1e3).toPrecision(3)),unit:r.createElement("span",null,"k")}:{value:r.createElement("span",null,(0,i.HT)(e.toFixed(0))),unit:r.createElement("span",null,"\xa0")}}};case"area":return{renderValue:function(e,t){var n,a=e;t?(a/=2.5899752356)<1?(n=r.createElement("span",null,"acres"),a*=640):n=r.createElement("span",null,"mi",r.createElement("sup",null,"2")):a<.01?(a*=1e6,n=r.createElement("span",null,"m",r.createElement("sup",null,"2"))):n=r.createElement("span",null,"km",r.createElement("sup",null,"2"));var o=3;a>100?o=0:a>10?o=1:a>1&&(o=2);var u=a.toFixed(o);return 0===o&&(u=(0,i.HT)(u)),{value:r.createElement("span",null,u),unit:n}}};case"distanceInKm":return{renderValue:function(e,t){var n=r.createElement("span",null,"km"),a=e;return t&&(n=r.createElement("span",null,"mi"),a/=1.60934),{value:r.createElement("span",null,a.toFixed(2)),unit:n}}};case"distanceInM":return{renderValue:function(e,t){var n="m",a=e;return t&&(n="ft",a*=3.28084),{value:r.createElement("span",null,(0,i.HT)(a.toFixed(0))),unit:r.createElement("span",null,n)}}};case"democraticMargin":return{renderValue:function(e){return{value:r.createElement(s,{value:e}),unit:r.createElement("span",null,"%")}}};case"temperature":return{renderValue:function(e,t,n){var a=r.createElement("span",null,"\xb0F"),o=e;return"celsius"===n&&(a=r.createElement("span",null,"\xb0C"),o=5/9*(e-32)),{value:r.createElement("span",null,o.toFixed(1)),unit:a}}};case"time":return{renderValue:function(e){var t=Math.floor(e),n=Math.floor((e-t)*60);return{value:r.createElement("span",null,t,":",n.toString().padStart(2,"0")),unit:r.createElement("span",null,"\xa0")}}};case"distancePerYear":return{renderValue:function(e,t){var n=100*e,a="cm";return t&&(a="in",n/=2.54),{value:r.createElement("span",null,n.toFixed(1)),unit:r.createElement("span",null,a,"/yr")}}};case"contaminantLevel":return{renderValue:function(e){return{value:r.createElement("span",null,e.toFixed(2)),unit:r.createElement("span",null,"μg/m",r.createElement("sup",null,"3"))}}};case"number":return{renderValue:function(e){return{value:r.createElement("span",null,e.toFixed(3)),unit:r.createElement("span",null,"\xa0")}}};case"usd":return{renderValue:function(e){return e>1e9?{value:r.createElement("span",null,"$",(e/1e9).toPrecision(3)),unit:r.createElement("span",null,"B")}:e>1e6?{value:r.createElement("span",null,"$",(e/1e6).toPrecision(3)),unit:r.createElement("span",null,"m")}:e>1e3?{value:r.createElement("span",null,"$",(e/1e3).toPrecision(3)),unit:r.createElement("span",null,"k")}:{value:r.createElement("span",null,"$",(0,i.HT)(e.toFixed(0))),unit:r.createElement("span",null,"\xa0")}}};case"minutes":return{renderValue:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);return t>0?{value:r.createElement("span",null,t,":",n.toString().padStart(2,"0")),unit:r.createElement("span",null,"\xa0")}:{value:r.createElement("span",null,n),unit:r.createElement("span",null,"\xa0")}}}}})(null!=(n=e.unit)?n:(t=e.statname).includes("%")||t.includes("Change")||t.includes("(Grade)")?"percentage":t.includes("Total")&&t.includes("Fatalities")?"fatalities":t.includes("Fatalities Per Capita")?"fatalitiesPerCapita":t.includes("Density")?"density":t.includes("Elevation")?"distanceInM":t.startsWith("Population")?"population":"Area"===t?"area":t.includes("Mean distance")?"distanceInKm":t.includes("Election")||t.includes("Swing")?"democraticMargin":t.includes("high temp")||t.includes("low temp")||t.includes("high heat index")||t.includes("dewpt")?"temperature":"Mean sunny hours"===t?"time":"Rainfall"===t||"Snowfall [rain-equivalent]"===t?"distancePerYear":t.includes("Pollution")?"contaminantLevel":t.includes("(USD)")?"usd":t.includes("(min)")?"minutes":"number").renderValue(e.value,a,u),f=c.value,p=c.unit;return r.createElement("span",{style:e.style},e.isUnit?p:f)}function s(e){var t=(0,a.cI)();if(e.value!=e.value)return r.createElement("span",null,"N/A");var n=100*Math.abs(e.value),o=n>10?1:n>1?2:n>.1?3:4,i=n.toFixed(o),u=e.value>0?"D":"R",l=e.value>0?t.hueColors.blue:t.hueColors.red;return r.createElement("span",{style:{color:l,display:"flex",justifyContent:"flex-end"}},u,"+",i)}function f(e){if(e.ordinal>e.total)return r.createElement("span",null);var t=e.percentileByPopulation,n="".concat(t,"th percentile");return e.simpleOrdinals?n="".concat(t.toString(),"%"):t%10==1&&t%100!=11?n="".concat(t,"st percentile"):t%10==2&&t%100!=12?n="".concat(t,"nd percentile"):t%10==3&&t%100!=13&&(n="".concat(t,"rd percentile")),r.createElement("div",{className:"serif",style:{textAlign:"right",marginRight:e.simpleOrdinals?"5px":void 0}},n)}},37475:function(e,t,n){n.r(t),n.d(t,{MapperPanel:()=>e8});var r=n(72668),a=n(45988),o=n(6135),i=n(65547),u=n(4050),l=n(45375),c=n(15638),s=n(45437),f=n(41623),p=n(46347),m=n(34672),d=n(54509),v=n(69851),y=n(27193),g=n(39517),b=n(84635),h=n(13736),E=n(77053);function w(e){return e*Math.PI/180*6378137}function S(e){return 6378137*Math.log(Math.tan(Math.PI/4+e*Math.PI/360))}function O(e){var t=w(e[0]),n=w(e[2]),r=S(e[1]);return Math.abs((n-t)*(S(e[3])-r))}function x(e){(0,E.h)(e.length>0,"No insets with coordBox");var t,n,r,a=e.reduce(function(e,t){return O(t.coordBox)>O(e.coordBox)?t:e}),o=a.coordBox,i=a.topRight[0]-a.bottomLeft[0],u=a.topRight[1]-a.bottomLeft[1];return t=w(o[0]),n=w(o[2]),r=S(o[1]),Math.abs(n-t)/Math.abs(S(o[3])-r)/(i/u)}var j=n(2414),P=n(64455),M=n(69610);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t,n,a=(0,M.cI)();return r.createElement("div",{style:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({width:"100%"},"none"===e.basemap.type?{backgroundColor:e.basemap.backgroundColor,color:e.basemap.textColor}:{backgroundColor:a.background}),n=n={padding:"10px"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)},e.ramp&&"label"===e.ramp.type&&r.createElement("div",{className:"centered_text user_input"},e.ramp.value),e.ramp&&"ramp"===e.ramp.type&&r.createElement(R,{ramp:e.ramp.value}))}function R(e){var t,n=e.ramp,a=(0,r.useRef)(null),o=(t=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return k(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],u=o[1];(0,r.useLayoutEffect)(function(){var e=a.current;if(null!==e){var t=function(){u(Array.from(e.querySelectorAll(".containerOfXticks")).some(function(e){var t=e.querySelector(".containedOfXticks");return null!==t&&t.offsetWidth>.9*e.offsetWidth}))};t();var n=new ResizeObserver(t);return n.observe(e),function(){n.unobserve(e)}}},[n]);var l=(0,r.useMemo)(function(){return(0,h.oX)(n.ramp.map(function(e){return e[1]}))},[n]),c="".concat(100/n.interpolations.length,"%"),s=function(e){return n.interpolations.map(function(t,a){return r.createElement("div",{key:a,style:{width:c,display:"flex",alignItems:"center",justifyContent:"center"},className:"containerOfXticks"},r.createElement("div",{style:{writingMode:e?"sideways-lr":"horizontal-tb",padding:e?"0.5em":"0"},className:"containedOfXticks"},r.createElement("div",{className:"centered_text"},r.createElement(P.$k,{statname:n.label,value:t,isUnit:!1,unit:n.unit}),r.createElement(P.$k,{statname:n.label,value:t,isUnit:!0,unit:n.unit}))))})};return r.createElement("div",{style:{position:"relative"}},r.createElement("div",{style:{display:"flex",width:"100%"}},n.interpolations.map(function(e,t){return r.createElement("div",{key:t,style:{width:c,height:"1em",backgroundColor:(0,h.BM)(n.ramp,n.scale.forward(e),l),marginLeft:"1px",marginRight:"1px"}})})),r.createElement("div",{ref:a,style:{position:"absolute",top:0,left:0,display:"flex",width:"100%",visibility:"hidden"}},s(!1)),r.createElement("div",{style:{display:"flex",width:"100%"}},s(i)),r.createElement("div",{className:"centered_text user_input"},n.label))}var A=n(45844),C=n(51647);function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function B(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||L(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}}var U=r.forwardRef(function(e,t){var n,a=e.inset,u=e.children,l=e.editInset,c=e.container,s=e.i,f=e.numInsets,p=(0,M.cI)(),m="map-".concat(s),d=(0,i.Lm)();return r.createElement("div",{id:m,style:{position:"absolute",left:"".concat(100*a.bottomLeft[0],"%"),bottom:"".concat(100*a.bottomLeft[1],"%"),width:"".concat((a.topRight[0]-a.bottomLeft[0])*100,"%"),height:"".concat((a.topRight[1]-a.bottomLeft[1])*100,"%")}},r.createElement(o.yq,{ref:t,style:{position:"absolute",inset:0,border:a.mainMap?"".concat(i.C4,"px solid ").concat(p.borderNonShadow):"".concat(o.uE,"px solid ").concat(p.mapInsetBorderColor),borderRadius:!a.mainMap||d?"0px":"".concat(i.RS,"px"),width:void 0,height:void 0},attributionControl:!1},u,r.createElement(z,{inset:a,setCoordBox:function(e){null==l||l.modify({coordBox:e})}}),r.createElement(T,{id:m}),a.mainMap&&r.createElement(o.X3,{startShowingAttribution:!0})),l&&r.createElement(V,{frame:B(a.bottomLeft).concat(B(a.topRight)),setFrame:function(e){l.modify({bottomLeft:[e[0],e[1]],topRight:[e[2],e[3]]})},container:c,delete:a.mainMap?void 0:l.delete,duplicate:a.mainMap?void 0:l.duplicate,add:a.mainMap?l.add:void 0,shouldHaveCenterHandle:!a.mainMap||!(.005>Math.abs((n=a).bottomLeft[0]-0)&&.005>Math.abs(n.bottomLeft[1]-0)&&.005>Math.abs(n.topRight[0]-1)&&.005>Math.abs(n.topRight[1]-1)),moveUp:s+1<f?function(){l.moveUp()}:void 0,moveDown:s>0?function(){l.moveDown()}:void 0}))});function z(e){var t=e.inset,n=e.setCoordBox,a=(0,A.Sx)().current;return(0,r.useEffect)(function(){var e=function(){a.fitBounds(t.coordBox,{animate:!1})};return e(),a.on("resize",e),function(){a.off("resize",e)}},[t,a]),(0,r.useEffect)(function(){var e=function(){var e=a.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return[t.lng,t.lat,n.lng,n.lat]},t=function(t){void 0!==t.originalEvent&&n(e())};return a.on("moveend",t),function(){a.off("moveend",t)}},[a,n]),null}function T(e){var t=e.id,n=(0,A.Sx)().current.getMap();return C.k.shared.maps.set(t,new WeakRef(n)),null}function V(e){var t=(0,r.useRef)(void 0),n=function(n){return{"data-test":n,onPointerDown:function(r){if(void 0===t.current){var a=r.target;t.current={kind:n,startX:r.clientX,startY:r.clientY,startFrame:e.frame,pointerId:r.pointerId},a.setPointerCapture(r.pointerId)}},onPointerMove:function(n){if((null==(r=t.current)?void 0:r.pointerId)===n.pointerId){var r,a,o=t.current,i=e.container.current.getBoundingClientRect(),u=(n.clientX-o.startX)/i.width,l=-(n.clientY-o.startY)/i.height,c=[Math.max(0,Math.min(o.startFrame[0]+u,o.startFrame[2]-.05)),Math.max(0,Math.min(o.startFrame[1]+l,o.startFrame[3]-.1)),Math.max(o.startFrame[0]+.05,Math.min(o.startFrame[2]+u,1)),Math.max(o.startFrame[1]+.1,Math.min(o.startFrame[3]+l,1))];switch(o.kind){case"move":var s=Math.max(0-o.startFrame[0],Math.min(u,1-o.startFrame[2])),f=Math.max(0-o.startFrame[1],Math.min(l,1-o.startFrame[3]));a=[o.startFrame[0]+s,o.startFrame[1]+f,o.startFrame[2]+s,o.startFrame[3]+f];break;case"topRight":a=[o.startFrame[0],o.startFrame[1],c[2],c[3]];break;case"bottomRight":a=[o.startFrame[0],c[1],c[2],o.startFrame[3]];break;case"bottomLeft":a=[c[0],c[1],o.startFrame[2],o.startFrame[3]];break;case"topLeft":a=[c[0],o.startFrame[1],o.startFrame[2],c[3]]}e.setFrame(a)}},onPointerUp:function(e){var n;(null==(n=t.current)?void 0:n.pointerId)===e.pointerId&&(t.current=void 0)},onPointerCancel:function(e){var n;(null==(n=t.current)?void 0:n.pointerId)===e.pointerId&&(t.current=void 0)}}};return r.createElement(r.Fragment,null,r.createElement(N,D({handleSize:15,style:{right:"-".concat(o.uE,"px"),top:"-".concat(o.uE,"px"),cursor:"nesw-resize"}},n("topRight"))),r.createElement(N,D({handleSize:15,style:{right:"-".concat(o.uE,"px"),bottom:"-".concat(o.uE,"px"),cursor:"nwse-resize"}},n("bottomRight"))),r.createElement(N,D({handleSize:15,style:{left:"-".concat(o.uE,"px"),bottom:"-".concat(o.uE,"px"),cursor:"nesw-resize"}},n("bottomLeft"))),r.createElement(N,D({handleSize:15,style:{left:"-".concat(o.uE,"px"),top:"-".concat(o.uE,"px"),cursor:"nwse-resize"}},n("topLeft"))),e.shouldHaveCenterHandle&&r.createElement(N,D({handleSize:20,style:{margin:"auto",left:"calc(50% - 10px)",top:"calc(50% - 10px)",cursor:"move"}},n("move"))),e.duplicate&&r.createElement(N,{handleSize:25,"data-test":"duplicate",style:{margin:"auto",left:"calc(66% - 12.5px)",textAlign:"center",lineHeight:"25px",top:-o.uE,cursor:"copy"},onClick:e.duplicate,img:{src:"/duplicate.png",alt:"Duplicate"}}),e.delete&&r.createElement(N,{handleSize:25,"data-test":"delete",style:{margin:"auto",left:"calc(33% - 12.5px)",textAlign:"center",lineHeight:"25px",top:-o.uE,cursor:"default"},onClick:e.delete,img:{src:"/close-red-small.png",alt:"Delete"}}),e.add&&r.createElement(N,{handleSize:25,"data-test":"add",style:{margin:"auto",left:"calc(50% - 12.5px)",textAlign:"center",top:-o.uE,cursor:"default"},onClick:e.add,img:{src:"/add-green-small.png",alt:"Add"}}),e.moveUp&&r.createElement(N,{handleSize:25,"data-test":"moveUp",style:{left:"-".concat(o.uE,"px"),textAlign:"center",top:"calc(50% - 25px)",cursor:"default"},onClick:e.moveUp,img:{src:"/sort-up.png",alt:"Move Up"}}),e.moveDown&&r.createElement(N,{handleSize:25,"data-test":"moveDown",style:{left:"-".concat(o.uE,"px"),textAlign:"center",top:"calc(50%)",cursor:"default"},onClick:e.moveDown,img:{src:"/sort-down.png",alt:"Move Down"}}))}function N(e){var t,n=e.handleSize,a=e.style,o=e.img,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["handleSize","style","img"]),u=(0,M.cI)(),l=(t=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(t,2)||L(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],s=l[1],f=(0,r.useRef)(null);return(0,r.useEffect)(function(){var e=function(){s(!0)},t=function(){s(!1)},n=f.current;return n.addEventListener("mouseenter",e),n.addEventListener("mouseleave",t),function(){n.removeEventListener("mouseenter",e),n.removeEventListener("mouseleave",t)}},[]),r.createElement("div",D({ref:f,role:"button",style:D({backgroundColor:c?u.slightlyDifferentBackgroundFocused:u.slightlyDifferentBackground,border:"1px solid ".concat(u.textMain),position:"absolute",width:"".concat(n,"px"),height:"".concat(n,"px"),borderRadius:"2px"},a)},i),o&&r.createElement("img",{src:o.src,alt:o.alt,style:{width:"100%",height:"100%"}}))}var K=n(99448);function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t,n,r,a,o,i){try{var u=e[o](i),l=u.value}catch(e){n(e);return}u.done?t(l):Promise.resolve(l).then(r,a)}function X(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){H(o,r,a,i,u,"next",e)}function u(e){H(o,r,a,i,u,"throw",e)}i(void 0)})}}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function $(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(e,t)||Z(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}}function q(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=u(0),i.throw=u(1),i.return=u(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(l){var c=[u,l];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}function Y(e){var t=e.mapSettings,n=(0,r.useRef)({}),a=(0,r.useRef)(Date.now()),o=_((0,r.useState)(function(){return Q({mapSettings:t,cache:n.current,previousGenerator:void 0})}),2),i=o[0],u=o[1];(0,r.useEffect)(function(){var e=Date.now()-a.current;if(e>500){a.current=Date.now(),u(function(e){return Q({mapSettings:t,cache:n.current,previousGenerator:e})});return}a.current=Date.now();var r=setTimeout(function(){u(function(e){return Q({mapSettings:t,cache:n.current,previousGenerator:e})})},500-e);return function(){clearTimeout(r)}},[t]);var l=(0,j.a)(i),c=l.result,s=l.loading;return void 0!==c?$(W({},c),{ui:function(e){return c.ui($(W({},e),{loading:s}))}}):{ui:function(){return{node:r.createElement(en,{universe:t.universe,loading:s})}},errors:[]}}function Q(e){return X(function(e){var t,n,f,g,E,w,S,O,j,P,M,k,R,A,C,F,D,B;function L(e){var t=e.props,n=e.exportPngRef,a=[],o=(0,r.useRef)(null),u=(0,r.useRef)(null),l=("insets"===t.mode?t.editInsets.editedInsets:k.value.insets).flatMap(function(e){var n,r,a,o=(n=e,r=F,a=n.coordBox,n.mainMap||(r=r.filter(function(e){var t=(0,c.boundingBox)(e.geometry);return t.getWest()<a[2]&&t.getEast()>a[0]&&t.getNorth()>a[1]&&t.getSouth()<a[3]})),r);return 0===o.length&&"insets"!==t.mode?[]:[{inset:e,insetFeatures:o}]}),s=l.map(function(e,n,i){var u=e.inset,l=e.insetFeatures;return r.createElement(U,{i:n,key:n,inset:u,ref:function(e){return a[n]=e},container:o,numInsets:i.length,editInset:"insets"===t.mode?{modify:function(e){t.editInsets.modify(n,e)},delete:function(){t.editInsets.delete(n)},duplicate:function(){t.editInsets.duplicate(n)},add:t.editInsets.add,moveUp:function(){t.editInsets.moveUp(n)},moveDown:function(){t.editInsets.moveDown(n)}}:void 0},D(l,["uss","view"].includes(t.mode)))}),f=l.map(function(e){return e.inset}),p=r.createElement(I,{ramp:B,basemap:k.value.basemap}),m=_((0,r.useState)(!1),2),d=m[0],v=m[1];return n(function(){return X(function(){var e;return q(this,function(t){return v(!0),e=a.map(function(e){return e.getMap()}).map(function(e){var t,n=e.getPixelRatio();e.setPixelRatio(4);var r=e.getContainer().querySelector(".maplibregl-ctrl-attrib");if(null!==r){var a=r.style.display;r.style.display="none",t=function(){return r.style.display=a}}return function(){e.setPixelRatio(n),null==t||t()}}),[2,new Promise(function(t){setTimeout(function(){return X(function(){return q(this,function(n){switch(n.label){case 0:return[4,(0,i.d_)(u.current,4*er,1,{mapBorderRadius:0,testing:!1})];case 1:return t(n.sent().toDataURL("image/png")),v(!1),e.forEach(function(e){e()}),[2]}})})()})})]})})()}),r.createElement(i.t.Provider,{value:d},r.createElement(ee,{maps:s,loading:t.loading,colorbar:p,aspectRatio:x(f),mapsContainerRef:o,wholeRenderRef:u}))}return q(this,function(i){switch(i.label){case 0:if(t=e.mapSettings,n=e.cache,f=e.previousGenerator,g=function(e){var n=e.loading;return{node:r.createElement(en,{universe:t.universe,loading:n})}},void 0===t.geographyKind||void 0===t.universe)return[2,{ui:g,errors:[{kind:"error",type:"error",value:"Select a Universe and Geography Kind",location:y.tU}]}];if(E=(0,K.computeUSS)(t.script),!((w=(0,m.ZP)(E)).length>0))return[3,2];return[4,f];case 1:return[2,$(W({},S=i.sent()),{ui:null!=(O=null==S?void 0:S.ui)?O:g,errors:w.map(function(e){return $(W({},e),{kind:"error"})})})];case 2:return[4,(0,b.W)({descriptor:{kind:"mapper",geographyKind:t.geographyKind,universe:t.universe},stmts:E})];case 3:if(void 0!==(j=i.sent()).resultingValue)return[3,5];return[4,f];case 4:return[2,$(W({},P=i.sent()),{ui:null!=(M=null==P?void 0:P.ui)?M:g,errors:j.error})];case 5:return k=j.resultingValue.value,R=(0,a.lM)(k,j.context),A="".concat(t.geographyKind,"-").concat(t.universe,"-data.csv"),[4,function(e){return X(function(e){var t,n,a,i,f,m,y,g,b,E,w,S,O,x,j;return q(this,function(P){var M,k,I,R,A,C,F,D;switch(P.label){case 0:switch(n=(t=e.mapResultMain).opaqueType,a=t.value,i=e.universe,f=e.geographyKind,m=e.cache,n){case"pMap":case"cMap":b=(0,v._K)(a.scale),E=(0,h.oX)(a.ramp.map(function(e){return e[1]})),w=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1].map(b.inverse),y={type:"ramp",value:{ramp:a.ramp,interpolations:w,scale:b,label:a.label,unit:a.unit}},g=a.data.map(function(e){return(0,h.BM)(a.ramp,b.forward(e),E)});break;case"cMapRGB":g=a.dataR.map(function(e,t){return(0,d.XF)({r:e,g:a.dataG[t],b:a.dataB[t],a:1})}),y={type:"label",value:a.label}}switch(n){case"pMap":return[3,1];case"cMap":case"cMapRGB":return[3,3]}return[3,5];case 1:return x=Array.from(a.data.entries()).map(function(e){var t=_(e,2),n=t[0],r=t[1];return{name:a.geo[n],fillColor:g[n],fillOpacity:1,radius:Math.sqrt(a.relativeArea[n])*a.maxRadius,statistic:r}}),[4,(M=f,k=i,I=x,R=m,X(function(){var e,t,n,r,a;return q(this,function(o){switch(o.label){case 0:if((null==(e=R.geo)?void 0:e.type)==="points"&&R.geo.universe===k&&R.geo.geographyKind===M)return[3,3];return t=(0,s.Tw)(k,M),[4,(0,l.gi)(t,"ArticleOrderingList")];case 1:return n=o.sent(),[4,(0,p.y7)(k,M,n.longnames)];case 2:r=o.sent(),R.geo={type:"points",universe:k,geographyKind:M,centroidsByName:new Map(n.longnames.map(function(e,t){return[e,r[t]]}))},o.label=3;case 3:return a=R.geo,[2,I.map(function(e){var t=a.centroidsByName.get(e.name);return{type:"Feature",properties:W({},e),geometry:{type:"Point",coordinates:[t.lon,t.lat]}}})]}})})())];case 2:return S=P.sent(),O=function(e,t){return r.createElement(o.Oy,{features:e,clickable:t})},[3,5];case 3:return j=Array.from(g.entries()).map(function(e){var t,r=_(e,2),o=r[0],i=r[1];switch(n){case"cMap":t={statistic:a.data[o]};break;case"cMapRGB":t={statistic:[a.dataR[o],a.dataG[o],a.dataB[o]]}}return W({name:a.geo[o],fillColor:i,fillOpacity:1,color:(0,d.XF)(a.outline.color),weight:a.outline.weight},t)}),[4,(A=f,C=i,F=j,D=m,X(function(){var e,t,n,r,a,o;return q(this,function(i){switch(i.label){case 0:if((null==(e=D.geo)?void 0:e.type)==="polygons"&&D.geo.universe===C&&D.geo.geographyKind===A)return[3,2];return t=u.Z.indexOf(C),[4,(0,l.gi)((0,s.UM)(A),"ConsolidatedShapes")];case 1:for(a=0,n=i.sent(),r=new Map;a<n.longnames.length;a++)n.universes[a].universeIdxs.includes(t)&&r.set(n.longnames[a],(0,c.geometry)(n.shapes[a]));D.geo={type:"polygons",universe:C,geographyKind:A,polygonsByName:r},i.label=2;case 2:return o=D.geo,[2,F.map(function(e){return{type:"Feature",properties:W({},e),geometry:o.polygonsByName.get(e.name)}})]}})})())];case 4:return S=P.sent(),O=function(e,t){return r.createElement(o.uy,{features:e,clickable:t})},[3,5];case 5:return[2,{features:S,mapChildren:function(e,t){return r.createElement(r.Fragment,null,O(e,t),r.createElement(o.Es,{basemap:a.basemap}))},ramp:y}]}})}).apply(this,arguments)}({mapResultMain:k,universe:t.universe,geographyKind:t.geographyKind,cache:n})];case 6:return F=(C=i.sent()).features,D=C.mapChildren,B=C.ramp,[2,{errors:j.error,exportCSV:{csvData:R,csvFilename:A},exportGeoJSON:function(){return JSON.stringify({type:"FeatureCollection",features:F},null,2)},ui:function(e){var t;return{node:r.createElement(L,{props:e,exportPngRef:function(e){return t=e}}),exportPng:function(){return t()}}}}]}})}).apply(this,arguments)}function ee(e){var t=e.maps,n=e.colorbar,a=e.loading,o=e.mapsContainerRef,i=e.aspectRatio,u=e.wholeRenderRef;return r.createElement(ea,null,r.createElement("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"relative",minHeight:0}},r.createElement(et,{loading:a}),r.createElement("div",{style:{width:"100%",aspectRatio:i}},r.createElement("div",{ref:o,style:{aspectRatio:i,position:"relative",maxHeight:"100%",margin:"auto"}},t)),n))}function et(e){var t=e.loading;return r.createElement(f.WU,{containerStyleOverride:{position:"absolute",transition:"opacity 0.25s",opacity:+!!t,pointerEvents:"none"}})}function en(e){var t=e.universe,n=e.loading,a=(0,g.v)(null!=t?t:"world");return r.createElement(ee,{maps:a.map(function(e,t){return r.createElement(U,{i:t,key:t,inset:e,container:r.createRef(),numInsets:a.length},null)}),loading:n,colorbar:null,aspectRatio:x(a)})}var er=1200;function ea(e){var t=e.children,n=_((0,r.useState)({scale:1,top:0,left:0}),2),a=n[0],o=n[1],i=(0,r.useRef)(null),u=(0,r.useRef)(null);return(0,r.useEffect)(function(){var e=function(){if(null!==i.current&&null!==u.current){var e,t=(e=Math).min.apply(e,J([i.current.offsetWidth/er].concat(J(i.current.offsetHeight>0?[i.current.offsetHeight/u.current.offsetHeight]:[]))));o({scale:t,top:Math.max(0,(i.current.offsetHeight-u.current.offsetHeight*t)/2),left:Math.max(0,(i.current.offsetWidth-u.current.offsetWidth*t)/2)})}};e();var t=new ResizeObserver(e);return t.observe(i.current),t.observe(u.current),function(){t.disconnect()}},[]),r.createElement("div",{ref:i,style:{position:"absolute",inset:0}},r.createElement("div",{ref:u,style:{transform:"scale(".concat(a.scale,")"),transformOrigin:"top left",width:"".concat(er,"px"),position:"relative",top:"".concat(a.top,"px"),left:"".concat(a.left,"px")}},t))}var eo=n(58788),ei=n(6381),eu=n(27281),el=n(8672),ec=n(81600),es=n(88452),ef=n(89147),ep=n(36195),em=n(36405),ed=n(41486),ev=n(88609),ey=n(52594),eg=n(46207);function eb(e,t,n,r,a,o,i){try{var u=e[o](i),l=u.value}catch(e){n(e);return}u.done?t(l):Promise.resolve(l).then(r,a)}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eE(e){var t=e.mapSettings,n=e.setMapSettings;return r.createElement("div",{style:{display:"flex",gap:"0.5em",margin:"0.5em 0"}},r.createElement("button",{onClick:function(){var e;return(e=function(){var e,t;return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=u(0),i.throw=u(1),i.return=u(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(l){var c=[u,l];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,eg.c)(".uss")];case 1:if((e=r.sent())===eg.B)return[2];return[4,e.text()];case 2:if(!(t=eS.apply(void 0,[r.sent()])).success)return alert(t.error),[2];return n(t.mapSettings),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){eb(o,r,a,i,u,"next",e)}function u(e){eb(o,r,a,i,u,"throw",e)}i(void 0)})})()}},"Import Script"),r.createElement("button",{onClick:function(){var e;(0,ed.saveAs)(new Blob([(e=t,'meta(kind="mapper", universe="'.concat(e.universe,'", geographyKind="').concat(e.geographyKind,'")\n').concat((0,es.Z2)(e.script.uss)))]),"urban_stats_mapper.uss")}},"Export Script"))}var ew=ev.z.object(eh({kind:ev.z.literal("mapper")},K.mapperMetaFields.shape));function eS(e){var t,n,r=(0,es.Qc)(e);if("error"===r.type)return{success:!1,error:"Parse Errors:\n".concat(r.errors.map(function(e){return"• ".concat(e.value," at ").concat((0,ey.i7)(e.location))}).join("\n"))};var a=void 0;if("statements"===r.type&&"expression"===r.result[0].type&&"call"===r.result[0].value.type&&"identifier"===r.result[0].value.fn.type&&"meta"===r.result[0].value.fn.name.node){var o=r.result[0].value;r.result.splice(0,1);var i=[],u=!0,l=!1,c=void 0;try{for(var s,f=o.args[Symbol.iterator]();!(u=(s=f.next()).done);u=!0){var p=s.value;if("unnamed"===p.type)return{success:!1,error:'"meta" function call at '.concat((0,ey.i7)(o.entireLoc)," must have only named arguments")};if("constant"!==p.value.type)return{success:!1,error:'"meta" function argument "'.concat(p.name.node,'" must have a constant value')};i.push([p.name.node,p.value.value.node.value])}}catch(e){l=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(l)throw c}}var m=ew.safeParse(Object.fromEntries(i));if(!m.success)return{success:!1,error:"Error parsing metadata: ".concat(Object.values(m.error.flatten(function(e){return'• Parameter "'.concat(e.path,'" is ').concat(e.message)}).fieldErrors).join("\n"))};a=m.data}return{success:!0,mapSettings:(0,K.defaultSettings)((t=eh({},a),n=n={script:{uss:(0,K.convertToMapUss)(r)}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}}var eO=n(83929),ex={fontWeight:500,fontSize:"1.2em",marginBottom:"0.125em",marginTop:"0.25em"},ej=n(30444),eP=n(78233);function eM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ek(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eI(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function eR(e){return function(e){if(Array.isArray(e))return eM(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return eM(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eM(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eA(e){var t=e.mapSettings,n=e.setMapSettings,a=e.errors,o=e.counts,i=e.typeEnvironment,l=t.script.uss,c=(0,r.useCallback)(function(e){return{text:null!=e?e:""}},[]),s=(0,r.useMemo)(function(){return[void 0].concat(eR(u.Z))},[]),f=(0,r.useMemo)(function(){return void 0===t.universe?void 0:[void 0].concat(eR((0,eO.d)(o,t.universe)))},[t.universe,o]);return r.createElement(r.Fragment,null,r.createElement("div",{style:ex},"Universe"),r.createElement(ej.S,{possibleValues:s,value:t.universe,renderValue:c,onChange:function(e){n(eI(ek({},t),{universe:e,geographyKind:void 0===e||void 0===t.geographyKind||(0,eO.d)(o,e).includes(t.geographyKind)?t.geographyKind:void 0}))}}),f&&r.createElement(r.Fragment,null,r.createElement("div",{style:ex},"Geography Kind"),r.createElement(ej.S,{possibleValues:f,value:t.geographyKind,renderValue:c,onChange:function(e){n(eI(ek({},t),{geographyKind:e}))}})),r.createElement(eP.ag,{uss:l,setUss:function(e){n(eI(ek({},t),{script:{uss:e}}))},typeEnvironment:i,errors:a}))}var eC=n(65344),eF=n(44640);function eD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eB(e){return function(e){if(Array.isArray(e))return eD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eL(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eL(e,t){if(e){if("string"==typeof e)return eD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eD(e,t)}}function eU(e,t,n){var r=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(t,2)||eL(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=r[0],o=r[1];return function(t){var r=e(t);return eB(r.slice(0,a)).concat(eB(n),eB(r.slice(o)))}}function ez(e,t,n){return function(r){var a=e(r),o=a[t],i=a[n],u=Array.from(a);return u[n]=o,u[t]=i,u}}var eT=n(73001);function eV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eN=eT.Ry({north:eT.Rx(),east:eT.Rx(),south:eT.Rx(),west:eT.Rx()}),eK=eT.n0(eT.Rf(eT.RE({fn:eT.QU("constructInset"),unnamedArgs:[],namedArgs:{mainMap:eT.O7(),name:eT.Z_(),screenBounds:eN,mapBounds:eN}})),function(e){var t=e.namedArgs,n=t.screenBounds,r=t.mapBounds,a=t.mainMap,o=t.name;return{bottomLeft:[n.west,n.south],topRight:[n.east,n.north],coordBox:[r.west,r.south,r.east,r.north],mainMap:a,name:o}}),eG=eT.n0(eT.RE({fn:eT.QU("constructInsets"),namedArgs:{},unnamedArgs:[eT.sS(eK)]}),function(e){return e.unnamedArgs[0]}),eH=eT.x2(eT.gh([eT.ID(),eT.s2({condition:eT.ID(),rest:[eT.th(eT.Hw(eP.Qc,eP.Py,eT.RE({fn:eT.ID(),unnamedArgs:[],namedArgs:{insets:eT.eP(eT.jt(eT.Rf(eG)))}})))]})]),function(e){return e[1].rest[0].namedArgs.insets});function eX(e,t){if("statements"===e.script.uss.type)try{var n,r=eH.parse(e.script.uss,t);if(void 0===r.currentValue&&void 0!==e.universe)return(0,g.v)(e.universe);return null==(n=r.currentValue)?void 0:n.currentValue}catch(e){}}function eW(e,t,n){var r=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eV(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eV(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=r[0],o=r[1];return{insets:eU(e.insets,[a,o],n),ast:eU(e.ast,[a,o],n.map(eF.Rf))}}function e$(e,t,n){return{insets:ez(e.insets,t,n),ast:ez(e.ast,t,n)}}function e_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eJ(e,t,n,r,a,o,i){try{var u=e[o](i),l=u.value}catch(e){n(e);return}u.done?t(l):Promise.resolve(l).then(r,a)}function eZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eq(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function eY(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,u=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(u)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e_(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eQ(e){var t=eY((0,r.useState)(e.mapSettings),2),n=t[0],a=t[1],o=eY((0,r.useState)("uss"),2),i=o[0],u=o[1],l=(0,r.useMemo)(function(){return new ef.Z(void 0)},[]),c=(0,ec.C5)(n,l.value,a,function(e){l.value=e},{undoChunking:C.k.shared.isTesting?2e3:1e3,onlyElement:"insets"===i?{current:null}:void 0}),s=c.updateCurrentSelection,f=c.addState,p=(0,r.useCallback)(function(e){a(e),f(e,l.value)},[l,f]),m=(0,r.useRef)(!0);(0,r.useEffect)(function(){m.current?m.current=!1:(p(e.mapSettings),u("uss"))},[e.mapSettings,p]);var d=JSON.stringify(eq(eZ({},n),{script:{uss:(0,es.Z2)(n.script.uss)}})),v=(0,r.useContext)(ei.C.Context);(0,r.useEffect)(function(){if(e.mapSettings!==n){var t=(0,eo.gzipSync)(d).toString("base64");v.setMapperSettings(t)}},[d,v]);var y=(0,r.useMemo)(function(){return(0,em.A)(n.universe)},[n.universe]);(0,r.useEffect)(function(){var e=function(){s(l.value)};return l.observers.add(e),function(){l.observers.delete(e)}},[l,s]);var g=Y({mapSettings:n}),b={mapSettings:n,setMapSettings:p,typeEnvironment:y,setMapEditorMode:u,mapGenerator:g};return r.createElement(el.P,{csvExportData:g.exportCSV,showFooter:!1},r.createElement(eC.I.Provider,{value:l},"insets"===i?r.createElement(e5,b):r.createElement(e0,eq(eZ({},b),{counts:e.counts})),"insets"!==i?c.ui:void 0))}function e0(e){var t=e.mapSettings,n=e.setMapSettings,a=e.counts,o=e.typeEnvironment,i=e.setMapEditorMode,u=e.mapGenerator,l=u.ui({mode:"uss"});return r.createElement(e1,{error:u.errors.some(function(e){return"error"===e.kind}),left:r.createElement(eA,{mapSettings:t,setMapSettings:n,errors:u.errors,counts:a,typeEnvironment:o}),right:r.createElement(r.Fragment,null,r.createElement("div",{style:{display:"flex",justifyContent:"space-between",gap:"0.5em"}},r.createElement(e6,{pngExport:l.exportPng,geoJSONExport:u.exportGeoJSON}),eX(t,o)&&r.createElement("div",{style:{display:"flex",gap:"0.5em",margin:"0.5em 0"}},r.createElement("button",{onClick:function(){i("insets")}},"Edit Insets")),r.createElement(eE,{mapSettings:t,setMapSettings:n})),r.createElement("div",{style:{position:"relative",flex:1}},l.node))})}function e1(e){var t=e.left,n=e.right,a=e.error;return(0,ep.wd)()?r.createElement(r.Fragment,null,t,n):r.createElement(e2,{error:a,left:t,right:n})}function e2(e){var t=e.left,n=e.right,a=e.error,o=eY((0,r.useState)(0),2),i=o[0],u=o[1],l=(0,r.useRef)(null),c=(0,M.cI)(),s=(0,r.useCallback)(function(){if(l.current){var e=l.current.getBoundingClientRect();u(window.innerHeight-e.top-8)}},[]);(0,r.useLayoutEffect)(function(){return s(),window.addEventListener("resize",s),function(){window.removeEventListener("resize",s)}},[s]);var f=eY((0,eu.yu)("mapperSettingsColumnProp"),2),p=f[0],m=f[1],d=eY((0,r.useState)(void 0),2),v=d[0],y=d[1],g=(0,r.useRef)(null),b=function(){return E/l.current.offsetWidth};(0,r.useEffect)(function(){null!==g.current&&(g.current.style.cursor=p===b()?"e-resize":p===S?"w-resize":"col-resize")});var E=540*!!t,w=t?"".concat(100*p,"%"):"0%",S=.5;return r.createElement("div",{style:{display:"flex",height:i,position:"relative"},ref:l},t&&r.createElement(r.Fragment,null,r.createElement("div",{style:{width:w,minWidth:E,overflowY:"scroll",backgroundColor:(0,h.bt)(c.hueColors.red,a?.8:1,c.slightlyDifferentBackground),padding:"1em",borderRadius:"5px"}},t),r.createElement("div",{ref:g,style:{width:"1em",position:"relative"},onPointerDown:function(e){if(void 0===v){var t=e.target;y({pointerId:e.pointerId,startOffsetX:e.nativeEvent.offsetX+t.offsetLeft,startProp:Math.max(b(),p)}),t.setPointerCapture(e.pointerId)}},onPointerMove:function(e){if(e.pointerId===(null==v?void 0:v.pointerId)){var t=(e.target.offsetLeft+e.nativeEvent.offsetX-v.startOffsetX)/l.current.offsetWidth;m(Math.max(b(),Math.min(v.startProp+t,S)))}},onPointerCancel:function(e){(null==v?void 0:v.pointerId)===e.pointerId&&y(void 0)},onPointerUp:function(e){(null==v?void 0:v.pointerId)===e.pointerId&&y(void 0)}},r.createElement("div",{style:{backgroundColor:c.borderNonShadow,borderRadius:"5px",position:"absolute",width:"5px",left:"calc(50% - 2px)",height:"50%",top:"25%",pointerEvents:"none"}}))),r.createElement("div",{style:{width:"calc(100% - max(".concat(E,"px, ").concat(w,") - ").concat("1em",")"),display:"flex",flexDirection:"column",justifyContent:"center"}},n))}function e5(e){var t=e.mapSettings,n=e.setMapSettings,a=e.typeEnvironment,o=e.setMapEditorMode,i=e.mapGenerator,u=(0,M.cI)(),l=eY((0,r.useState)({ast:function(e){return e},insets:function(e){return e}}),2),c=l[0],s=l[1],f=(0,ec.C5)(c,void 0,s,function(){}),p=f.addState,m=f.ui,d=f.canUndo,v=c.insets(eX(t,a)),y=function(e){s(e),p(e,void 0)},b=i.ui({mode:"insets",editInsets:{add:function(){var e,n=eq(eZ({},(0,g.v)(null!=(e=t.universe)?e:"world")[0]),{bottomLeft:[.25,.25],topRight:[.75,.75],mainMap:!1});y(eW(c,[v.length,v.length],[e3(n,v)]))},modify:function(e,t){y(eW(c,[e,e+1],[eZ({},v[e],t)]))},delete:function(e){y(eW(c,[e,e+1],[]))},duplicate:function(e){y(eW(c,[e+1,e+1],[e3(v[e],v)]))},moveUp:function(e){(0,E.h)(e+1<v.length,"Cannot move inset ".concat(e," up, already top")),y(e$(c,e,e+1))},moveDown:function(e){(0,E.h)(e>0,"Cannot move inset ".concat(e," down, already bottom")),y(e$(c,e,e-1))},editedInsets:v}});return r.createElement(r.Fragment,null,r.createElement(e1,{left:void 0,error:!1,right:r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:u.slightlyDifferentBackgroundFocused,borderRadius:"5px",padding:"10px",margin:"10px 0",display:"flex",justifyContent:"space-between",gap:"0.5em"}},r.createElement("div",null,r.createElement("b",null,"Editing Insets.")," ","Pans and zooms to maps will be reflected permanently. Drag inset frames to reposition and resize."),r.createElement("div",{style:{display:"flex",gap:"10px"}},r.createElement("button",{onClick:function(){o("uss")}},"Cancel"),r.createElement("button",{onClick:function(){var e,r,i;n(eq(eZ({},t),{script:{uss:((0,E.h)("statements"===t.script.uss.type,"Trying to do an inset edit on USS that is not inset editable"),r=eH.parse(t.script.uss,a),(0,E.h)(void 0!==t.universe,"Trying to do an inset edit on USS that is not inset editable"),e=void 0!==r.currentValue?r.expr:(0,g.U)(t.universe),i=eG.parse(e,a).edit(c.ast),r.edit(i))}})),o("uss")},disabled:!d},"Accept"))),r.createElement("div",{style:{flex:1,position:"relative"}},b.node))}),m)}function e3(e,t){for(var n=0;n<1;n+=.05)for(var r=0,a=[[n,n],[-n,-n],[-n,n],[n,-n]];r<a.length;r++){var o=function(n,r){var a=eY(r[n],2),o=a[0],i=a[1],u=eq(eZ({},e),{bottomLeft:[e.bottomLeft[0]+o,e.bottomLeft[1]+i],topRight:[e.topRight[0]+o,e.topRight[1]+i]});if(u.bottomLeft.concat(u.topRight).every(function(e){return e>=0&&e<=1})&&!t.some(function(e){return u.bottomLeft[0]===e.bottomLeft[0]&&u.bottomLeft[1]===e.bottomLeft[1]&&u.topRight[0]===e.topRight[0]&&u.topRight[1]===e.topRight[1]}))return{v:u}}(r,a);if("object"==(o&&"undefined"!=typeof Symbol&&o.constructor===Symbol?"symbol":typeof o))return o.v}return e}function e4(e,t,n){var r="string"==typeof t?new Blob([t],{type:n}):t,a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}function e6(e){var t=function(){var t;return(t=function(){return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=u(0),i.throw=u(1),i.return=u(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(l){var c=[u,l];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(void 0===e.pngExport)return[2];return[4,e.pngExport()];case 1:return[4,fetch(t.sent())];case 2:return[4,t.sent().blob()];case 3:return e4("map.png",t.sent(),"image/png"),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(e){eJ(o,r,a,i,u,"next",e)}function u(e){eJ(o,r,a,i,u,"throw",e)}i(void 0)})})()},n=function(){void 0!==e.geoJSONExport&&e4("map.geojson",e.geoJSONExport(),"application/geo+json")};return r.createElement("div",{style:{display:"flex",gap:"0.5em",margin:"0.5em 0"}},r.createElement("button",{disabled:void 0===e.pngExport,onClick:function(){t()}},"Export as PNG"),r.createElement("button",{disabled:void 0===e.geoJSONExport,onClick:function(){n()}},"Export as GeoJSON"),r.createElement("button",{onClick:function(){var e=new URLSearchParams(window.location.search);e.set("view","true"),window.open("?".concat(e.toString()),"_blank")}},"View as Zoomable Page"))}function e8(e){return e.view?r.createElement(e7,{mapSettings:e.mapSettings}):r.createElement(eQ,e)}function e7(e){var t=Y({mapSettings:e.mapSettings});return r.createElement(r.Fragment,null,t.ui({mode:"view"}).node)}},46207:function(e,t,n){n.d(t,{B:()=>r,c:()=>a});var r=Symbol();function a(e){var t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept",e),t.style.display="none";var n=new Promise(function(e){t.onchange=function(){e(t.files[0]),t.remove()},t.oncancel=function(){e(r),t.remove()}});return document.body.appendChild(t),t.click(),n}}}]);
//# sourceMappingURL=134.js.map