"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([["749"],{83619:function(e,t,n){n.r(t),n.d(t,{ComparisonPanel:()=>I,ComparisonMapButtons:()=>z}),n(71540),n(50457);var r=n(5648),o=n(30018),a=n(72668),i=n(6381),l=n(45437),c=n(66547),u=n(27281),s=n(82074),p=n(79779),m=n(22712),f=n(13736),d=n(36195),v=n(11625),y=n(78773),h=n(6735),g=n(71222),b=n(45988),w=n(72082),S=n(65547),E=n(65899),O=n(54288),P=n(20110);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function j(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(n=o.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw r}}return a}}(e,t)||T(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}function R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(R=function(){return!!e})()}function I(e){var t,n,w,S,P=(0,c.cI)(),C=(0,a.useRef)(null),N=(0,a.useRef)(null),R=A((0,a.useState)(null),2),I=R[0],B=R[1],z=A((0,a.useState)({value:e.articles,propsValue:e.articles}),2),D=z[0],V=z[1],H=A((0,a.useState)(null),2),L=H[0],W=H[1],M=A((0,a.useState)("down"),2),F=M[0],G=M[1],U=(0,r.Dy)((0,r.VT)(r.we,{activationConstraint:{distance:0}}),(0,r.VT)(r.LO,{activationConstraint:{delay:50,tolerance:0}}));D.propsValue===e.articles?w=D.value:(V({propsValue:e.articles,value:e.articles}),w=e.articles);var q=w.map(function(e){return e.shortname}).join(" vs "),X=w.map(function(e){return e.longname}),J=(0,u.rV)((0,s.fX)()),K=e.rows(J),Q=K[0].map(function(e,t){return K.map(function(e){return e[t]})}),Z=function(t){L===t?n="up"===F?"down":"up":(n="down",W(t)),G(n);var n,r=Q[t].map(function(e,t){return{row:e,index:t}}).sort(function(e,t){var r,o,a;return r=e.row,o=t.row,a=n,isNaN(r.statval)||isNaN(o.statval)?isNaN(r.statval)?1:isNaN(o.statval)?-1:"up"===a?r.renderedStatname.localeCompare(o.renderedStatname):o.renderedStatname.localeCompare(r.renderedStatname):"up"===a?r.statval-o.statval:o.statval-r.statval}).map(function(e){return e.index}).map(function(e){return w[e]});V({propsValue:e.articles,value:r}),eh.navigate({kind:"comparison",universe:eh.universe,longnames:r.map(function(e){return e.longname})},{history:"push",scroll:{kind:"none"}})},$=(0,d.wd)(),Y=Q.map(function(e){return e.every(function(e){return"heterogenous-sources"!==e.disclaimer})}),ee=w.every(function(e){return e.articleType===w[0].articleType})&&(0===Y.length||Y.some(function(e){return e})),et=ee?["statval","statval_unit","statistic_ordinal","statistic_percentile"]:["statval","statval_unit"],en=$?4:6,er=(0,u.rV)(Q.filter(function(e){return e.some(function(e){return void 0!==e.extraStat})}).map(function(e){var t=A(e,1)[0].statpath;return(0,u.Vv)(t)})),eo=Q.map(function(e){var t,n=A(e,1)[0].statpath;return null!=(t=er[(0,u.Vv)(n)])&&t}),ea=eo.filter(function(e){return e}).length,ei=(ee?1.5:1)*w.length+1,el=(ee?1.5:1)*(K[0].length+ea)+1.5,ec=ei>en&&ei>el;ec&&(ei=(S=[el,ei])[0],el=S[1]);var eu=ec?.24:.18,es=100*(1-eu)/((ec?K[0].length:w.length)+(ec?ea:0)),ep=Q.map(function(e){return e.map(function(e){return e.statval}).reduce(function(e,t,n,r){return isNaN(t)?e:void 0===e||t>r[e]?n:e},void 0)}),em=(0,d.Kn)(),ef=(0,d.q0)(),ed=(0,d.Pf)("right"),ev=(0,d.Pf)(),ey=(0,m.jg)(),eh=(0,a.useContext)(i.C.Context),eg=w.every(function(e){return e.articleType===w[0].articleType})?w[0].articleType:void 0,eb=function(e){var t;return null!=(t=Q[e].find(function(e){return void 0!==e.extraStat}))?t:Q[e][0]},ew=Array.from({length:w.length}).map(function(e,t){return{type:"comparison-longname",articleIndex:t,articles:w,names:X,transpose:ec,sharedTypeOfAllArticles:eg,highlightIndex:t,draggable:!0,articleId:w[t].shortname}}),eS=Array.from({length:Q.length}).map(function(e,t){return{type:"statistic-name",row:eb(t),longname:X[0],currentUniverse:ey,center:!!ec,transpose:ec,highlightIndex:ep[t],sortInfo:{onSort:function(){Z(t)},sortDirection:L===t?F:"both"}}}),eE=(0,g.computeNameSpecsWithGroups)(eS),eO=eE.updatedNameSpecs,eP=eE.groupNames,ek=Array.from({length:Q.length}).map(function(e,t){return Array.from({length:w.length}).map(function(e,n){return{type:"statistic-row",row:K[n][t],longname:X[n],onlyColumns:et,blankColumns:Y[t]?[]:["statistic_ordinal","statistic_percentile"],simpleOrdinals:!0,statisticStyle:ep[t]===n?{backgroundColor:(0,f.bt)((0,c.wb)(P.hueColors,n),P.mixPct/100,P.background)}:{},onNavigate:function(e){eh.navigate({kind:"comparison",universe:eh.universe,longnames:X.map(function(t,r){return r===n?e:t})},{history:"push",scroll:{kind:"none"}})}}})}),eC=0===ek.length?[]:ek[0].map(function(e,t){return ek.map(function(e){return e[t]})}),ex=Array.from({length:Q.length}).map(function(e,t){return eo[t]?{statDescription:Q[t][0].renderedStatname,plotProps:Q[t].map(function(e,t){return j(x({},e),{color:(0,c.wb)(P.hueColors,t),shortname:w[t].shortname,longname:w[t].longname,sharedTypeOfAllArticles:eg})})}:void 0}),ej={type:"comparison-top-left-header",statNameOverride:ec?"Region":void 0},eN=(0,b.xE)(w,K,ee),eA="".concat((0,l.Nw)(q),".csv");return a.createElement(v.v.Provider,{value:ec},a.createElement(h.Gp,null),a.createElement(p.P,{screencapElements:function(){return{path:"".concat((0,l.Nw)(q),".png"),overallWidth:2*C.current.offsetWidth,elementsToRender:[C.current,N.current]}},csvExportData:{csvData:eN,csvFilename:eA},hasUniverseSelector:!0,universes:e.universes},a.createElement(r.LB,{sensors:U,onDragStart:function(e){B(e.active.id)},onDragEnd:function(t){var n=t.active,r=t.over;if(r&&n.id!==r.id){var a=w.findIndex(function(e){return e.shortname===n.id}),i=w.findIndex(function(e){return e.shortname===r.id}),l=(0,o.Rp)(w,a,i),c=l.map(function(e){return e.longname});V({propsValue:e.articles,value:l}),eh.navigate({kind:"comparison",universe:eh.universe,longnames:c},{history:"push",scroll:{kind:"none"}})}B(null)},collisionDetection:r.pE},a.createElement(o.Fo,{items:w.map(function(e){return e.shortname}),strategy:ec?o.qw:o.PG},a.createElement("div",null,a.createElement("div",{className:em},"Comparison"),a.createElement("div",{className:ef},q),a.createElement("div",{style:{marginBlockEnd:"16px"}}),a.createElement("div",{style:{display:"flex"}},a.createElement("div",{style:{width:"".concat(100*eu,"%")}}),a.createElement("div",{style:{width:"".concat(50*(1-eu),"%"),marginRight:"1em"}},a.createElement("div",{className:"serif",style:ed},"Add another region:")),a.createElement("div",{style:{width:"".concat(50*(1-eu),"%")}},a.createElement(E.R,{style:j(x({},ev),{width:"100%"}),placeholder:"Name",link:function(e){return eh.link({kind:"comparison",universe:ey,longnames:((function(e){if(Array.isArray(e))return k(e)})(X)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(X)||T(X)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e])},{scroll:{kind:"none"}})},autoFocus:!1,prioritizeArticleType:eg}))),a.createElement("div",{style:{marginBlockEnd:"1em"}}),(t=a.createElement("div",{ref:C},ec?a.createElement(O.C4,{superHeaderSpec:{headerSpecs:eO,showBottomBar:!1,groupNames:eP},leftHeaderSpec:{leftHeaderSpecs:ew},rowSpecs:eC,horizontalPlotSpecs:ex.map(function(){}),verticalPlotSpecs:ex,topLeftSpec:ej,widthLeftHeader:100*eu,columnWidth:es,onlyColumns:et,simpleOrdinals:!0}):a.createElement(O.C4,{superHeaderSpec:{headerSpecs:ew,showBottomBar:!0},leftHeaderSpec:{leftHeaderSpecs:eO,groupNames:eP},rowSpecs:ek,horizontalPlotSpecs:ex,verticalPlotSpecs:[],topLeftSpec:ej,widthLeftHeader:100*eu,columnWidth:es,onlyColumns:et,simpleOrdinals:!0}),a.createElement(y.Q,null)),ei>en?a.createElement("div",{style:{overflowX:"scroll"}},a.createElement("div",{style:{width:"".concat(100*ei/(en-.7),"%")}},t)):t),a.createElement("div",{className:"gap"}),a.createElement("div",{ref:N},a.createElement(_,{longnames:w.map(function(e){return e.longname}),colors:w.map(function(e,t){return(0,c.wb)(P.hueColors,t)}),basemap:{type:"osm"},mapPartitions:e.mapPartitions})))),a.createElement(r.y9,null,I?a.createElement("div",{style:{opacity:.5,backgroundColor:P.background,padding:"8px",borderRadius:"4px"}},null==(n=w.find(function(e){return e.shortname===I}))?void 0:n.longname):null))))}function _(e){var t=e.mapPartitions.map(function(t){return t.map(function(t){return e.longnames[t]})}),n=(0,a.useRef)([]);(0,a.useEffect)(function(){var e=setTimeout(function(){var e=!0,t=!1,r=void 0;try{for(var o,a=n.current[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;if(null!==i)try{i.zoomToAll()}catch(e){P.warn(e)}}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}},0);return function(){clearTimeout(e)}},[t]),n.current=Array(e.mapPartitions.length).fill(null);var r=(0,d.wd)();return(0,a.useMemo)(function(){var t=function(t,n){return e.mapPartitions.slice(t,n).map(function(e,n){return[t+n,e]})};if(r){for(var n=[],o=0;o<e.mapPartitions.length;o+=2)n.push(t(o,o+2));return n}for(var a=[],i=0;i<e.mapPartitions.length;i+=3)e.mapPartitions.length-i==4?(a.push(t(i,i+2),t(i+2,i+4)),i+=1):a.push(t(i,i+3));return a},[r,e.mapPartitions]).map(function(t,r){return a.createElement("div",{key:r,style:{display:"flex",width:"100%"}},t.map(function(r){var o=A(r,2),i=o[0],l=o[1];return a.createElement("div",{key:i,style:{position:"relative",width:"".concat(100/t.length,"%")}},a.createElement(B,j(x({ref:function(e){return n.current[i]=e}},e),{longnames:l.map(function(t){return e.longnames[t]}),colors:l.map(function(t){return e.colors[t]}),attribution:i===e.mapPartitions.length-1?"startVisible":"none"})))}))})}var B=function(e){var t;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function n(){var e,t;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");return e=n,t=arguments,e=C(e),function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,R()?Reflect.construct(e,t||[],C(this).constructor):e.apply(this,t))}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&N(n,e),t=[{key:"buttons",value:function(){return a.createElement(z,{map:this})}},{key:"zoomButton",value:function(e,t,n){return a.createElement("div",{key:"zoomButton_".concat(e),style:{display:"inline-block",width:"2em",height:"2em",backgroundColor:t,borderRadius:"50%",marginLeft:"5px",marginRight:"5px",cursor:"pointer"},onClick:n})}},{key:"computeShapesToRender",value:function(){var e=this;return Promise.resolve({shapes:this.props.longnames.map(function(t,n){return{name:t,spec:{type:"polygon",style:{color:e.props.colors[n],fillColor:e.props.colors[n],fillOpacity:.5,weight:1}},meta:{}}}),zoomIndex:-1})}},{key:"mapDidRender",value:function(){return this.zoomToAll({animate:!1}),Promise.resolve()}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,t),n}(w.J9);function z(e){var t=(0,c.cI)();return(0,S.Lm)()?null:a.createElement("div",{style:{display:"flex",backgroundColor:t.background,padding:"0.5em",borderRadius:"0.5em",alignItems:"center"}},a.createElement("span",{className:"serif",style:{fontSize:"15px",fontWeight:500}},"Zoom to:"),a.createElement("div",{style:{width:"0.25em"}}),e.map.zoomButton(-1,t.textMain,function(){e.map.zoomToAll()}),e.map.props.longnames.map(function(t,n){return e.map.zoomButton(n,e.map.props.colors[n],function(){e.map.zoomTo(t)})}))}}}]);
//# sourceMappingURL=749.js.map