"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([["749"],{83619:function(e,t,n){n.r(t),n.d(t,{ComparisonPanel:()=>R,ComparisonMapButtons:()=>D}),n(71540),n(50457);var r=n(5648),a=n(30018),o=n(72668),i=n(45844),l=n(15638),c=n(6381),u=n(45437),s=n(66547),m=n(27281),p=n(82074),f=n(79779),d=n(22712),v=n(13736),g=n(56033),h=n(36195),y=n(11625),b=n(78773),E=n(6735),w=n(71008),S=n(45988),x=n(6135),k=n(65547),O=n(65899),C=n(54288);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function A(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return o}}(e,t)||I(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}function R(e){var t,n,i,l,g=(0,s.cI)(),x=(0,o.useRef)(null),k=(0,o.useRef)(null),R=j((0,o.useState)(null),2),T=R[0],D=R[1],V=j((0,o.useState)({value:e.articles,propsValue:e.articles}),2),L=V[0],H=V[1],z=j((0,o.useState)(null),2),M=z[0],W=z[1],_=j((0,o.useState)("down"),2),q=_[0],F=_[1],G=(0,r.Dy)((0,r.VT)(r.we,{activationConstraint:{distance:1}}),(0,r.VT)(r.LO,{activationConstraint:{delay:50,tolerance:0}}));L.propsValue===e.articles?i=L.value:(H({propsValue:e.articles,value:e.articles}),i=e.articles);var U=i.map(function(e){return e.shortname}).join(" vs "),X=i.map(function(e){return e.longname}),K=(0,m.rV)((0,p.fX)()),Q=e.rows(K),Z=Q[0].map(function(e,t){return Q.map(function(e){return e[t]})}),$=function(t){M===t?n="up"===q?"down":"up":(n="down",W(t)),F(n);var n,r=Z[t].map(function(e,t){return{row:e,index:t}}).sort(function(e,t){var r,a,o;return r=e.row,a=t.row,o=n,isNaN(r.statval)||isNaN(a.statval)?isNaN(r.statval)?1:isNaN(a.statval)?-1:"up"===o?r.renderedStatname.localeCompare(a.renderedStatname):a.renderedStatname.localeCompare(r.renderedStatname):"up"===o?r.statval-a.statval:a.statval-r.statval}).map(function(e){return e.index}).map(function(e){return i[e]});H({propsValue:e.articles,value:r}),eh.navigate({kind:"comparison",universe:eh.universe,longnames:r.map(function(e){return e.longname})},{history:"push",scroll:{kind:"none"}})},J=(0,h.wd)(),Y=Z.map(function(e){return e.every(function(e){return"heterogenous-sources"!==e.disclaimer})}),ee=i.every(function(e){return e.articleType===i[0].articleType})&&(0===Y.length||Y.some(function(e){return e})),et=ee?["statval","statval_unit","statistic_ordinal","statistic_percentile"]:["statval","statval_unit"],en=J?4:6,er=(0,m.rV)(Z.filter(function(e){return e.some(function(e){return void 0!==e.extraStat})}).map(function(e){var t=j(e,1)[0].statpath;return(0,m.Vv)(t)})),ea=Z.map(function(e){var t,n=j(e,1)[0].statpath;return null!=(t=er[(0,m.Vv)(n)])&&t}),eo=ea.filter(function(e){return e}).length,ei=(ee?1.5:1)*i.length+1,el=(ee?1.5:1)*(Q[0].length+eo)+1.5,ec=ei>en&&ei>el;ec&&(ei=(l=[el,ei])[0],el=l[1]);var eu=ec?.24:.18,es=100*(1-eu)/((ec?Q[0].length:i.length)+(ec?eo:0)),em=Z.map(function(e){return e.map(function(e){return e.statval}).reduce(function(e,t,n,r){return isNaN(t)?e:void 0===e||t>r[e]?n:e},void 0)}),ep=(0,h.Kn)(),ef=(0,h.q0)(),ed=(0,h.Pf)("right"),ev=(0,h.Pf)(),eg=(0,d.jg)(),eh=(0,o.useContext)(c.C.Context),ey=i.every(function(e){return e.articleType===i[0].articleType})?i[0].articleType:void 0,eb=function(e){var t;return null!=(t=Z[e].find(function(e){return void 0!==e.extraStat}))?t:Z[e][0]},eE=Array.from({length:i.length}).map(function(e,t){return{type:"comparison-longname",articleIndex:t,articles:i,names:X,transpose:ec,sharedTypeOfAllArticles:ey,highlightIndex:t,draggable:!0,articleId:i[t].shortname}}),ew=Array.from({length:Z.length}).map(function(e,t){return{type:"statistic-name",row:eb(t),longname:X[0],currentUniverse:eg,center:!!ec,transpose:ec,highlightIndex:em[t],sortInfo:{onSort:function(){$(t)},sortDirection:M===t?q:"both"}}}),eS=(0,w.computeNameSpecsWithGroups)(ew),ex=eS.updatedNameSpecs,ek=eS.groupNames,eO=Array.from({length:Z.length}).map(function(e,t){return Array.from({length:i.length}).map(function(e,n){return{type:"statistic-row",row:Q[n][t],longname:X[n],onlyColumns:et,blankColumns:Y[t]?[]:["statistic_ordinal","statistic_percentile"],simpleOrdinals:!0,statisticStyle:em[t]===n?{backgroundColor:(0,v.bt)((0,s.wb)(g.hueColors,n),g.mixPct/100,g.background)}:{},onNavigate:function(e){eh.navigate({kind:"comparison",universe:eh.universe,longnames:X.map(function(t,r){return r===n?e:t})},{history:"push",scroll:{kind:"none"}})}}})}),eC=0===eO.length?[]:eO[0].map(function(e,t){return eO.map(function(e){return e[t]})}),eP=Array.from({length:Z.length}).map(function(e,t){return ea[t]?{statDescription:Z[t][0].renderedStatname,plotProps:Z[t].map(function(e,t){return A(N({},e),{color:(0,s.wb)(g.hueColors,t),shortname:i[t].shortname,longname:i[t].longname,sharedTypeOfAllArticles:ey})})}:void 0}),eN={type:"comparison-top-left-header",statNameOverride:ec?"Region":void 0},eA=(0,S.xE)(i,Q,ee),ej="".concat((0,u.Nw)(U),".csv");return o.createElement(y.v.Provider,{value:ec},o.createElement(E.Gp,null),o.createElement(f.P,{screencapElements:function(){return{path:"".concat((0,u.Nw)(U),".png"),overallWidth:2*x.current.offsetWidth,elementsToRender:[x.current,k.current]}},csvExportData:{csvData:eA,csvFilename:ej},hasUniverseSelector:!0,universes:e.universes},o.createElement(r.LB,{sensors:G,onDragStart:function(e){D(e.active.id)},onDragEnd:function(t){var n=t.active,r=t.over;if(r&&n.id!==r.id){var o=i.findIndex(function(e){return e.shortname===n.id}),l=i.findIndex(function(e){return e.shortname===r.id}),c=(0,a.Rp)(i,o,l),u=c.map(function(e){return e.longname});H({propsValue:e.articles,value:c}),eh.navigate({kind:"comparison",universe:eh.universe,longnames:u},{history:"push",scroll:{kind:"none"}})}D(null)},collisionDetection:r.pE},o.createElement(a.Fo,{items:i.map(function(e){return e.shortname}),strategy:ec?a.qw:a.PG},o.createElement("div",null,o.createElement("div",{className:ep},"Comparison"),o.createElement("div",{className:ef},U),o.createElement("div",{style:{marginBlockEnd:"16px"}}),o.createElement("div",{style:{display:"flex"}},o.createElement("div",{style:{width:"".concat(100*eu,"%")}}),o.createElement("div",{style:{width:"".concat(50*(1-eu),"%"),marginRight:"1em"}},o.createElement("div",{className:"serif",style:ed},"Add another region:")),o.createElement("div",{style:{width:"".concat(50*(1-eu),"%")}},o.createElement(O.R,{style:A(N({},ev),{width:"100%"}),placeholder:"Name",link:function(e){return eh.link({kind:"comparison",universe:eg,longnames:((function(e){if(Array.isArray(e))return P(e)})(X)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(X)||I(X)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e])},{scroll:{kind:"none"}})},autoFocus:!1,prioritizeArticleType:ey}))),o.createElement("div",{style:{marginBlockEnd:"1em"}}),(t=o.createElement("div",{ref:x},ec?o.createElement(C.C4,{superHeaderSpec:{headerSpecs:ex,showBottomBar:!1,groupNames:ek},leftHeaderSpec:{leftHeaderSpecs:eE},rowSpecs:eC,horizontalPlotSpecs:eP.map(function(){}),verticalPlotSpecs:eP,topLeftSpec:eN,widthLeftHeader:100*eu,columnWidth:es,onlyColumns:et,simpleOrdinals:!0}):o.createElement(C.C4,{superHeaderSpec:{headerSpecs:eE,showBottomBar:!0},leftHeaderSpec:{leftHeaderSpecs:ex,groupNames:ek},rowSpecs:eO,horizontalPlotSpecs:eP,verticalPlotSpecs:[],topLeftSpec:eN,widthLeftHeader:100*eu,columnWidth:es,onlyColumns:et,simpleOrdinals:!0}),o.createElement(b.Q,null)),ei>en?o.createElement("div",{style:{overflowX:"scroll"}},o.createElement("div",{style:{width:"".concat(100*ei/(en-.7),"%")}},t)):t),o.createElement("div",{className:"gap"}),o.createElement("div",{ref:k},o.createElement(B,{longnames:i.map(function(e){return e.longname}),colors:i.map(function(e,t){return(0,s.wb)(g.hueColors,t)}),mapPartitions:e.mapPartitions})))),o.createElement(r.y9,null,T?o.createElement("div",{style:{opacity:.5,backgroundColor:g.background,padding:"8px",borderRadius:"4px"}},null==(n=i.find(function(e){return e.shortname===T}))?void 0:n.longname):null))))}function B(e){var t=(0,h.wd)();return(0,o.useMemo)(function(){var n=function(t,n){return e.mapPartitions.slice(t,n).map(function(e,n){return[t+n,e]})};if(t){for(var r=[],a=0;a<e.mapPartitions.length;a+=2)r.push(n(a,a+2));return r}for(var o=[],i=0;i<e.mapPartitions.length;i+=3)e.mapPartitions.length-i==4?(o.push(n(i,i+2),n(i+2,i+4)),i+=1):o.push(n(i,i+3));return o},[t,e.mapPartitions]).map(function(t,n){return o.createElement("div",{key:n,style:{display:"flex",width:"100%"}},t.map(function(n){var r=j(n,2),a=r[0],i=r[1];return o.createElement("div",{key:a,style:{position:"relative",width:"".concat(100/t.length,"%")}},o.createElement(T,{longnames:i.map(function(t){return e.longnames[t]}),colors:i.map(function(t){return e.colors[t]}),attribution:a===e.mapPartitions.length-1}))}))})}function T(e){var t=e.longnames,n=e.colors,r=e.attribution,a=(0,o.useRef)(null),l=(0,o.useMemo)(function(){return(0,x.zo)(t.map(function(e,t){return{name:e,color:n[t],fillColor:n[t],fillOpacity:.5,weight:1}}))},[t,n]).use(),c=(0,o.useMemo)(function(){return l.filter(g.gh)},[l]),u=(0,o.useId)();return(0,x.O0)(a,l,c),o.createElement("div",{style:{position:"relative"}},o.createElement(x.yq,{id:u,ref:a,attributionControl:!1},o.createElement(x.uy,{features:c,clickable:!0}),o.createElement(i.ot,{position:"top-left"}),r&&o.createElement(x.X3,{startShowingAttribution:!0})),o.createElement(D,{longnames:t,colors:n,features:l,mapRef:a}))}function D(e){var t=e.longnames,n=e.colors,r=e.features,a=e.mapRef,i=(0,s.cI)();if((0,k.Lm)())return null;var c=function(e){r[e]!==g.Vp&&a.current.fitBounds((0,l.boundingBox)(r[e].geometry),{animate:!0,padding:x.Lg})};return o.createElement("div",{style:{zIndex:1e3,position:"absolute",right:0,top:0,padding:"12px"}},o.createElement("div",{style:{display:"flex",backgroundColor:i.background,padding:"6px",borderRadius:"6px",alignItems:"center"}},o.createElement("span",{className:"serif",style:{fontSize:"15px",fontWeight:500}},"Zoom to:"),o.createElement("div",{style:{width:"3px"}}),o.createElement(V,{color:i.textMain,onClick:function(){var e;null==(e=a.current)||e.fitBounds((0,l.extendBoxes)(r.filter(g.gh).map(function(e){return(0,l.boundingBox)(e.geometry)})),{animate:!0,padding:x.Lg})}}),t.map(function(e,t){return o.createElement(V,{key:t,color:n[t],onClick:function(){c(t)}})})))}function V(e){var t=e.color,n=e.onClick;return o.createElement("div",{style:{display:"inline-block",width:"24px",height:"24px",backgroundColor:t,borderRadius:"50%",marginLeft:"5px",marginRight:"5px",cursor:"pointer"},onClick:n})}}}]);
//# sourceMappingURL=749.js.map