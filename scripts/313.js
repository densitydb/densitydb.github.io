"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([["313"],{25486:function(e,t,n){n.d(t,{T:()=>d,j:()=>p});var r=n(72668),a=n(76293),o=n(44852);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n,r,a,o,i){try{var s=e[o](i),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){s(o,r,a,i,u,"next",e)}function u(e){s(o,r,a,i,u,"throw",e)}i(void 0)})}}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,s=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function d(e){var t,n,i,s=(0,o.cI)(),d=null!=(i=null==(t=(n=navigator).canShare)?void 0:t.call(n,{url:"https://juxtastat.org",text:"test"}))&&i,f=a.isMobile&&d&&!a.isFirefox;return r.createElement("button",{className:"serif",style:p(s.hueColors.green,s.buttonTextWhite),ref:e.buttonRef,onClick:function(){return u(function(){var t,n,r;function a(){return u(function(){return c(this,function(t){switch(t.label){case 0:return[4,navigator.clipboard.writeText("".concat(n,"\n").concat(r))];case 1:return t.sent(),e.buttonRef.current.textContent="Copied!",[2]}})})()}return c(this,function(o){switch(o.label){case 0:return[4,e.produceSummary()];case 1:if(n=(t=l.apply(void 0,[o.sent(),2]))[0],r=t[1],!f)return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,navigator.share({url:r,text:"".concat(n,"\n")})];case 3:case 5:return o.sent(),[3,6];case 4:return o.sent(),[4,a()];case 6:return[3,9];case 7:return[4,a()];case 8:o.sent(),o.label=9;case 9:return[2]}})})()}},r.createElement("div",null,f?"Share":"Copy"),r.createElement("div",{style:{marginInline:"0.25em"}}),r.createElement("img",{src:"/share.png",className:"icon",style:{width:"1em",height:"1em"}}))}function p(e,t){return{textAlign:"center",fontSize:"2em",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"row",margin:"0 auto",padding:"0.25em 1em",backgroundColor:e,borderRadius:"0.25em",border:"none",color:t}}},4050:function(e,t,n){n.d(t,{Z:()=>r});let r=["world","Africa","Asia","Europe","North America","Oceania","South America","Andorra","United Arab Emirates","Afghanistan","Antigua and Barbuda","Anguilla","Albania","Armenia","Angola","Argentina","Austria","Australia","Aruba","Azerbaijan","Bosnia and Herzegovina","Barbados","Bangladesh","Belgium","Burkina Faso","Bulgaria","Bahrain","Burundi","Benin","Bermuda","Brunei","Bolivia","Brazil","The Bahamas","Bhutan","Botswana","Belarus","Belize","Canada","Cocos (Keeling) Islands","Democratic Republic of the Congo","Central African Republic","Congo","Switzerland","Ivory Coast","Cook Islands","Chile","Cameroon","China","Colombia","Costa Rica","Cuba","Cape Verde","Christmas Island","Cyprus","Czech Republic","Germany","Djibouti","Denmark","Dominica","Dominican Republic","Algeria","Ecuador","Estonia","Egypt","Eritrea","Spain","Ethiopia","Finland","Fiji","Falkland Islands","Micronesia","Faroe Islands","France","Gabon","United Kingdom","Grenada","Georgia","Guernsey","Ghana","Gibraltar","Greenland","The Gambia","Guinea","Equatorial Guinea","Greece","Guatemala","Guinea-Bissau","Guyana","Honduras","Croatia","Haiti","Hungary","Indonesia","Ireland","Israel","Isle of Man","India","Iraq","Iran","Iceland","Italy","Jersey","Jamaica","Jordan","Japan","Kenya","Kyrgyzstan","Cambodia","Kiribati","Comoros","Saint Kitts and Nevis","North Korea","South Korea","Kuwait","Cayman Islands","Kazakhstan","Laos","Lebanon","Saint Lucia","Liechtenstein","Sri Lanka","Liberia","Lesotho","Lithuania","Luxembourg","Latvia","Libya","Morocco","Monaco","Moldova","Montenegro","Madagascar","Marshall Islands","North Macedonia","Mali","Myanmar","Mongolia","Mauritania","Montserrat","Malta","Mauritius","Maldives","Malawi","Mexico","Malaysia","Mozambique","Namibia","Niger","Norfolk Island","Nigeria","Nicaragua","Netherlands","Norway","Nepal","Nauru","Niue","New Zealand","Oman","Panama","Peru","Papua New Guinea","Philippines","Pakistan","Poland","Pitcairn Islands","State of Palestine","Portugal","Palau","Paraguay","Qatar","Romania","Serbia","Russia","Rwanda","Saudi Arabia","Solomon Islands","Seychelles","Sudan","Sweden","Singapore","Saint Helena, Ascension and Tristan da Cunha","Slovenia","Slovakia","Sierra Leone","San Marino","Senegal","Somalia","Suriname","South Sudan","S\xe3o Tom\xe9 and Pr\xedncipe","El Salvador","Syria","Eswatini","Turks and Caicos Islands","Chad","Togo","Thailand","Tajikistan","Tokelau","East Timor","Turkmenistan","Tunisia","Tonga","Turkey","Trinidad and Tobago","Tuvalu","Tanzania","Ukraine","Uganda","USA","Uruguay","Uzbekistan","Vatican City","Saint Vincent and the Grenadines","Venezuela","British Virgin Islands","Vietnam","Vanuatu","Samoa","Yemen","South Africa","Zambia","Zimbabwe","Alabama, USA","Alaska, USA","Arizona, USA","Arkansas, USA","California, USA","Colorado, USA","Connecticut, USA","Delaware, USA","Florida, USA","Georgia, USA","Hawaii, USA","Idaho, USA","Illinois, USA","Indiana, USA","Iowa, USA","Kansas, USA","Kentucky, USA","Louisiana, USA","Maine, USA","Maryland, USA","Massachusetts, USA","Michigan, USA","Minnesota, USA","Mississippi, USA","Missouri, USA","Montana, USA","Nebraska, USA","Nevada, USA","New Hampshire, USA","New Jersey, USA","New Mexico, USA","New York, USA","North Carolina, USA","North Dakota, USA","Ohio, USA","Oklahoma, USA","Oregon, USA","Pennsylvania, USA","Rhode Island, USA","South Carolina, USA","South Dakota, USA","Tennessee, USA","Texas, USA","Utah, USA","Vermont, USA","Virginia, USA","Washington, USA","West Virginia, USA","Wisconsin, USA","Wyoming, USA","American Samoa, USA","Guam, USA","Northern Mariana Islands, USA","Puerto Rico, USA","US Virgin Islands, USA","District of Columbia, USA","Alberta, Canada","British Columbia, Canada","Manitoba, Canada","New Brunswick, Canada","Newfoundland and Labrador, Canada","Northwest Territories, Canada","Nova Scotia, Canada","Nunavut, Canada","Ontario, Canada","Prince Edward Island, Canada","Quebec, Canada","Saskatchewan, Canada","Yukon, Canada"]},97479:function(e,t,n){n.r(t),n.d(t,{SYAUGame:()=>_,SYAUPanel:()=>z});var r=n(72668);n(71540);var a=n(25486),o=n(98234),i=n(6381),s=n(44852),u=n(27281),l=n(79779),c=n(36195),d=n(59070),p=n(48192);let f=["County","MSA","CSA","Urban Area","CCD","City","Neighborhood","Native Area","Native Statistical Area","Native Subdivision","School District","USDA County Type","Media Market","CA Census Division","CA Census Subdivision","CA Population Center","CA CMA","CA Riding","Continent","Country","Subnational Region","Urban Center","Metropolitan Cluster"];var y=n(4050),m=n(46347);function h(e){var t=e.selected;void 0===t||e.items.includes(t)||(t=void 0);var n=(0,c.q0)();return r.createElement(p.p,{matches:e.items,doSearch:function(t){return Promise.resolve(e.items.filter(function(e){return e.toLowerCase().includes(t.toLowerCase())}))},link:e.onSelect,autoFocus:!0,placeholder:null!=t?t:e.placeholder,style:"".concat(n," syau-searchbox"),onChange:function(t){e.onSelect(t).onClick()},renderMatch:function(e,t,n,a,o){return r.createElement("div",{key:e(),style:a,onClick:n,onMouseOver:t,"data-test-id":o},e())}})}function b(e){var t=(0,r.useContext)(i.C.Context),n=y.Z.filter(function(t){return void 0===e.typ||(0,m.W$)(e.counts,e.typ,t).length>0});return r.createElement(h,{items:n,selected:e.universe,onSelect:function(n){return t.link({kind:"syau",typ:e.typ,universe:n},{scroll:{kind:"none"}})},placeholder:"Select a universe"})}function g(e){var t=f.filter(function(t){return void 0===e.universe||(0,m.W$)(e.counts,t,e.universe).length>0}),n=(0,r.useContext)(i.C.Context);return r.createElement(h,{items:t,selected:e.typ,onSelect:function(t){return n.link({kind:"syau",typ:t,universe:e.universe},{scroll:{kind:"none"}})},placeholder:"Select a region type"})}var v=n(65438);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(){var e;function t(){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");S(this,"history",new v.StoredProperty("syau_history",function(e){return JSON.parse(null!=e?e:"{}")},function(e){return JSON.stringify(e)}))}return e=[{key:"useHistory",value:function(e,t){var n,r=this,a="".concat(e,"-").concat(t),o=this.history.use();return[null!=(n=o[a])?n:{guessed:[]},function(e){var t,n;r.history.value=(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){S(e,t,n[t])})}return e}({},o),n=null!=(n=S({},a,e))?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)}]}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();S(A,"shared",new A);var C=n(50038),w=n.n(C),k=n(72082),O=n(77053);function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function U(e,t,n,r,a,o,i){try{var s=e[o](i),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function M(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){U(o,r,a,i,s,"next",e)}function s(e){U(o,r,a,i,s,"throw",e)}i(void 0)})}}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n||e):a.value}})(e,t,n||e)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return E(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(N=function(){return!!e})()}function T(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var D=function(e){var t;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function n(){var e,t,r;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");return t=n,r=arguments,t=I(t),x(e=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,N()?Reflect.construct(t,r||[],I(this).constructor):t.apply(this,r)),"alreadyFitBounds",!1),x(e,"name_to_index",void 0),x(e,"markersOnScreen",{}),x(e,"polysOnScreen",[]),x(e,"updateAttached",!1),e}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&P(n,e),t=[{key:"computeShapesToRender",value:function(){var e=this;return Promise.resolve({shapes:this.polysOnScreen.map(function(t){var n=t.name,r=t.isGuessed;return{name:n,spec:{type:"polygon",style:{fillColor:r?e.props.guessedColor:e.props.notGuessedColor,fillOpacity:.5,color:r?e.props.guessedColor:e.props.notGuessedColor,weight:2}},notClickable:!0,meta:{}}}),zoomIndex:-1})}},{key:"componentDidUpdate",value:function(e,t){var r=this,a=this;return M(function(){var o;return T(this,function(i){switch(i.label){case 0:return o=this,(e.longnames.length!==this.props.longnames.length||e.longnames.map(function(e,t){return e!==o.props.longnames[t]}).some(function(e){return e}))&&(this.alreadyFitBounds=!1),[4,j(I(n.prototype),"componentDidUpdate",r).call(a,e,t)];case 1:return i.sent(),[2]}})}).call(this)}},{key:"updateCentroidsSource",value:function(e){var t,n,r=this,a={type:"FeatureCollection",features:this.props.centroids.map(function(e,t){return{type:"Feature",properties:{name:r.props.longnames[t],population:r.props.population[t],populationGuessed:r.props.isGuessed[t]?r.props.population[t]:0,isGuessed:+!!r.props.isGuessed[t],existence:1,populationOrdinal:r.props.populationOrdinals[t]},geometry:{type:"Point",coordinates:[e.lon,e.lat]}}})},o=e.getSource("centroids");if(o){if(t=o,null!=(n=w().GeoJSONSource)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!n[Symbol.hasInstance](t):!(t instanceof n))throw Error("Source is not a GeoJSON source");o.setData(a)}else e.addSource("centroids",{type:"geojson",data:a,cluster:!0,clusterMaxZoom:14,clusterRadius:50,clusterProperties:{population:["+",["get","population"]],populationGuessed:["+",["get","populationGuessed"]],isGuessed:["+",["get","isGuessed"]],existence:["+",["get","existence"]]}}),o=e.getSource("centroids");return o}},{key:"fitBounds",value:function(e){if(!this.alreadyFitBounds){var t,n,r,a,o,i,s,u,l,c=(a=(t=this.props.centroids.map(function(e){return e.lon})).map(function(e){return e>0?e-360:e}),(o=function(e){return(n=Math).max.apply(n,G(e))-(r=Math).min.apply(r,G(e))})(t)<o(a)?t:a),d=this.props.centroids.map(function(e){return e.lat}),p=(i=Math).min.apply(i,G(c)),f=(s=Math).min.apply(s,G(d)),y=(u=Math).max.apply(u,G(c)),m=(l=Math).max.apply(l,G(d)),h=y-p,b=m-f,g=[[p-=.1*h,f-=.1*b],[y+=.1*h,m+=.1*b]];e.fitBounds(g,{animate:!1}),this.alreadyFitBounds=!0}}},{key:"updateMarkers",value:function(){var e,t=this.handler.maps;if(t){(0,O.h)(1===t.length,"SYAUMap should only be used with a single map instance");var n=t[0],r={},a=n.querySourceFeatures("centroids"),o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){x(e,t,n[t])})}return e}({},this.markersOnScreen),i=[],s=!0,u=!1,l=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value,f=p.geometry.coordinates,y=p.properties,m=y.cluster?y.cluster_id:y.name;o[m]&&o[m].remove();var h=void 0;y.cluster?h="".concat(y.isGuessed,"/").concat(y.existence):(i.push({name:y.name,isGuessed:1===y.isGuessed}),h=y.isGuessed?"#".concat(y.populationOrdinal):"?");var b=function(e,t,n,r,a){for(var o=-Math.PI/2,i=[],s=o+r,u=Math.min(s,o+Math.PI/2),l=0;l<4&&(i.push(function(e,t,n,r){var a=e+e*Math.cos(t),o=e+e*Math.sin(t),i=e+e*Math.cos(n),s=e+e*Math.sin(n);return'<path d="M'.concat(e,",").concat(e," L").concat(a,",").concat(o," A").concat(e,",").concat(e," 1 0,1 ").concat(i,",").concat(s,' z" fill="').concat(r,'"></path>')}(20,o,u,t)),u!==s);l++)u=Math.min(s,(o=u)+Math.PI/2);return["<div>",'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(2*n,'" height="').concat(2*n,'" viewBox="0 0 ').concat(2*n," ").concat(2*n,'">'),'<circle cx="'.concat(n,'" cy="').concat(n,'" r="').concat(n,'" fill="').concat(e,'"></circle>')].concat(G(i),["</svg>",'<div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); width: 100%; text-align: center; font-weight: 500" class="serif">',a,"</div>","</div>"]).join("")}(this.props.notGuessedColor,this.props.guessedColor,20,2*Math.PI*(y.populationGuessed/y.population),h),g=document.createElement("div");g.innerHTML=b,g.className="syau-marker",g.style.width="".concat(40,"px"),g.style.height="".concat(40,"px");var v=new(w()).Marker({element:g}).setLngLat(f);r[m]=o[m]=v,r[m].addTo(n)}}catch(e){u=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw l}}for(var S in o)r[S]||null==(e=o[S])||e.remove();this.markersOnScreen=r,i.sort(function(e,t){return e.name<t.name?-1:+(e.name>t.name)}),JSON.stringify(i)!==JSON.stringify(this.polysOnScreen)&&(this.polysOnScreen=i,this.bumpVersion())}}},{key:"addLayersIfNeeded",value:function(e){e.getLayer("centroid_circle")||e.addLayer({id:"centroid_circle",type:"circle",source:"centroids",filter:["!=","cluster",!0],paint:{"circle-color":["case",["==",["get","isGuessed"],1],this.props.guessedColor,this.props.notGuessedColor],"circle-radius":0}})}},{key:"populateMap",value:function(e,t,r){var a=this,o=this;return M(function(){var i,s,u;return T(this,function(l){switch(l.label){case 0:return i=this,[4,j(I(n.prototype),"populateMap",a).call(o,e,t,r)];case 1:return l.sent(),[4,this.handler.stylesheetPresent()];case 2:return l.sent(),(0,O.h)(1===e.length,"SYAUMap should only be used with a single map instance"),s=e[0],this.fitBounds(s),u=this.updateCentroidsSource(s),this.addLayersIfNeeded(s),this.updateAttached||(this.updateAttached=!0,s.on("move",function(){i.updateMarkers()}),s.on("moveend",function(){i.updateMarkers()}),u.on("data",function(){i.updateMarkers()})),[2]}})}).call(this)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,t),n}(k.J9);function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,s=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return o}}(e,t)||F(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}}function z(e){var t=(0,c.Kn)(),n=(0,c.q0)();return r.createElement(l.P,null,r.createElement("div",{className:t},"So you're an urbanist?"),r.createElement("div",{className:n},"Name every",r.createElement(g,{typ:e.typ,universe:e.universe,counts:e.counts})," ","in",r.createElement(b,{typ:e.typ,universe:e.universe,counts:e.counts})),void 0===e.syauData?void 0:r.createElement("div",null,r.createElement("div",{style:{marginBlockEnd:"1em"}}),r.createElement(_,{typ:e.typ,universe:e.universe,syauData:e.syauData})))}function K(e){var t=R((0,u.yu)("syauRequireEnter"),1)[0];return r.createElement("input",{type:"text",id:"syau-input",placeholder:"Type a region name",style:{width:"86%"},onChange:function(n){!t&&e.guessCallback(n.target.value)&&(n.target.value="")},onKeyDown:function(n){t&&"Enter"===n.key&&(e.guessCallback(n.currentTarget.value),n.currentTarget.value="")}})}function _(e){var t=(0,s.cI)(),n=(0,s.Rv)(),i=R(A.shared.useHistory(e.typ,e.universe),2),u=i[0],l=i[1],c=e.syauData.populations.reduce(function(e,t){return e+t},0),p=u.guessed.map(function(t){return e.syauData.populations[e.syauData.longnameToIndex[t]]}).reduce(function(e,t){return e+t},0),f=R(r.useState(!1),2),y=f[0],h=f[1],b=r.createRef(),g=(0,d._6)(e.typ),v=e.syauData.longnames.map(function(e){return u.guessed.includes(e)}),S=y?n.correct:t.background;return r.createElement("div",null,r.createElement("div",{style:{margin:"auto",width:"50%"}},r.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"auto"}},r.createElement("div",{style:{width:"7%",height:"1.5em"}}),r.createElement(K,{guessCallback:function(t){var n=e.syauData.longnames.filter(function(n,r){return(0,m.FG)(e.syauData.matchChunks[r],t)}),r=n.filter(function(e){return!u.guessed.includes(e)});return h(0!==n.length&&0===r.length),0!==r.length&&(l({guessed:L(u.guessed).concat(L(r))}),!0)}}),r.createElement("div",{style:{width:"2%",height:"1.5em"}}),r.createElement("div",{style:{width:"5%",height:"1.5em",backgroundColor:S}})),r.createElement("div",{style:{marginBlockEnd:"1em"}}),r.createElement("div",{style:{textAlign:"center"},id:"test-syau-status"},r.createElement("b",null,u.guessed.length,"/",e.syauData.longnames.length)," ",g," ","named, which is"," ",r.createElement("b",null,V(p/c))," ","of the total population."),r.createElement("div",{style:{marginBlockEnd:"1em"}})),r.createElement(D,{basemap:{type:"osm",noLabels:!0},longnames:e.syauData.longnames,population:e.syauData.populations,populationOrdinals:e.syauData.populationOrdinals,centroids:e.syauData.centroids,isGuessed:v,guessedColor:n.correct,notGuessedColor:n.incorrect,voroniHighlightColor:t.hueColors.blue,height:{type:"fixed-height",value:600},attribution:"startVisible"}),r.createElement("div",{style:{marginBlockEnd:"1em"}}),r.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"auto"}},r.createElement("div",{style:{display:"inline-block"}},r.createElement(a.T,{buttonRef:b,produceSummary:function(){var t=p/c,r=Math.floor(10*t),a=n.correctEmoji.repeat(r)+n.incorrectEmoji.repeat(10-r),o=["I named ".concat(u.guessed.length,"/").concat(e.syauData.longnames.length," ").concat(g," in ").concat(e.universe),"(".concat(V(t)," of the population)"),"",a,""],i=window.location.hash;return Promise.resolve([o.join("\n"),"https://soyoureanurbanist.org".concat(""===i?"":"/".concat(i))])}})),r.createElement("div",{style:{display:"inline-block",marginInlineStart:"1em"}}),r.createElement("div",{style:{display:"inline-block"}},r.createElement("button",{style:(0,a.j)(t.hueColors.red,t.buttonTextWhite),onClick:function(){window.confirm("Are you sure you want to reset your progress?")&&l({guessed:[]})}},"Reset"))),r.createElement("div",{style:{marginBlockEnd:"1em"}}),r.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"auto"}},r.createElement(o.tG,{name:"Require pressing enter to formalize a guess",settingKey:"syauRequireEnter",testId:"syauRequireEnter"})),r.createElement("div",{style:{marginBlockEnd:"1em"}}),r.createElement(J,{longnames:e.syauData.longnames,populationOrdinals:e.syauData.populationOrdinals,isGuessed:v}))}function V(e){var t=100*e;return 100===t?"100%":t>99.9?"".concat(t.toFixed(3),"%"):t>99?"".concat(t.toFixed(2),"%"):t>90?"".concat(t.toFixed(1),"%"):"".concat(t.toFixed(0),"%")}function J(e){var t=(0,s.cI)(),n=(0,s.Rv)(),a=(0,c.wd)(),o=(0,r.useContext)(i.C.Context);return r.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(a?3:5,", 1fr)"),gap:"1em"}},e.longnames.map(function(a,i){var s=e.populationOrdinals[i],u=e.isGuessed[i],l=u?t.buttonTextWhite:t.textMain,c=u?o.link({kind:"article",longname:a},{scroll:{kind:"position",top:0}}):{};return r.createElement("a",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({key:a,className:u?"testing-syau-named":"testing-syau-not-named",style:{backgroundColor:u?n.correct:t.background,padding:"1em",borderRadius:"5px",boxShadow:u?"0 0 10px ".concat(n.correct):"0 0 10px ".concat(t.background),borderColor:t.textMain,borderWidth:"0.2em",borderStyle:"solid",color:l,textDecoration:"none"}},c),r.createElement("div",{style:{color:l,fontWeight:600}},s,"."," ",u?a.split(",")[0]:""))}))}}}]);
//# sourceMappingURL=313.js.map