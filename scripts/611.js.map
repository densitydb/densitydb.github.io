{"version":3,"file":"611.js","sources":["webpack://assets/./src/mapper/components/InsetMap.tsx","webpack://assets/./src/components/QuillEditor.tsx","webpack://assets/./src/mapper/settings/BetterDatalist.tsx","webpack://assets/./src/mapper/components/MapTextBox.tsx"],"sourcesContent":["import React, { HTMLAttributes, ReactNode, RefObject, useEffect, useRef, useState } from 'react'\nimport { MapRef, useMap } from 'react-map-gl/maplibre'\n\nimport { CommonMaplibreMap, CustomAttributionControlComponent, insetBorderWidth } from '../../components/map-common'\nimport { defaultMapBorderRadius, mapBorderWidth, useScreenshotMode } from '../../components/screenshot'\nimport { useColors } from '../../page_template/colors'\nimport { Inset } from '../../urban-stats-script/constants/insets'\nimport { TestUtils } from '../../utils/TestUtils'\nimport { Edit } from '../../utils/array-edits'\n\n// eslint-disable-next-line no-restricted-syntax -- Forward Ref\nfunction _InsetMap({ inset, children, editInset, container, i, numInsets, interactive }: {\n    inset: Inset\n    children: ReactNode\n    container: RefObject<HTMLDivElement>\n    editInset?: Edit<Inset>\n    i: number\n    numInsets: number\n    interactive: boolean\n}, ref: React.Ref<MapRef>): ReactNode {\n    const colors = useColors()\n\n    const id = `map-${i}`\n\n    const screenshotMode = useScreenshotMode()\n\n    return (\n        <div\n            id={id}\n            style={{ position: 'absolute',\n                left: `${inset.bottomLeft[0] * 100}%`,\n                bottom: `${inset.bottomLeft[1] * 100}%`,\n                width: `${(inset.topRight[0] - inset.bottomLeft[0]) * 100}%`,\n                height: `${(inset.topRight[1] - inset.bottomLeft[1]) * 100}%` }}\n        >\n            <CommonMaplibreMap\n                ref={ref}\n                style={{\n                    position: 'absolute',\n                    inset: 0,\n                    border: !inset.mainMap ? `${insetBorderWidth}px solid ${colors.mapInsetBorderColor}` : `${mapBorderWidth}px solid ${colors.borderNonShadow}`,\n                    borderRadius: !inset.mainMap || screenshotMode ? '0px' : `${defaultMapBorderRadius}px`,\n                    width: undefined,\n                    height: undefined,\n                }}\n                attributionControl={false}\n                interactive={interactive}\n            >\n                {children}\n                <HandleInsets\n                    inset={inset}\n                    setCoordBox={(newBox) => {\n                        editInset?.modify({ coordBox: newBox })\n                    }}\n                />\n                <ExposeMapForTesting id={id} />\n                { inset.mainMap && <CustomAttributionControlComponent startShowingAttribution={true} />}\n            </CommonMaplibreMap>\n            { editInset && (\n                <EditInsetsHandles\n                    frame={[...inset.bottomLeft, ...inset.topRight]}\n                    setFrame={(newFrame) => {\n                        editInset.modify({ bottomLeft: [newFrame[0], newFrame[1]], topRight: [newFrame[2], newFrame[3]] })\n                    }}\n                    container={container}\n                    delete={inset.mainMap ? undefined : editInset.delete}\n                    duplicate={inset.mainMap ? undefined : editInset.duplicate}\n                    add={inset.mainMap ? editInset.add : undefined}\n                    shouldHaveCenterHandle={!inset.mainMap || !isFullScreenInset(inset)}\n                    /*\n                    Allowing reordering on the main map in case you want to put its corner in front of an inset or something\n                    it also eliminates the weird edge case where the main map is not the 0th inset\n                    */\n                    moveUp={i + 1 < numInsets ? () => { editInset.moveUp() } : undefined}\n                    moveDown={i > 0 ? () => { editInset.moveDown() } : undefined}\n                />\n            )}\n        </div>\n    )\n}\n\n// eslint-disable-next-line no-restricted-syntax -- Forward Ref\nexport const InsetMap = React.forwardRef(_InsetMap)\n\nfunction HandleInsets({ inset, setCoordBox }: { inset: Inset, setCoordBox: (newBox: Frame) => void }): ReactNode {\n    const map = useMap().current!\n\n    useEffect(() => {\n        const fit = (): void => {\n            map.fitBounds(inset.coordBox, { animate: false })\n        }\n        fit()\n        map.on('resize', fit)\n        return () => {\n            map.off('resize', fit)\n        }\n    }, [inset, map])\n\n    useEffect(() => {\n        const getCoordBox = (): [number, number, number, number] => {\n            const mapBounds = map.getBounds()\n            const sw = mapBounds.getSouthWest()\n            const ne = mapBounds.getNorthEast()\n            return [sw.lng, sw.lat, ne.lng, ne.lat]\n        }\n\n        const moveHandler = (e: maplibregl.MapLibreEvent): void => {\n            if (e.originalEvent === undefined) {\n                // Not a user event\n                return\n            }\n            setCoordBox(getCoordBox())\n        }\n\n        map.on('moveend', moveHandler)\n\n        return () => {\n            map.off('moveend', moveHandler)\n        }\n    }, [map, setCoordBox])\n\n    return null\n}\n\nfunction ExposeMapForTesting({ id }: { id: string }): ReactNode {\n    const map = useMap().current!.getMap()\n    TestUtils.shared.maps.set(id, new WeakRef(map))\n    return null\n}\n\ntype DragKind = 'move' | `${'top' | 'bottom'}${'Right' | 'Left'}`\n\ntype Frame = [number, number, number, number]\n\nfunction isFullScreenInset(inset: Inset): boolean {\n    const tolerance = 0.005\n    return Math.abs(inset.bottomLeft[0] - 0) < tolerance\n        && Math.abs(inset.bottomLeft[1] - 0) < tolerance\n        && Math.abs(inset.topRight[0] - 1) < tolerance\n        && Math.abs(inset.topRight[1] - 1) < tolerance\n}\n\nexport function EditInsetsHandles(props: {\n    frame: Frame\n    setFrame?: (newFrame: Frame) => void\n    container: RefObject<HTMLDivElement>\n    delete?: () => void\n    duplicate?: () => void\n    add?: () => void\n    moveUp?: () => void\n    moveDown?: () => void\n    shouldHaveCenterHandle: boolean\n}): ReactNode {\n    const activeDrag = useRef<{ kind: DragKind, startX: number, startY: number, startFrame: Frame, pointerId: number } | undefined>(undefined)\n\n    const pointerHandlers = (kind: DragKind): {\n        'onPointerDown': (e: React.PointerEvent) => void\n        'onPointerMove': (e: React.PointerEvent) => void\n        'onPointerUp': (e: React.PointerEvent) => void\n        'onPointerCancel': (e: React.PointerEvent) => void\n        'data-test': string\n    } => ({\n        'data-test': kind,\n        'onPointerDown': (e: React.PointerEvent) => {\n            if (activeDrag.current !== undefined) {\n                return\n            }\n            const thisElem = e.target as HTMLDivElement\n            activeDrag.current = {\n                kind,\n                startX: e.clientX,\n                startY: e.clientY,\n                startFrame: props.frame,\n                pointerId: e.pointerId,\n            }\n            thisElem.setPointerCapture(e.pointerId)\n        },\n        'onPointerMove': (e: React.PointerEvent) => {\n            if (activeDrag.current?.pointerId !== e.pointerId) {\n                return\n            }\n            const drag = activeDrag.current\n            const containerBounds = props.container.current!.getBoundingClientRect()\n            const rawMovementX = (e.clientX - drag.startX) / containerBounds.width\n            const rawMovementY = -(e.clientY - drag.startY) / containerBounds.height\n            const resizedFrame: Frame = [\n                Math.max(0, Math.min(drag.startFrame[0] + rawMovementX, drag.startFrame[2] - 0.05)),\n                Math.max(0, Math.min(drag.startFrame[1] + rawMovementY, drag.startFrame[3] - 0.1)),\n                Math.max(drag.startFrame[0] + 0.05, Math.min(drag.startFrame[2] + rawMovementX, 1)),\n                Math.max(drag.startFrame[1] + 0.1, Math.min(drag.startFrame[3] + rawMovementY, 1)),\n            ]\n            let newFrame: Frame\n            switch (drag.kind) {\n                case 'move':\n                    const movementX = Math.max(0 - drag.startFrame[0], Math.min(rawMovementX, 1 - drag.startFrame[2]))\n                    const movementY = Math.max(0 - drag.startFrame[1], Math.min(rawMovementY, 1 - drag.startFrame[3]))\n                    newFrame = [drag.startFrame[0] + movementX, drag.startFrame[1] + movementY, drag.startFrame[2] + movementX, drag.startFrame[3] + movementY]\n                    break\n                case 'topRight':\n                    newFrame = [drag.startFrame[0], drag.startFrame[1], resizedFrame[2], resizedFrame[3]]\n                    break\n                case 'bottomRight':\n                    newFrame = [drag.startFrame[0], resizedFrame[1], resizedFrame[2], drag.startFrame[3]]\n                    break\n                case 'bottomLeft':\n                    newFrame = [resizedFrame[0], resizedFrame[1], drag.startFrame[2], drag.startFrame[3]]\n                    break\n                case 'topLeft':\n                    newFrame = [resizedFrame[0], drag.startFrame[1], drag.startFrame[2], resizedFrame[3]]\n                    break\n            }\n            props.setFrame!(newFrame)\n        },\n        'onPointerUp': (e: React.PointerEvent) => {\n            if (activeDrag.current?.pointerId !== e.pointerId) {\n                return\n            }\n            activeDrag.current = undefined\n        },\n        'onPointerCancel': (e: React.PointerEvent) => {\n            if (activeDrag.current?.pointerId !== e.pointerId) {\n                return\n            }\n            activeDrag.current = undefined\n        },\n    })\n\n    return (\n        <>\n            {props.setFrame && <Handle handleSize={15} style={{ right: `-${insetBorderWidth}px`, top: `-${insetBorderWidth}px`, cursor: 'nesw-resize' }} {...pointerHandlers('topRight')} />}\n            {props.setFrame && <Handle handleSize={15} style={{ right: `-${insetBorderWidth}px`, bottom: `-${insetBorderWidth}px`, cursor: 'nwse-resize' }} {...pointerHandlers('bottomRight')} />}\n            {props.setFrame && <Handle handleSize={15} style={{ left: `-${insetBorderWidth}px`, bottom: `-${insetBorderWidth}px`, cursor: 'nesw-resize' }} {...pointerHandlers('bottomLeft')} />}\n            {props.setFrame && <Handle handleSize={15} style={{ left: `-${insetBorderWidth}px`, top: `-${insetBorderWidth}px`, cursor: 'nwse-resize' }} {...pointerHandlers('topLeft')} />}\n            {props.setFrame && props.shouldHaveCenterHandle && (\n                <Handle handleSize={20} style={{ margin: 'auto', left: `calc(50% - 10px)`, top: `calc(50% - 10px)`, cursor: 'move' }} {...pointerHandlers('move')} />\n            )}\n            {props.duplicate && (\n                <Handle handleSize={25} data-test=\"duplicate\" style={{ margin: 'auto', left: `calc(66% - 12.5px)`, textAlign: 'center', lineHeight: '25px', top: -insetBorderWidth, cursor: 'copy' }} onClick={props.duplicate} img={{ src: '/duplicate.png', alt: 'Duplicate' }} />\n            )}\n            {props.delete && (\n                <Handle handleSize={25} data-test=\"delete\" style={{ margin: 'auto', left: `calc(33% - 12.5px)`, textAlign: 'center', lineHeight: '25px', top: -insetBorderWidth, cursor: 'default' }} onClick={props.delete} img={{ src: '/close-red-small.png', alt: 'Delete' }} />\n            )}\n            {props.add && (\n                <Handle handleSize={25} data-test=\"add\" style={{ margin: 'auto', left: `calc(50% - 12.5px)`, textAlign: 'center', top: -insetBorderWidth, cursor: 'default' }} onClick={props.add} img={{ src: '/add-green-small.png', alt: 'Add' }} />\n            )}\n            {props.moveUp && (\n                <Handle handleSize={25} data-test=\"moveUp\" style={{ left: `-${insetBorderWidth}px`, textAlign: 'center', top: `calc(50% - 25px)`, cursor: 'default' }} onClick={props.moveUp} img={{ src: '/sort-up.png', alt: 'Move Up' }} />\n            )}\n            {props.moveDown && (\n                <Handle handleSize={25} data-test=\"moveDown\" style={{ left: `-${insetBorderWidth}px`, textAlign: 'center', top: `calc(50%)`, cursor: 'default' }} onClick={props.moveDown} img={{ src: '/sort-down.png', alt: 'Move Down' }} />\n            )}\n        </>\n    )\n}\n\nfunction Handle({ handleSize, style, img, ...rest }: { handleSize: number, img?: { src: string, alt: string } } & HTMLAttributes<HTMLDivElement>): ReactNode {\n    const colors = useColors()\n    const [hover, setHover] = useState(false)\n\n    const divRef = useRef<HTMLDivElement>(null)\n\n    useEffect(() => {\n        const handleMouseEnter = (): void => {\n            setHover(true)\n        }\n\n        const handleMouseLeave = (): void => {\n            setHover(false)\n        }\n\n        const div = divRef.current!\n        div.addEventListener('mouseenter', handleMouseEnter)\n        div.addEventListener('mouseleave', handleMouseLeave)\n\n        return () => {\n            div.removeEventListener('mouseenter', handleMouseEnter)\n            div.removeEventListener('mouseleave', handleMouseLeave)\n        }\n    }, [])\n\n    return (\n        <div\n            ref={divRef}\n            role=\"button\"\n            style={{\n                backgroundColor: hover ? colors.slightlyDifferentBackgroundFocused : colors.slightlyDifferentBackground,\n                border: `1px solid ${colors.textMain}`,\n                position: 'absolute',\n                width: `${handleSize}px`,\n                height: `${handleSize}px`,\n                borderRadius: '2px',\n                ...style,\n            }}\n            {...rest}\n        >\n            {img && <img src={img.src} alt={img.alt} style={{ width: '100%', height: '100%' }} />}\n        </div>\n    )\n}\n","import katex from 'katex'\nimport { Scope } from 'parchment'\n// eslint-disable-next-line import/no-named-as-default, import/default -- These don't like the import\nimport Quill, { Delta, EmitterSource, Range } from 'quill'\nimport React, { CSSProperties, ReactNode, useEffect, useLayoutEffect, useRef } from 'react'\n\nimport 'katex/dist/katex.css'\nimport 'quill/dist/quill.snow.css'\nimport { colorThemes } from '../page_template/color-themes'\nimport { doRender, hexToColor } from '../urban-stats-script/constants/color-utils'\nimport { RichTextSegment } from '../urban-stats-script/constants/rich-text'\nimport { RemoveOptionals } from '../utils/types'\n\n// Needed for formula module\n(window as { katex: unknown }).katex = katex\n\nexport const defaultAttributes: RemoveOptionals<RichTextSegment>['attributes'] = {\n    size: 16,\n    font: 'Jost',\n    color: hexToColor(colorThemes['Light Mode'].textMain),\n    bold: false,\n    italic: false,\n    underline: false,\n    strike: false,\n    list: '',\n    indent: 0,\n    align: '',\n}\n\nconst defaultStyle = `font-family: ${defaultAttributes.font};\n    font-size: ${defaultAttributes.size}px;\n    color: ${doRender(defaultAttributes.color)};`\n\nfunction DefaultStyle(): ReactNode {\n    return (\n        <style>\n            {`\n.ql-editor {\n    ${defaultStyle}\n}\n.ql-container.ql-snow { border: none; }\n.ql-toolbar.ql-snow { border: none; }\n.ql-editor li[data-list=bullet] > .ql-ui:before {\n    content: '‚óè';\n}\n`}\n        </style>\n    )\n}\n\nexport interface QuillEditorProps {\n    editable: boolean\n    content: Delta\n    selection: Range | null\n    onTextChange: (delta: Delta) => void\n    onSelectionChange: (range: Range | null) => void\n    containerStyle?: CSSProperties\n    quillRef: React.MutableRefObject<Quill | undefined>\n}\n\nexport function QuillEditor({ editable, content, selection, onTextChange, onSelectionChange, containerStyle, quillRef }: QuillEditorProps): ReactNode {\n    const containerRef = useRef<HTMLDivElement>(null)\n    const onTextChangeRef = useRef(onTextChange)\n    const onSelectionChangeRef = useRef(onSelectionChange)\n\n    useLayoutEffect(() => {\n        onTextChangeRef.current = onTextChange\n        onSelectionChangeRef.current = onSelectionChange\n    })\n\n    useEffect(() => {\n        const container = containerRef.current!\n        const editorContainer = container.appendChild(\n            container.ownerDocument.createElement('div'),\n        )\n\n        // https://github.com/slab/quill/issues/4306#issuecomment-2225999211\n        const enterBinding: Quill['keyboard']['bindings'][string][number] = {\n            key: 'Enter',\n            handler: (range, context) => {\n                const lineFormats = Object.keys(context.format).reduce(\n                    (formats: Record<string, unknown>, format) => {\n                        if (\n                            quill.scroll.query(format, Scope.BLOCK)\n                            && !Array.isArray(context.format[format])\n                        ) {\n                            formats[format] = context.format[format]\n                        }\n                        return formats\n                    },\n                    {},\n                )\n\n                const delta = new Delta()\n                    .retain(range.index)\n                    .delete(range.length)\n                    .insert('\\n', lineFormats)\n                quill.updateContents(delta, Quill.sources.USER)\n                quill.setSelection(range.index + 1, Quill.sources.SILENT)\n\n                // NOTE: Changed from default handler!\n                // Applies previous formats on the new line. This was dropped in\n                // https://github.com/slab/quill/commit/ba5461634caa8e24641b687f2d1a8768abfec640\n                Object.keys(context.format).forEach((name) => {\n                    if (lineFormats[name]) return\n                    if (Array.isArray(context.format[name])) return\n                    if (name === 'code' || name === 'link') return\n                    quill.format(\n                        name,\n                        context.format[name],\n                        Quill.sources.USER,\n                    )\n                })\n\n                quill.focus()\n            },\n        }\n\n        const quill = new Quill(editorContainer, {\n            theme: 'snow',\n            modules: {\n                history: {\n                    maxStack: 0, // We use our own undo manager\n                },\n                toolbar: false,\n                uploader: false,\n                keyboard: {\n                    bindings: {\n                        handleEnter: enterBinding,\n                    },\n                },\n            },\n            placeholder: 'Enter text here...',\n        })\n\n        const originalFormat = quill.format.bind(quill)\n\n        // Mock the format function and emit format update events\n        quill.format = (name, value, source) => {\n            const result = originalFormat(name, value, source)\n            quill.emitter.emit('update-format')\n            return result\n        }\n\n        quillRef.current = quill\n\n        quill.on(Quill.events.EDITOR_CHANGE, (name, ...args) => {\n            switch (name) {\n                case 'text-change':\n                    {\n                        const [delta, old, source] = args as [Delta, Delta, EmitterSource]\n                        if (source !== 'api') {\n                            onTextChangeRef.current(old.compose(delta))\n                        }\n                    }\n                    break\n                case 'selection-change':\n                    {\n                        const [range, , source] = args as [Range | null, Range | null, EmitterSource]\n                        if (source !== 'api') {\n                            setTimeout(() => {\n                                onSelectionChangeRef.current(range)\n                            }) // Quill sends selection events before text events, this setTimeout ensures they don't clobber the selection state in the undo stack\n                        }\n                    }\n                    break\n            }\n        })\n        return () => {\n            quillRef.current = undefined\n            container.innerHTML = ''\n        }\n    }, [quillRef])\n\n    useEffect(() => {\n        quillRef.current?.enable(editable)\n    }, [editable, quillRef])\n\n    useEffect(() => {\n        quillRef.current?.updateContents(quillRef.current.getContents().diff(content), 'api')\n    }, [content, quillRef])\n\n    useEffect(() => {\n        const quill = quillRef.current\n        if (quill === undefined) return\n        if (quill.getSelection()?.index !== selection?.index || quill.getSelection()?.length !== selection?.length) {\n            quill.setSelection(selection, 'api')\n        }\n    }, [selection, quillRef])\n\n    return (\n        <>\n            <div ref={containerRef} style={containerStyle}></div>\n            <DefaultStyle />\n        </>\n    )\n}\n","import stableStringify from 'json-stable-stringify'\nimport React, { ReactNode, useState, useEffect, useRef, useMemo, CSSProperties } from 'react'\n\nimport { useColors } from '../../page_template/colors'\nimport { IFrameInput } from '../../utils/IFrameInput'\nimport { zIndex } from '../../utils/zIndex'\n\nimport '../../common.css'\n\nexport const labelPadding = '4px'\n\nexport interface RenderResult { text: string, node?: (highlighted: boolean) => ReactNode }\n\nexport const cannotParse = Symbol('cannotParse')\n\nexport function BetterDatalist<T>({ value, onChange, parse, possibleValues, renderValue, iframe = false, inputStyle, disabled = false, onBlur }: {\n    value: T\n    onChange: (newValue: T) => void\n    parse: (string: string) => T | typeof cannotParse\n    possibleValues: readonly T[] // Memo this for performance\n    renderValue: (v: T) => RenderResult // Memo this for performance\n    iframe?: boolean\n    inputStyle?: CSSProperties\n    disabled?: boolean\n    onBlur?: () => void\n}): ReactNode {\n    const colors = useColors()\n\n    const selectedRendered = renderValue(value)\n\n    const [searchValue, setSearchValue] = useState(selectedRendered.text)\n    const [isOpen, setIsOpen] = useState(false)\n    const [highlightedIndex, setHighlightedIndex] = useState(0)\n\n    const inputRef = useRef<HTMLInputElement>(null)\n\n    const menuRef = useRef<HTMLDivElement>(null)\n\n    // Needed if this component is reused in a different context\n    useEffect(() => {\n        setSearchValue(selectedRendered.text)\n    }, [selectedRendered.text])\n\n    const sortedOptions = useMemo(() => possibleValues.map((choice, index) => ({ renderedChoice: renderValue(choice), index })), [possibleValues, renderValue])\n\n    const handleOptionSelect = (option: typeof sortedOptions[number]): void => {\n        const newValue = possibleValues[option.index]\n        if (stableStringify(newValue) !== stableStringify(value)) {\n            onChange(newValue)\n        }\n        setSearchValue(option.renderedChoice.text)\n        setIsOpen(false)\n        setHighlightedIndex(0)\n    }\n\n    const handleKeyDown = (e: React.KeyboardEvent): void => {\n        if (!isOpen || sortedOptions.length === 0) return\n\n        switch (e.key) {\n            case 'ArrowDown':\n                e.preventDefault()\n                setHighlightedIndex(prev =>\n                    prev < sortedOptions.length - 1 ? prev + 1 : 0,\n                )\n                break\n            case 'ArrowUp':\n                e.preventDefault()\n                setHighlightedIndex(prev =>\n                    prev > 0 ? prev - 1 : sortedOptions.length - 1,\n                )\n                break\n            case 'Enter':\n                e.preventDefault()\n                const parsed = parse(searchValue)\n                if (parsed !== cannotParse) {\n                    if (stableStringify(parsed) !== stableStringify(value)) {\n                        onChange(parsed)\n                    }\n                    setIsOpen(false)\n                    setHighlightedIndex(0)\n                    inputRef.current!.blur()\n                }\n                break\n            case 'Escape':\n                e.preventDefault()\n                setIsOpen(false)\n                setHighlightedIndex(0)\n                setSearchValue(renderValue(value).text)\n                break\n        }\n    }\n\n    // eslint-disable-next-line no-restricted-syntax -- Dynamic tag name\n    const InputElem = iframe ? IFrameInput : 'input'\n\n    return (\n        <div style={{ position: 'relative', display: 'flex', alignItems: 'center', width: '50px' }}>\n            <InputElem\n                ref={inputRef}\n                type=\"text\"\n                value={searchValue}\n                onChange={(e) => {\n                    setSearchValue(e.target.value)\n                    setIsOpen(true)\n                    setHighlightedIndex(0)\n                    if (menuRef.current) {\n                        menuRef.current.scrollTop = 0\n                    }\n                }}\n                onKeyDown={handleKeyDown}\n                onClick={(e) => {\n                    (e.target as HTMLInputElement).select()\n                }}\n                onFocus={() => {\n                    setIsOpen(true)\n                    setHighlightedIndex(0)\n                }}\n                onBlur={() => {\n                    // Delay closing to allow clicking on options\n                    setTimeout(() => {\n                        setIsOpen(false)\n                        setHighlightedIndex(0)\n                        onBlur?.()\n                    }, 150)\n                }}\n                placeholder=\"Search options...\"\n                style={{\n                    width: '100%',\n                    padding: `${labelPadding} 8px`,\n                    border: `1px solid ${parse(searchValue) === cannotParse ? colors.hueColors.red : colors.ordinalTextColor}`,\n                    borderRadius: '4px',\n                    fontSize: '14px',\n                    ...inputStyle,\n                }}\n                disabled={disabled}\n            />\n            {isOpen && sortedOptions.length > 0 && (\n                <div\n                    style={{\n                        position: 'absolute',\n                        top: '100%',\n                        left: 0,\n                        right: 0,\n                        backgroundColor: colors.background,\n                        border: '1px solid #ccc',\n                        borderRadius: '4px',\n                        maxHeight: '200px',\n                        overflowY: 'auto',\n                        zIndex: zIndex.betterSelectorMenu,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n                    }}\n                    ref={menuRef}\n                >\n                    {sortedOptions.map((option, index) => (\n                        <div\n                            key={index}\n                            onMouseDown={() => {\n                                handleOptionSelect(option)\n                            }}\n                            onMouseUp={() => {\n                                handleOptionSelect(option)\n                                inputRef.current?.blur()\n                            }}\n                            style={{\n                                cursor: 'pointer',\n                                borderBottom: index < sortedOptions.length - 1 ? '1px solid #eee' : 'none',\n                            }}\n                            onMouseEnter={() => { setHighlightedIndex(index) }}\n                        >\n                            {option.renderedChoice.node?.(index === highlightedIndex) ?? <DefaultSelectorOption text={option.renderedChoice.text} highlighted={index === highlightedIndex} />}\n                        </div>\n                    ))}\n                </div>\n            )}\n        </div>\n    )\n}\n\nfunction DefaultSelectorOption(props: { text: string, highlighted: boolean }): ReactNode {\n    const colors = useColors()\n    return (\n        <div style={{\n            padding: '8px 12px',\n            background: (props.highlighted ? colors.slightlyDifferentBackgroundFocused : colors.slightlyDifferentBackground),\n            color: props.text === '' ? colors.ordinalTextColor : colors.textMain,\n        }}\n        >\n            {props.text === '' ? 'No Selection' : props.text}\n        </div>\n    )\n}\n","import Color from 'color'\n// eslint-disable-next-line import/no-named-as-default, import/default -- These don't like the import\nimport Quill, { Delta, Parchment, Range } from 'quill'\nimport React, { createContext, ReactNode, RefObject, useCallback, useContext, useEffect, useRef, useState } from 'react'\n\nimport { QuillEditor, defaultAttributes } from '../../components/QuillEditor'\nimport { useColors } from '../../page_template/colors'\nimport { doRender, hexToColor } from '../../urban-stats-script/constants/color-utils'\nimport { richTextAttributesSchema, RichTextDocument, richTextSegmentSchema } from '../../urban-stats-script/constants/rich-text'\nimport { TextBox } from '../../urban-stats-script/constants/text-box'\nimport { Property } from '../../utils/Property'\nimport { Edit } from '../../utils/array-edits'\nimport { BetterDatalist, cannotParse } from '../settings/BetterDatalist'\nimport { BetterSelector } from '../settings/BetterSelector'\n\nimport { EditInsetsHandles } from './InsetMap'\n\nconst toolbarHeight = '30px'\n\nexport function MapTextBoxComponent({ textBox: label, container, edit, i, count }: {\n    textBox: TextBox\n    container: RefObject<HTMLDivElement>\n    edit?: Edit<TextBox>\n    i: number\n    count: number\n}): ReactNode {\n    const selectionProperty = useContext(SelectionContext)\n    const selection = selectionProperty.use()\n\n    const divRef = useRef<HTMLDivElement>(null)\n\n    const colors = useColors()\n\n    const refocus = (): void => {\n        if (selection?.index === i) {\n            quillRef.current!.focus()\n        }\n    }\n    const quillRef = useRef<Quill>()\n\n    const [format, setFormat] = useState(defaultAttributes)\n\n    const updateFormat = useCallback(() => {\n        const quill = quillRef.current!\n        const currentSelection = quill.getSelection(false)\n        if (currentSelection !== null) {\n            const currentFormat = richTextAttributesSchema.parse(quill.getFormat(currentSelection.index, currentSelection.length))\n            setFormat({ ...defaultAttributes, ...currentFormat })\n        }\n    }, [])\n\n    useEffect(() => {\n        const quill = quillRef.current!\n        updateFormat()\n        quill.on('editor-change', updateFormat)\n        quill.emitter.on('update-format', updateFormat)\n        return () => {\n            quill.off('editor-change', updateFormat)\n            quill.emitter.off('update-format', updateFormat)\n        }\n    }, [updateFormat])\n\n    return (\n        <div\n            style={{ position: 'absolute',\n                left: `${label.bottomLeft[0] * 100}%`,\n                bottom: `${label.bottomLeft[1] * 100}%`,\n                width: `${(label.topRight[0] - label.bottomLeft[0]) * 100}%`,\n                height: `${(label.topRight[1] - label.bottomLeft[1]) * 100}%` }}\n            ref={divRef}\n        >\n            {edit && (\n                <div\n                    style={{\n                        position: 'absolute',\n                        bottom: '100%',\n                        backgroundColor: `${doRender(label.backgroundColor)}aa`,\n                        borderBottom: 0,\n                        borderTop: `1px solid ${colors.borderShadow}`,\n                        borderLeft: `1px solid ${colors.borderShadow}`,\n                        borderRight: `1px solid ${colors.borderShadow}`,\n                        borderRadius: '5px 5px 0 0',\n                        width: '100%',\n                        display: 'flex',\n                        alignItems: 'center',\n                        padding: '5px',\n                        flexWrap: 'wrap-reverse',\n                        gap: '5px',\n                        minWidth: 'fit-content',\n                        minHeight: 'fit-content',\n                        justifyContent: 'space-between',\n                    }}\n                >\n                    <div style={{ display: 'flex' }}>\n                        {/* Font Family Picker */}\n                        <BetterSelector\n                            iframe\n                            value={format.font}\n                            onChange={(fontFamily) => {\n                                quillRef.current!.format('font', fontFamily, 'user')\n                                updateFormat()\n                            }}\n                            possibleValues={['Jost', ...webSafeFonts]}\n                            renderValue={v => ({\n                                text: v,\n                                node: highlighted => (\n                                    <div style={{\n                                        fontFamily: v,\n                                        padding: '8px 12px',\n                                        backgroundColor: highlighted ? colors.slightlyDifferentBackgroundFocused : undefined,\n                                        color: colors.textMain,\n                                    }}\n                                    >\n                                        {v}\n                                    </div>\n                                ) })}\n                            inputStyle={{ fontFamily: format.font, height: toolbarHeight, borderRadius: '4px 0 0 4px', borderRight: 'none' }}\n                            disabled={selection?.index !== i}\n                            onBlur={refocus}\n                        />\n\n                        {/* Font Size Picker */}\n                        <BetterDatalist\n                            iframe\n                            value={format.size}\n                            onChange={(fontSize) => {\n                                quillRef.current!.format('size', `${fontSize}px`, 'user')\n                                updateFormat()\n                            }}\n                            parse={(v) => {\n                                const num = parseFloat(v)\n                                if (isFinite(num)) {\n                                    return num\n                                }\n                                return cannotParse\n                            }}\n                            possibleValues={[8, 10, 12, 14, 16, 20, 24, 36]}\n                            renderValue={v => ({\n                                text: v.toString(),\n                                node: highlighted => (\n                                    <div style={{\n                                        fontSize: v,\n                                        fontFamily: format.font,\n                                        padding: '8px 12px',\n                                        backgroundColor: highlighted ? colors.slightlyDifferentBackgroundFocused : undefined,\n                                        color: colors.textMain,\n                                    }}\n                                    >\n                                        {v}\n                                    </div>\n                                ) })}\n                            inputStyle={{ fontFamily: format.font, height: toolbarHeight, borderRadius: '0 4px 4px 0' }}\n                            disabled={selection?.index !== i}\n                            onBlur={refocus}\n                        />\n                    </div>\n\n                    <div style={{ display: 'flex' }}>\n                        {([\n                            { display: 'B', key: 'bold', style: { fontWeight: 'bold ' } },\n                            { display: 'I', key: 'italic', style: { fontStyle: 'italic' } },\n                            { display: 'U', key: 'underline', style: { textDecoration: 'underline' } },\n                            { display: 'S', key: 'strike', style: { textDecoration: 'line-through' } },\n                        ] as const).map(({ display, key, style }, buttonIndex, { length }) => {\n                            return (\n                                <button\n                                    key={key}\n                                    onClick={() => {\n                                        quillRef.current!.format(key, !format[key], 'user')\n                                        updateFormat()\n                                        refocus()\n                                    }}\n                                    disabled={selection?.index !== i}\n                                    style={{\n                                        ...style,\n                                        width: toolbarHeight,\n                                        height: toolbarHeight,\n                                        backgroundColor: format[key] ? colors.hueColors.blue : undefined,\n                                        color: format[key] ? colors.buttonTextWhite : undefined,\n                                        fontFamily: format.font,\n                                        borderRadius: buttonIndex === 0 ? '5px 0 0 5px' : (buttonIndex === length - 1) ? '0 5px 5px 0' : 0,\n                                        borderLeftWidth: buttonIndex > 0 ? 0 : undefined,\n                                        fontSize: '18px',\n                                    }}\n                                >\n                                    {display}\n                                </button>\n                            )\n                        })}\n                    </div>\n\n                    {/* Color Picker */}\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }} data-test=\"textColor\">\n                        <div style={{ color: colors.ordinalTextColor, fontSize: '14px' }}>Text</div>\n                        <input\n                            type=\"color\"\n                            value={doRender(format.color)}\n                            onChange={(e) => {\n                                quillRef.current!.format('color', Color(e.target.value).hex(), 'user')\n                                updateFormat()\n                            }}\n                            disabled={selection?.index !== i}\n                            onFocus={refocus}\n                            style={{ height: toolbarHeight }}\n                        />\n                    </div>\n\n                    <div style={{ display: 'flex' }}>\n                        {([\n                            '',\n                            'center',\n                            'right',\n                            'justify',\n                        ] as const).map((value, buttonIndex, { length }) => {\n                            return (\n                                <IconButton\n                                    key={value}\n                                    onClick={() => {\n                                        quillRef.current!.format('align', value, 'user')\n                                        updateFormat()\n                                        refocus()\n                                    }}\n                                    disabled={selection?.index !== i}\n                                    style={{\n                                        backgroundColor: format.align === value ? colors.hueColors.blue : undefined,\n                                        borderRadius: buttonIndex === 0 ? '5px 0 0 5px' : (buttonIndex === length - 1) ? '0 5px 5px 0' : 0,\n                                        borderLeftWidth: buttonIndex > 0 ? 0 : undefined,\n                                    }}\n                                    icon={value}\n                                    color={format.align === value ? colors.buttonTextWhite : colors.textMain}\n                                />\n                            )\n                        })}\n                    </div>\n\n                    {/* Background Color Picker */}\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }} data-test=\"backgroundColor\">\n                        <div style={{ color: colors.ordinalTextColor, fontSize: '14px' }}>Background</div>\n                        <input\n                            type=\"color\"\n                            value={doRender(label.backgroundColor)}\n                            onChange={(e) => {\n                                edit.modify({ backgroundColor: hexToColor(Color(e.target.value).hex()) })\n                            }}\n                            style={{ height: toolbarHeight }}\n                        />\n                    </div>\n\n                    <div style={{ display: 'flex', gap: '2px' }}>\n                        {/* Formula */}\n                        <IconButton\n                            onClick={() => {\n                                if (selection?.index === i) {\n                                    const formula = prompt('Enter formula')\n                                    if (formula) {\n                                        const quill = quillRef.current!\n                                        quill.updateContents(new Delta().retain(selection.range.index).delete(selection.range.length).insert({ formula }, quill.getFormat(selection.range.index)), 'user')\n                                        quill.setSelection(selection.range.index + 1, 'user')\n                                    }\n                                }\n                            }}\n                            disabled={selection?.index !== i}\n                            icon=\"formula\"\n                            color={colors.textMain}\n                        />\n\n                        {/* File */}\n                        <IconButton\n                            onClick={() => {\n                                if (selection?.index === i) {\n                                    const image = prompt('Enter image URL')\n                                    if (image) {\n                                        const quill = quillRef.current!\n                                        quill.updateContents(new Delta().retain(selection.range.index).delete(selection.range.length).insert({ image }, quill.getFormat(selection.range.index)), 'user')\n                                        quill.setSelection(selection.range.index + 1, 'user')\n                                    }\n                                }\n                            }}\n                            disabled={selection?.index !== i}\n                            icon=\"image\"\n                            color={colors.textMain}\n                        />\n                    </div>\n\n                    {/* Border */}\n                    <div style={{ display: 'flex', alignItems: 'center' }} data-test=\"borderColor\">\n                        <div style={{ color: colors.ordinalTextColor, fontSize: '14px' }}>Border</div>\n                        <div style={{ width: '2px' }} />\n                        <BetterDatalist\n                            iframe\n                            value={label.borderWidth}\n                            onChange={(borderWidth) => {\n                                edit.modify({ borderWidth })\n                            }}\n                            parse={(v) => {\n                                const num = parseFloat(v)\n                                if (isFinite(num)) {\n                                    return num\n                                }\n                                return cannotParse\n                            }}\n                            possibleValues={[0, 1, 2, 3, 4, 5]}\n                            renderValue={v => ({\n                                text: v.toString(),\n                            })}\n                            inputStyle={{ borderRadius: '4px 0 0 4px', height: toolbarHeight }}\n                        />\n                        <input\n                            type=\"color\"\n                            value={doRender(label.borderColor)}\n                            onChange={(e) => {\n                                edit.modify({ borderColor: hexToColor(Color(e.target.value).hex()) })\n                            }}\n                            style={{ height: toolbarHeight, borderRadius: '0 4px 4px 0', borderLeft: 'none' }}\n                        />\n                    </div>\n                </div>\n            )}\n            <QuillEditor\n                quillRef={quillRef}\n                editable={!!edit}\n                content={toQuillDelta(label.text)}\n                onTextChange={(delta) => {\n                    edit!.modify({ text: fromQuillDelta(delta) })\n                }}\n                selection={selection?.index === i ? selection.range : null}\n                onSelectionChange={(range) => {\n                    if (range !== null) {\n                        selectionProperty.value = { index: i, range }\n                    }\n                    else if (selectionProperty.value?.index === i) {\n                        selectionProperty.value = undefined\n                    }\n                }}\n                containerStyle={{ width: '100%', height: '100%', backgroundColor: doRender(label.backgroundColor), border: `${label.borderWidth}px solid ${doRender(label.borderColor)}` }}\n            />\n            { edit && (\n                <EditInsetsHandles\n                    frame={[...label.bottomLeft, ...label.topRight]}\n                    setFrame={(newFrame) => {\n                        edit.modify({ bottomLeft: [newFrame[0], newFrame[1]], topRight: [newFrame[2], newFrame[3]] })\n                    }}\n                    container={container}\n                    delete={edit.delete}\n                    duplicate={edit.duplicate}\n                    add={undefined}\n                    shouldHaveCenterHandle={true}\n                    moveUp={i + 1 < count ? () => { edit.moveUp() } : undefined}\n                    moveDown={i > 0 ? () => { edit.moveDown() } : undefined}\n                />\n            )}\n        </div>\n    )\n}\n\nexport interface Selection {\n    index: number\n    range: Range\n}\n\n// eslint-disable-next-line no-restricted-syntax -- React context\nexport const SelectionContext = createContext(new Property<Selection | undefined>(undefined))\n\nconst fontAttributor = Quill.import('attributors/style/font') as Parchment.Attributor\nfontAttributor.whitelist = undefined\nQuill.register(fontAttributor, true)\n\nconst sizeAttributor = Quill.import('attributors/style/size') as Parchment.Attributor\nsizeAttributor.whitelist = undefined\nQuill.register(sizeAttributor, true)\n\n// From https://fonts.google.com/icons\nconst paths = {\n    '': <path d=\"M120-120v-80h720v80H120Zm0-160v-80h480v80H120Zm0-160v-80h720v80H120Zm0-160v-80h480v80H120Zm0-160v-80h720v80H120Z\" />,\n    'center': <path d=\"M120-120v-80h720v80H120Zm160-160v-80h400v80H280ZM120-440v-80h720v80H120Zm160-160v-80h400v80H280ZM120-760v-80h720v80H120Z\" />,\n    'right': <path d=\"M120-760v-80h720v80H120Zm240 160v-80h480v80H360ZM120-440v-80h720v80H120Zm240 160v-80h480v80H360ZM120-120v-80h720v80H120Z\" />,\n    'justify': <path d=\"M120-120v-80h720v80H120Zm0-160v-80h720v80H120Zm0-160v-80h720v80H120Zm0-160v-80h720v80H120Zm0-160v-80h720v80H120Z\" />,\n    'formula': <path d=\"M400-240v-80h62l105-120-105-120h-66l-64 344q-8 45-37 70.5T221-120q-45 0-73-24t-28-64q0-32 17-51.5t43-19.5q25 0 42.5 17t17.5 41q0 5-.5 9t-1.5 9q5-1 8.5-5.5T252-221l62-339H200v-80h129l21-114q7-38 37.5-62t72.5-24q44 0 72 26t28 65q0 30-17 49.5T500-680q-25 0-42.5-17T440-739q0-5 .5-9t1.5-9q-6 2-9 6t-5 12l-17 99h189v80h-32l52 59 52-59h-32v-80h200v80h-62L673-440l105 120h62v80H640v-80h32l-52-60-52 60h32v80H400Z\" />,\n    'image': <path d=\"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Z\" />,\n} as const\n\nfunction IconButton(props: React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement> & { icon: keyof typeof paths, color: string }): ReactNode {\n    return (\n        <button\n            {...props}\n            style={{\n                width: toolbarHeight,\n                height: toolbarHeight,\n                padding: 0,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                ...props.style,\n            }}\n        >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 -960 960 960\" width=\"18px\" fill={props.color}>\n                {paths[props.icon]}\n            </svg>\n        </button>\n    )\n}\n\nexport function toQuillDelta(text: RichTextDocument): Delta {\n    const result = new Delta(text.map(segment => ({\n        ...segment,\n        attributes: segment.attributes && {\n            ...segment.attributes,\n            size: segment.attributes.size && `${segment.attributes.size}px`,\n            color: segment.attributes.color && doRender(segment.attributes.color),\n        },\n    })))\n    return result\n}\n\nexport function fromQuillDelta(delta: Delta): RichTextDocument {\n    const result = delta.ops.flatMap((op) => {\n        const { success, data } = richTextSegmentSchema.safeParse(op)\n        if (!success) {\n            console.warn(`Couldn't parse Quill Op ${JSON.stringify(op)}`)\n            return []\n        }\n        const droppedAttributes = Object.entries(op.attributes ?? {}).filter(\n            ([key]) => !(key in (data.attributes ?? {})),\n        )\n        if (droppedAttributes.length > 0) {\n            console.warn(`Dropped attributes: ${droppedAttributes.join(', ')}`)\n        }\n        return [data]\n    })\n    return result\n}\n\nexport function AddTextBox({ container, add }: { container: RefObject<HTMLDivElement>, add: () => void }): ReactNode {\n    return (\n        <EditInsetsHandles\n            frame={[0, 0, 1, 1]}\n            container={container}\n            add={add}\n            shouldHaveCenterHandle={false}\n        />\n    )\n}\n\nconst webSafeFonts = [\n    // Serif\n    'Times New Roman',\n    'Georgia',\n    'Garamond',\n    // Sans-serif\n    'Arial',\n    'Helvetica',\n    'Verdana',\n    'Tahoma',\n    'Trebuchet MS',\n    // Monospace\n    'Courier New',\n    'Lucida Console',\n    'Consolas',\n].sort()\n"],"names":["InsetMap","React","param","ref","inset","children","editInset","container","i","numInsets","interactive","colors","useColors","id","screenshotMode","useScreenshotMode","CommonMaplibreMap","mapBorderWidth","insetBorderWidth","defaultMapBorderRadius","undefined","HandleInsets","newBox","ExposeMapForTesting","CustomAttributionControlComponent","EditInsetsHandles","newFrame","Math","setCoordBox","map","useMap","useEffect","fit","getCoordBox","mapBounds","sw","ne","moveHandler","e","TestUtils","WeakRef","props","activeDrag","useRef","pointerHandlers","kind","thisElem","_activeDrag_current","drag","containerBounds","rawMovementX","rawMovementY","resizedFrame","movementX","movementY","Handle","_param","handleSize","style","img","rest","_useState","hover","setHover","divRef","handleMouseEnter","handleMouseLeave","div","window","katex","defaultAttributes","hexToColor","colorThemes","defaultStyle","doRender","DefaultStyle","QuillEditor","editable","content","selection","onTextChange","onSelectionChange","containerStyle","quillRef","containerRef","onTextChangeRef","onSelectionChangeRef","useLayoutEffect","editorContainer","quill","Quill","range","context","lineFormats","Object","formats","format","Scope","Array","delta","Delta","name","originalFormat","value","source","result","args","_args","old","_args1","source1","setTimeout","_quillRef_current","_quill_getSelection","_quill_getSelection1","cannotParse","Symbol","BetterDatalist","onChange","parse","possibleValues","renderValue","iframe","inputStyle","disabled","onBlur","selectedRendered","searchValue","setSearchValue","_useState1","isOpen","setIsOpen","_useState2","highlightedIndex","setHighlightedIndex","inputRef","menuRef","sortedOptions","useMemo","choice","index","handleOptionSelect","option","newValue","stableStringify","InputElem","IFrameInput","prev","parsed","zIndex","_option_renderedChoice_node1","_inputRef_current","DefaultSelectorOption","toolbarHeight","MapTextBoxComponent","text","label","edit","count","selectionProperty","useContext","SelectionContext","refocus","setFormat","updateFormat","useCallback","currentSelection","richTextAttributesSchema","BetterSelector","fontFamily","webSafeFonts","v","highlighted","fontSize","num","parseFloat","isFinite","buttonIndex","display","key","length","Color","IconButton","formula","prompt","image","borderWidth","segment","op","_op_attributes","_richTextSegmentSchema_safeParse","success","data","console","JSON","droppedAttributes","_data_attributes","_selectionProperty_value","createContext","Property","fontAttributor","sizeAttributor","paths","AddTextBox","add"],"mappings":"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"}