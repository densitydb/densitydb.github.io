{"version":3,"file":"104.js","sources":["webpack://assets/./src/components/ArticleWarnings.tsx","webpack://assets/./src/components/ArticleMap.tsx","webpack://assets/./src/data/metadata.ts","webpack://assets/./src/components/ExternalLiinks.tsx","webpack://assets/./src/data/relatedButtonColors.ts","webpack://assets/./src/components/related-button.tsx","webpack://assets/./src/components/article-panel.tsx","webpack://assets/./src/components/comparison-panel.tsx","webpack://assets/./src/sorting.ts","webpack://assets/./src/utils/Property.ts"],"sourcesContent":["import React, { ReactNode } from 'react'\n\nimport { useColors } from '../page_template/colors'\nimport { checkboxCategoryName, sourceEnabledKey, useSettings } from '../page_template/settings'\nimport { groupYearKeys, useAvailableYears, useDataSourceCheckboxes, useGroupsMissingYearSelection, useSelectedGroups } from '../page_template/statistic-settings'\nimport { Category, Group } from '../page_template/statistic-tree'\n\nimport { useScreenshotMode } from './screenshot'\n\nexport function ArticleWarnings(): ReactNode {\n    const screenshotMode = useScreenshotMode()\n    const selectedGroups = useSelectedGroups()\n    const groupsMissingYearSelection = useGroupsMissingYearSelection()\n    const availableYears = useAvailableYears()\n    const dataSourceCheckboxes = useDataSourceCheckboxes()\n    const settings = useSettings(groupYearKeys())\n\n    const allUncheckedSourceGroups = dataSourceCheckboxes\n        .filter(({ category, checkboxSpecs }) => checkboxSpecs\n            .every(({ name, forcedOn }) => !forcedOn && !settings[sourceEnabledKey({ category, name })]))\n\n    if (screenshotMode) {\n        return null\n    }\n    const warnings = selectedGroups.length === 0\n        ? [\n                <b key=\"noneSelected\">\n                    No Statistic Categories are selected\n                </b>,\n            ]\n        : [\n                ...groupsMissingYearSelection.map(groupOrCategory => (\n                    <>\n                        To see\n                        {' '}\n                        <b><HierarchicalName groupOrCategory={groupOrCategory} /></b>\n                        {' statistics, select '}\n                        <YearList years={availableYears.filter(year => groupOrCategory.years.has(year))} />\n                        .\n                    </>\n                )),\n                ...allUncheckedSourceGroups.map(({ category }) => (\n                    <>\n                        All statistics from the\n                        {' '}\n                        <b>{checkboxCategoryName(category)}</b>\n                        {' '}\n                        are disabled.\n                    </>\n                )),\n            ]\n\n    if (warnings.length === 0) {\n        return null\n    }\n\n    return <WarningBox warnings={warnings} />\n}\n\nfunction WarningBox({ warnings }: { warnings: ReactNode[] }): ReactNode {\n    const colors = useColors()\n\n    return (\n        <div\n            style={{\n                backgroundColor: colors.slightlyDifferentBackgroundFocused,\n                borderRadius: '5px',\n            }}\n            data-test-id=\"article-warnings\"\n        >\n            <ul style={{\n                paddingTop: '1em',\n                paddingBottom: '1em',\n            }}\n            >\n                {\n                    warnings.map(\n                        (warning, key) => (\n                            <li key={key}>\n                                {warning}\n                            </li>\n                        ),\n                    )\n                }\n            </ul>\n        </div>\n    )\n}\n\nfunction HierarchicalName({ groupOrCategory }: { groupOrCategory: Group | Category }): ReactNode {\n    switch (groupOrCategory.kind) {\n        case 'Group':\n            return `${groupOrCategory.parent.name} > ${groupOrCategory.name}`\n        case 'Category':\n            return groupOrCategory.name\n    }\n}\n\nfunction YearList({ years }: { years: number[] }): ReactNode {\n    switch (years.length) {\n        case 0:\n            return null\n        case 1:\n            return <b>{years[0]}</b>\n        case 2:\n            return (\n                <>\n                    <b>{years[0]}</b>\n                    {' or '}\n                    <b>{years[1]}</b>\n                </>\n            )\n        case 3:\n            return (\n                <>\n                    <b>{years[0]}</b>\n                    {', '}\n                    <b>{years[1]}</b>\n                    {', or '}\n                    <b>{years[2]}</b>\n                </>\n            )\n        default:\n            return (\n                <>\n                    <b>{years[0]}</b>\n                    {', '}\n                    <YearList years={years.slice(1)} />\n                </>\n            )\n    }\n}\n","import React, { ReactNode, useMemo, useState } from 'react'\nimport { FullscreenControl, MapRef } from 'react-map-gl/maplibre'\n\nimport 'maplibre-gl/dist/maplibre-gl.css'\nimport { RelativeLoader } from '../navigation/loading'\nimport { useColors } from '../page_template/colors'\nimport { relatedSettingsKeys, relationshipKey, useSettings } from '../page_template/settings'\nimport { randomColor } from '../utils/color'\nimport { notWaiting, waiting } from '../utils/promiseStream'\nimport { IRelatedButton, IRelatedButtons } from '../utils/protos'\nimport { isAllowedToBeShown } from '../utils/restricted-types'\nimport { NormalizeProto } from '../utils/types'\n\nimport { CommonMaplibreMap, Polygon, PolygonFeatureCollection, polygonFeatureCollection, useZoomFirstFeature } from './map-common'\n\ninterface ArticleMapProps {\n    articleType: string\n    related: NormalizeProto<IRelatedButtons>[]\n    longname: string\n}\n\nexport function ArticleMap(props: ArticleMapProps): ReactNode {\n    const [mapRef, setMapRef] = useState<MapRef | null>(null)\n\n    const features = useArticleFeatures(props).use()\n\n    const readyFeatures = useMemo(() => features.filter(notWaiting), [features])\n\n    useZoomFirstFeature(mapRef, features)\n\n    const firstFeatureWaiting = features.length > 0 && features[0] === waiting\n\n    return (\n        <div style={{ position: 'relative' }}>\n            <RelativeLoader loading={firstFeatureWaiting} />\n            <CommonMaplibreMap\n                ref={setMapRef}\n            >\n                <PolygonFeatureCollection features={readyFeatures} clickable={true} />\n                <FullscreenControl position=\"top-left\" />\n            </CommonMaplibreMap>\n        </div>\n    )\n}\n\nfunction useArticleFeatures({ articleType, related, longname }: ArticleMapProps): {\n    use: () => (GeoJSON.Feature | typeof waiting)[]\n} {\n    const settings = useSettings(['show_historical_cds', 'show_person_circles'])\n    const relatedCheckboxSettings = useSettings(relatedSettingsKeys(articleType))\n\n    const colors = useColors()\n\n    return useMemo(() => {\n        const getRelated = (key: string): NormalizeProto<IRelatedButton>[] => {\n            const element = related.filter(\n                x => x.relationshipType === key)\n                .map(x => x.buttons)[0]\n            return element\n        }\n\n        const relateds = [\n            ...getRelated('contained_by'),\n            ...getRelated('intersects'),\n            ...getRelated('borders'),\n            ...getRelated('contains'),\n            ...getRelated('same_geography'),\n        ]\n\n        const relatedShapes = (() => {\n            const result: Polygon[] = []\n            for (let i = relateds.length - 1; i >= 0; i--) {\n                if (!isAllowedToBeShown(relateds[i].rowType, settings)) {\n                    continue\n                }\n                const key = relationshipKey(articleType, relateds[i].rowType)\n                if (!relatedCheckboxSettings[key]) {\n                    continue\n                }\n\n                const color = randomColor(relateds[i].longname)\n                result.push({\n                    name: relateds[i].longname,\n                    color, weight: 1, fillColor: color, fillOpacity: 0.1,\n                })\n            }\n            return result\n        })()\n\n        const color = colors.hueColors.blue\n\n        return polygonFeatureCollection([\n            {\n                name: longname,\n                fillOpacity: 0.5, weight: 1, color, fillColor: color,\n                clickable: false,\n            },\n            ...relatedShapes,\n        ])\n    }, [articleType, colors.hueColors.blue, longname, related, relatedCheckboxSettings, settings])\n}\n","export default {\n    \"displayed_metadata\": [\n        {\n            \"index\": 0,\n            \"name\": \"US Census GeoID\"\n        },\n        {\n            \"index\": 1,\n            \"name\": \"StatCan GeoCode\"\n        },\n        {\n            \"index\": 4,\n            \"name\": \"ISO Code\"\n        }\n    ],\n    \"external_link_metadata\": [\n        {\n            \"index\": 2,\n            \"site\": \"Wikidata\",\n            \"link_prefix\": \"https://www.wikidata.org/wiki/\",\n            \"normalizer\": null\n        },\n        {\n            \"index\": 3,\n            \"site\": \"Wikipedia\",\n            \"link_prefix\": \"https://en.wikipedia.org/wiki/\",\n            \"normalizer\": \"wikipedia\"\n        }\n    ]\n} as const","import React, { ReactNode } from 'react'\n\nimport metadata from '../data/metadata'\nimport { Colors } from '../page_template/color-themes'\nimport { useColors } from '../page_template/colors'\nimport { assert } from '../utils/defensive'\nimport { IMetadata } from '../utils/protos'\n\ntype ExternalLinkSpec = (typeof metadata.external_link_metadata)[number]\ntype NormalizerSpec = ExternalLinkSpec['normalizer']\n\nexport function ExternalLinks(props: { metadataProtos: IMetadata[] }): ReactNode {\n    const elementsEach = metadata.external_link_metadata.flatMap((meta) => {\n        const foundMetadata = props.metadataProtos.find(m => m.metadataIndex === meta.index)\n        if (foundMetadata === undefined) {\n            return []\n        }\n        return [<ExternalLink key={meta.index} meta={meta} metaProto={foundMetadata} />]\n    })\n\n    return <>{elementsEach}</>\n}\n\nfunction ExternalLink(props: { meta: ExternalLinkSpec, metaProto: IMetadata }): ReactNode {\n    const colors = useColors()\n    const sv = props.metaProto.stringValue\n    assert(sv !== undefined && sv !== null, `ExternalLink: stringValue is undefined for metadata index ${props.meta.index}`)\n    return (\n        <a\n            href={props.meta.link_prefix + computeLinkSuffix(props.meta.normalizer, sv)}\n        >\n            <img\n                style={{ height: '36px', marginRight: '8px', verticalAlign: 'middle' }}\n                src={imageURLFor(props.meta.site, colors)}\n            />\n        </a>\n    )\n}\n\nfunction computeLinkSuffix(normalizer: NormalizerSpec, sv: string): string {\n    switch (normalizer) {\n        case null:\n            return sv\n        case 'wikipedia':\n            return sv.replace(/ /g, '_')\n    }\n}\n\nfunction imageURLFor(site: ExternalLinkSpec['site'], colors: Colors): string {\n    switch (site) {\n        case 'Wikipedia':\n            return '/wikipedia.svg'\n        case 'Wikidata':\n            return colors.wikidataURL\n    }\n}\n","export default [\n    [\n        \"International\",\n        \"red\"\n    ],\n    [\n        \"International City\",\n        \"red\"\n    ],\n    [\n        \"US Subdivision\",\n        \"blue\"\n    ],\n    [\n        \"US City\",\n        \"blue\"\n    ],\n    [\n        \"Census\",\n        \"cyan\"\n    ],\n    [\n        \"Political\",\n        \"purple\"\n    ],\n    [\n        \"Oddball\",\n        \"darkGrey\"\n    ],\n    [\n        \"Kavi\",\n        \"brown\"\n    ],\n    [\n        \"School\",\n        \"yellow\"\n    ],\n    [\n        \"Small\",\n        \"pink\"\n    ],\n    [\n        \"Native\",\n        \"green\"\n    ]\n] as const","import React, { ReactNode, useContext, useId } from 'react'\n\nimport relatedButtonColors from '../data/relatedButtonColors'\nimport type_ordering_idx from '../data/type_ordering_idx'\nimport type_to_type_category from '../data/type_to_type_category'\nimport { Navigator } from '../navigation/Navigator'\nimport { HueColors } from '../page_template/color-themes'\nimport { useColors } from '../page_template/colors'\nimport { relationshipKey, useSettings } from '../page_template/settings'\nimport { useUniverse } from '../universe'\nimport { DefaultMap } from '../utils/DefaultMap'\nimport { mixWithBackground } from '../utils/color'\nimport { useMobileLayout } from '../utils/responsive'\nimport { isAllowedToBeShown } from '../utils/restricted-types'\nimport { displayType } from '../utils/text'\n\nimport { CheckboxSetting } from './sidebar'\n\ninterface Region { rowType: string, longname: string, shortname: string }\n\nconst propForRegionTypes = 0.20\nconst spacing = 2\n\nfunction colorsEach(colors: HueColors): Record<string, string> {\n    const keys: [string, string][] = relatedButtonColors.map(\n        ([typ, color]) => [typ, colors[color]],\n    )\n    return Object.fromEntries(keys)\n}\n\nfunction useRelatedColor(rowType: string, colorIntensity: number): string {\n    const colors = useColors()\n    const typeCategory = type_to_type_category[rowType]\n    const color = colorsEach(colors.hueColors)[typeCategory]\n    return mixWithBackground(color, (colors.mixPct + (100 - colors.mixPct) * (1 - colorIntensity)) / 100, colors.background)\n}\n\nfunction RelatedButton(props: { region: Region }): ReactNode {\n    const currentUniverse = useUniverse()\n    const colors = useColors()\n    const navContext = useContext(Navigator.Context)\n    return (\n        <li style={{\n            display: 'flex',\n            margin: `${spacing}px`,\n        }}\n        >\n            <a\n                className=\"serif\"\n                style={{\n                    color: colors.textMain,\n                    backgroundColor: useRelatedColor(props.region.rowType, 1),\n                    textDecoration: 'none',\n                    padding: '2px 6px 2px 6px',\n                    borderRadius: '5px',\n                    fontWeight: 400,\n                    fontSize: useMobileLayout() ? '12pt' : '8pt',\n                }}\n                {...navContext.link(\n                    { kind: 'article', longname: props.region.longname, universe: currentUniverse },\n                    { scroll: { kind: 'position', top: 0 } },\n                )}\n            >\n                {props.region.shortname}\n            </a>\n        </li>\n    )\n}\n\nfunction Label(props: { checkId: string, children: ReactNode, fontWeight: number }): ReactNode {\n    return (\n        <div\n            className=\"serif\"\n            style={{\n                fontSize: useMobileLayout() ? '12pt' : '10pt',\n                fontWeight: props.fontWeight,\n                alignContent: 'center',\n                margin: `${spacing}px`,\n            }}\n        >\n            <label htmlFor={props.checkId}>\n                {props.children}\n            </label>\n        </div>\n    )\n}\n\nfunction RelationshipGroup(props: { regions: Region[], checkId: string, relationshipType: string, groupIndex: number, buttonType: string, numGroups: number }): ReactNode {\n    function displayName(name: string): string {\n        name = name.replaceAll('_', ' ')\n        // title case\n        name = name.replace(/\\w\\S*/g, function (txt) {\n            return txt.charAt(0).toUpperCase() + txt.slice(1).toLowerCase()\n        })\n        return name\n    }\n\n    const backgroundColor = useRelatedColor(props.buttonType, props.groupIndex % 2 === 0 ? 0.3 : 0.4)\n\n    return (\n        <ul\n            style={{\n                display: 'flex',\n                flexFlow: 'row wrap',\n                paddingInlineStart: '0px',\n                listStyleType: 'none',\n                padding: `${spacing}px`,\n                paddingLeft: `${spacing}px`, // Prevents errors\n                ...(props.numGroups > 1\n                    ? {\n                            backgroundColor,\n                            // Border radius if first or last group\n                            borderRadius: props.groupIndex === 0 ? '5px 5px 0 0' : (props.groupIndex === props.numGroups - 1 ? '0 0 5px 5px' : undefined),\n                            paddingLeft: `${2 * spacing}px`,\n                        }\n                    : {}),\n            }}\n        >\n            <Label checkId={props.checkId} fontWeight={400}>\n                {displayName(props.relationshipType)}\n            </Label>\n            {\n                props.regions.map((row, i) => (\n                    <RelatedButton\n                        key={i}\n                        region={row}\n                    />\n                ),\n                )\n            }\n        </ul>\n    )\n}\n\nfunction Row(props: {\n    articleType: string\n    buttonType: string\n    regions: Map<string, Region[]>\n    rowIndex: number\n    totalRows: number\n}): ReactNode {\n    const settingKey = relationshipKey(props.articleType, props.buttonType)\n\n    const checkId = useId()\n\n    const universe = useUniverse()\n\n    return (\n        <li style={{\n            paddingInlineStart: '0px',\n            listStyleType: 'none',\n            margin: 0,\n            width: '100%',\n            display: 'flex',\n            alignItems: 'center',\n            position: 'relative',\n            backgroundColor: useRelatedColor(props.buttonType, props.rowIndex % 2 === 0 ? 0.1 : 0.2),\n            // Border radius if first or last row\n            borderRadius: props.rowIndex === 0 ? '5px 5px 0 0' : (props.rowIndex === props.totalRows - 1 ? '0 0 5px 5px' : undefined),\n        }}\n        >\n            <div style={{\n                display: 'flex',\n                width: `${100 * propForRegionTypes}%`,\n                alignItems: 'center',\n            }}\n            >\n                <CheckboxSetting\n                    name=\"\"\n                    settingKey={settingKey}\n                    classNameToUse=\"related_checkbox\"\n                    id={checkId}\n                />\n                <Label checkId={checkId} fontWeight={500}>\n                    {displayType(universe, props.buttonType)}\n                </Label>\n            </div>\n            <ul style={{\n                paddingInlineStart: '0px',\n                listStyleType: 'none',\n                margin: 0,\n                width: `${100 * (1 - propForRegionTypes)}%`,\n                display: 'flex',\n                flexDirection: 'column',\n                padding: props.regions.size > 1 ? `${2 * spacing}px` : `0 0 0 ${3 * spacing}px`,\n            }}\n            >\n                {\n                    Array.from(props.regions).map(([relationshipType, regions], i) => {\n                        return (\n                            <RelationshipGroup\n                                key={relationshipType}\n                                regions={regions}\n                                checkId={checkId}\n                                relationshipType={relationshipType}\n                                groupIndex={i}\n                                buttonType={props.buttonType}\n                                numGroups={props.regions.size}\n                            />\n                        )\n                    })\n                }\n            </ul>\n        </li>\n    )\n}\n\nexport function Related(props: { articleType: string, related: { relationshipType: string, buttons: Region[] }[] }): ReactNode {\n    // buttons[rowType][relationshipType] = <list of buttons>\n    const showSettings = useSettings(['show_historical_cds', 'show_person_circles'])\n    const buttons = new DefaultMap<string, DefaultMap<string, Region[]>>(() => new DefaultMap(() => []))\n    for (const relateds of props.related) {\n        for (const button of relateds.buttons) {\n            buttons.get(button.rowType).get(relateds.relationshipType).push(button)\n        }\n    }\n\n    // get a sorted list of keys of buttons\n    const buttonKeys = Array.from(buttons.keys())\n        .sort((a, b) => type_ordering_idx[a] - type_ordering_idx[b])\n        .filter(buttonKey => isAllowedToBeShown(buttonKey, showSettings))\n\n    const elements = buttonKeys.map((key, i) => (\n        <Row\n            key={key}\n            buttonType={key}\n            regions={buttons.get(key)}\n            articleType={props.articleType}\n            rowIndex={i}\n            totalRows={buttonKeys.length}\n        />\n    ))\n\n    return (\n        <ul style={{\n            margin: '1em 0',\n            paddingInlineStart: '0px',\n            listStyleType: 'none',\n        }}\n        >\n            {elements}\n        </ul>\n    )\n}\n","import '../common.css'\nimport './article.css'\n\nimport React, { ReactNode, useContext, useRef } from 'react'\n\nimport { Navigator } from '../navigation/Navigator'\nimport { sanitize } from '../navigation/links'\nimport { useColors } from '../page_template/colors'\nimport { rowExpandedKey, useSetting, useSettings } from '../page_template/settings'\nimport { groupYearKeys, StatGroupSettings } from '../page_template/statistic-settings'\nimport { statParents } from '../page_template/statistic-tree'\nimport { PageTemplate } from '../page_template/template'\nimport { useUniverse } from '../universe'\nimport { Article, IRelatedButtons } from '../utils/protos'\nimport { useComparisonHeadStyle, useHeaderTextClass, useMobileLayout, useSubHeaderTextClass } from '../utils/responsive'\nimport { NormalizeProto } from '../utils/types'\n\nimport { ArticleMap } from './ArticleMap'\nimport { ArticleWarnings } from './ArticleWarnings'\nimport { ExternalLinks } from './ExternalLiinks'\nimport { QuerySettingsConnection } from './QuerySettingsConnection'\nimport { pullRelevantPlotProps } from './comparison-panel'\nimport { generateCSVDataForArticles, CSVExportData } from './csv-export'\nimport { ArticleRow } from './load-article'\nimport { Related } from './related-button'\nimport { createScreenshot, ScreencapElements, useScreenshotMode } from './screenshot'\nimport { SearchBox } from './search'\nimport { CellSpec, PlotSpec, TableContents } from './supertable'\nimport { ColumnIdentifier } from './table'\n\nexport function ArticlePanel({ article, rows }: { article: Article, rows: (settings: StatGroupSettings) => ArticleRow[][] }): ReactNode {\n    const headersRef = useRef<HTMLDivElement>(null)\n    const tableRef = useRef<HTMLDivElement>(null)\n    const mapRef = useRef<HTMLDivElement>(null)\n\n    const screencapElements = (): ScreencapElements => ({\n        path: `${sanitize(article.longname)}.png`,\n        overallWidth: tableRef.current!.offsetWidth * 2,\n        elementsToRender: [headersRef.current!, tableRef.current!, mapRef.current!],\n    })\n\n    const headerTextClass = useHeaderTextClass()\n    const subHeaderTextClass = useSubHeaderTextClass()\n    const comparisonHeadStyle = useComparisonHeadStyle('right')\n\n    const settings = useSettings(groupYearKeys())\n    const filteredRows = rows(settings)[0]\n\n    const csvData = generateCSVDataForArticles([article], [filteredRows], true)\n    const csvFilename = `${sanitize(article.longname)}.csv`\n    const csvExportData: CSVExportData = { csvData, csvFilename }\n\n    return (\n        <>\n            <QuerySettingsConnection />\n            <PageTemplate\n                screencap={(universe, colors) => createScreenshot(screencapElements(), universe, colors)}\n                csvExportData={csvExportData}\n                hasUniverseSelector={true}\n                universes={article.universes}\n            >\n                <div>\n                    <div ref={headersRef}>\n                        <div className={headerTextClass}>{article.shortname}</div>\n                        <div className={subHeaderTextClass}>{article.longname}</div>\n                    </div>\n                    <div style={{ marginBlockEnd: '16px' }}></div>\n\n                    <div ref={tableRef}>\n                        <ArticleTable\n                            filteredRows={filteredRows}\n                            article={article}\n                        />\n                    </div>\n\n                    <p></p>\n\n                    <div ref={mapRef}>\n                        <ArticleMap\n                            longname={article.longname}\n                            related={article.related as NormalizeProto<IRelatedButtons>[]}\n                            articleType={article.articleType}\n                        />\n                    </div>\n\n                    <div style={{ marginBlockEnd: '1em' }}></div>\n\n                    <div style={{ display: 'flex', alignItems: 'center' }}>\n                        <div style={{ flex: '0 0 auto', marginRight: '1em' }}>\n                            <ExternalLinks metadataProtos={article.metadata} />\n                        </div>\n                        <div style={{ flex: '0 0 auto', marginRight: '1em' }}>\n                            <div className=\"serif\" style={comparisonHeadStyle}>Compare to: </div>\n                        </div>\n                        <div style={{ flex: '1 1 auto' }}>\n                            <ComparisonSearchBox longname={article.longname} type={article.articleType} />\n                        </div>\n                    </div>\n\n                    <Related\n                        related={article.related as NormalizeProto<IRelatedButtons>[]}\n                        articleType={article.articleType}\n                    />\n                </div>\n            </PageTemplate>\n        </>\n    )\n}\n\ntype NameSpec = Extract<CellSpec, { type: 'statistic-name' }>\n\nfunction getGroupAndDisplayNames(nameSpec: NameSpec, nameSpecs: NameSpec[]): [string | undefined, string] {\n    if (nameSpec.row === undefined) {\n        return [undefined, nameSpec.renderedStatname]\n    }\n    const statParent = statParents.get(nameSpec.row.statpath)\n\n    const groupRows = nameSpecs.filter(s => s.row !== undefined && statParents.get(s.row.statpath)?.group.id === statParent?.group.id)\n    const groupSize = groupRows.length\n\n    const groupSourcesSet = new Set(\n        groupRows\n            .map(s => statParents.get(s.row!.statpath)?.source)\n            .filter(source => source !== null)\n            .map(source => source!.name),\n    )\n    const groupHasMultipleSources = groupSourcesSet.size > 1\n\n    const sourceName = statParent?.source?.name\n    let displayName = groupSize > 1 ? (statParent?.indentedName ?? nameSpec.renderedStatname) : nameSpec.renderedStatname\n    if (groupHasMultipleSources && sourceName) {\n        displayName = `${displayName} [${sourceName}]`\n    }\n    const groupName = groupSize > 1 ? statParent?.group.name : undefined\n    return [groupName, displayName]\n}\n\nexport function computeNameSpecsWithGroups(nameSpecs: NameSpec[]): { updatedNameSpecs: NameSpec[], groupNames: (string | undefined)[] } {\n    const updatedNameSpecs: NameSpec[] = []\n    const groupNames: (string | undefined)[] = []\n\n    for (const spec of nameSpecs) {\n        const [groupName, displayName] = getGroupAndDisplayNames(spec, nameSpecs)\n\n        updatedNameSpecs.push({\n            ...spec,\n            isIndented: groupName !== undefined,\n            displayName,\n        })\n        groupNames.push(groupName)\n    }\n\n    return { updatedNameSpecs, groupNames }\n}\n\nfunction ArticleTable(props: {\n    filteredRows: ArticleRow[]\n    article: Article\n}): ReactNode {\n    const colors = useColors()\n    const expandedSettings = useSettings(props.filteredRows.map(row => rowExpandedKey(row.statpath)))\n    const expandedEach = props.filteredRows.map(row => expandedSettings[rowExpandedKey(row.statpath)])\n    const currentUniverse = useUniverse()\n    const [simpleOrdinals] = useSetting('simple_ordinals')\n    const navContext = useContext(Navigator.Context)\n\n    const { widthLeftHeader, columnWidth } = useWidths()\n\n    const statNameSpecs: Extract<CellSpec, { type: 'statistic-name' }>[] = props.filteredRows.map(row => ({\n        type: 'statistic-name',\n        longname: props.article.longname,\n        row,\n        renderedStatname: row.renderedStatname,\n        currentUniverse,\n    }))\n\n    const { updatedNameSpecs: leftHeaderSpecs, groupNames } = computeNameSpecsWithGroups(statNameSpecs)\n\n    const onlyColumns: ColumnIdentifier[] = ['statval', 'statval_unit', 'statistic_percentile', 'statistic_ordinal', 'pointer_in_class', 'pointer_overall']\n    const cellSpecs: CellSpec[][] = props.filteredRows.map(row => [({\n        type: 'statistic-row',\n        longname: props.article.longname,\n        row,\n        onNavigate: (newArticle) => {\n            void navContext.navigate({\n                kind: 'article',\n                longname: newArticle,\n                universe: currentUniverse,\n            }, { history: 'push', scroll: { kind: 'none' } })\n        },\n        simpleOrdinals,\n        onlyColumns,\n    })])\n\n    const plotSpecs: (PlotSpec | undefined)[] = expandedEach.map((expanded, index) => expanded\n        ? {\n                statDescription: props.filteredRows[index].renderedStatname,\n                plotProps: pullRelevantPlotProps(\n                    props.filteredRows,\n                    index,\n                    colors.hueColors.blue,\n                    props.article.shortname,\n                    props.article.longname,\n                    props.article.articleType,\n                ),\n            }\n        : undefined,\n    )\n\n    const topLeftSpec = { type: 'top-left-header' } satisfies CellSpec\n\n    return (\n        <div className=\"stats_table\">\n            <TableContents\n                leftHeaderSpec={{ leftHeaderSpecs, groupNames }}\n                rowSpecs={cellSpecs}\n                horizontalPlotSpecs={plotSpecs}\n                verticalPlotSpecs={[]}\n                topLeftSpec={topLeftSpec}\n                widthLeftHeader={widthLeftHeader}\n                columnWidth={columnWidth}\n                onlyColumns={onlyColumns}\n                simpleOrdinals={simpleOrdinals}\n            />\n            <ArticleWarnings />\n        </div>\n    )\n}\n\nexport function StatisticHeader(props: {\n    longname: string\n    groupName?: string\n}): ReactNode {\n    return (\n        <div style={{ width: '100%', padding: '1px' }}>\n            <span className=\"serif value\">\n                <span>{props.groupName}</span>\n            </span>\n        </div>\n    )\n}\n\nfunction ComparisonSearchBox({ longname, type }: { longname: string, type: string }): ReactNode {\n    const currentUniverse = useUniverse()\n    const navContext = useContext(Navigator.Context)\n    return (\n        <SearchBox\n            style={{ ...useComparisonHeadStyle(), width: '100%' }}\n            placeholder=\"Other region...\"\n            link={x => navContext.link({\n                kind: 'comparison',\n                universe: currentUniverse,\n                longnames: [longname, x],\n            }, { scroll: { kind: 'position', top: 0 } })}\n            autoFocus={false}\n            prioritizeArticleType={type}\n        />\n    )\n}\n\nfunction useWidths(): { widthLeftHeader: number, columnWidth: number } {\n    const [simpleOrdinals] = useSetting('simple_ordinals')\n    const isMobile = useMobileLayout()\n    const screenshotMode = useScreenshotMode()\n\n    // TODO clean this up and reduce the amount of magic numbers\n    const nonPointerColumns = 15 + 10 + (simpleOrdinals ? 7 + 8 : 17 + 25)\n    const pointerColumns = 8 * (screenshotMode ? 0 : (!simpleOrdinals && isMobile ? 1 : 2))\n    const numerator = 31\n    const denominator = nonPointerColumns + pointerColumns + numerator\n    const widthLeftHeader = 100 * (numerator / denominator)\n    const columnWidth = 100 - widthLeftHeader\n    return { widthLeftHeader, columnWidth }\n}\n","import '../common.css'\nimport './article.css'\n\nimport { DndContext, DragEndEvent, DragOverlay, DragStartEvent, PointerSensor, TouchSensor, useSensor, useSensors, closestCenter } from '@dnd-kit/core'\nimport { SortableContext, arrayMove, horizontalListSortingStrategy, verticalListSortingStrategy } from '@dnd-kit/sortable'\nimport React, { ReactNode, useContext, useId, useMemo, useRef, useState } from 'react'\nimport { FullscreenControl, MapRef } from 'react-map-gl/maplibre'\n\nimport { boundingBox, extendBoxes } from '../map-partition'\nimport { Navigator } from '../navigation/Navigator'\nimport { sanitize } from '../navigation/links'\nimport { colorFromCycle, useColors } from '../page_template/colors'\nimport { rowExpandedKey, useSettings } from '../page_template/settings'\nimport { groupYearKeys, StatGroupSettings } from '../page_template/statistic-settings'\nimport { statParents, Year } from '../page_template/statistic-tree'\nimport { PageTemplate } from '../page_template/template'\nimport { compareArticleRows } from '../sorting'\nimport { useUniverse } from '../universe'\nimport { mixWithBackground } from '../utils/color'\nimport { assert } from '../utils/defensive'\nimport { notWaiting, waiting } from '../utils/promiseStream'\nimport { Article } from '../utils/protos'\nimport { useComparisonHeadStyle, useHeaderTextClass, useMobileLayout, useSubHeaderTextClass } from '../utils/responsive'\nimport { TransposeContext } from '../utils/transpose'\nimport { zIndex } from '../utils/zIndex'\n\nimport { ArticleWarnings } from './ArticleWarnings'\nimport { QuerySettingsConnection } from './QuerySettingsConnection'\nimport { computeNameSpecsWithGroups } from './article-panel'\nimport { generateCSVDataForArticles, CSVExportData } from './csv-export'\nimport { ArticleRow } from './load-article'\nimport { CommonMaplibreMap, PolygonFeatureCollection, polygonFeatureCollection, useZoomAllFeatures, defaultMapPadding, CustomAttributionControlComponent } from './map-common'\nimport { PlotProps } from './plots'\nimport { createScreenshot, ScreencapElements, useScreenshotMode } from './screenshot'\nimport { SearchBox } from './search'\nimport { TableContents, CellSpec } from './supertable'\nimport { ColumnIdentifier } from './table'\n\nexport function ComparisonPanel(props: { universes: string[], articles: Article[], rows: (settings: StatGroupSettings) => ArticleRow[][], mapPartitions: number[][] }): ReactNode {\n    const colors = useColors()\n    const tableRef = useRef<HTMLDivElement>(null)\n    const mapRef = useRef(null)\n\n    // State for drag overlay and articles\n    const [activeId, setActiveId] = useState<string | null>(null)\n    const [localArticles, setLocalArticles] = useState<{ value: Article[], propsValue: Article[] }>({ value: props.articles, propsValue: props.articles })\n\n    const [sortByStatIndex, setSortByStatIndex] = useState<number | null>(null)\n    const [sortDirection, setSortDirection] = useState<'up' | 'down'>('down')\n\n    // Sensors for drag and drop - more sensitive for vertical dragging\n    const sensors = useSensors(\n        useSensor(PointerSensor, {\n            activationConstraint: {\n                distance: 1,\n            },\n        }),\n        useSensor(TouchSensor, {\n            activationConstraint: {\n                delay: 50,\n                tolerance: 0,\n            },\n        }),\n    )\n\n    // Sync local state with props\n    let localArticlesToUse\n    if (localArticles.propsValue === props.articles) {\n        localArticlesToUse = localArticles.value\n    }\n    else {\n        setLocalArticles({ propsValue: props.articles, value: props.articles })\n        localArticlesToUse = props.articles\n    }\n\n    const joinedString = localArticlesToUse.map(x => x.shortname).join(' vs ')\n    const names = localArticlesToUse.map(a => a.longname)\n\n    const screencapElements = (): ScreencapElements => ({\n        path: `${sanitize(joinedString)}.png`,\n        overallWidth: tableRef.current!.offsetWidth * 2,\n        elementsToRender: [tableRef.current!, mapRef.current!],\n    })\n\n    // Drag and drop handlers\n    const handleDragStart = (event: DragStartEvent): void => {\n        setActiveId(event.active.id as string)\n    }\n\n    const handleDragEnd = (event: DragEndEvent): void => {\n        const { active, over } = event\n\n        if (over && active.id !== over.id) {\n            const oldIndex = localArticlesToUse.findIndex(article => article.shortname === active.id)\n            const newIndex = localArticlesToUse.findIndex(article => article.shortname === over.id)\n\n            const newArticles = arrayMove(localArticlesToUse, oldIndex, newIndex)\n            const newLongnames = newArticles.map(a => a.longname)\n\n            // Update local state immediately for responsive UI\n            setLocalArticles({ propsValue: props.articles, value: newArticles })\n\n            // Update the URL to reflect the new order\n            void navContext.navigate({\n                kind: 'comparison',\n                universe: navContext.universe,\n                longnames: newLongnames,\n            }, { history: 'push', scroll: { kind: 'none' } })\n        }\n\n        setActiveId(null)\n    }\n\n    const settings = useSettings(groupYearKeys())\n\n    const dataByArticleStat = props.rows(settings)\n    const dataByStatArticle = dataByArticleStat[0].map((_, statIndex) => dataByArticleStat.map(articleData => articleData[statIndex]))\n\n    const handleSort = (statIndex: number): void => {\n        let newSortDirection: 'up' | 'down' | 'both'\n        if (sortByStatIndex === statIndex) {\n            newSortDirection = sortDirection === 'up' ? 'down' : 'up'\n        }\n        else {\n            newSortDirection = 'down'\n            setSortByStatIndex(statIndex)\n        }\n\n        setSortDirection(newSortDirection)\n\n        const statData = dataByStatArticle[statIndex]\n        const sortedIndices = statData\n            .map((row, index) => ({ row, index }))\n            .sort((a, b) => compareArticleRows(a.row, b.row, newSortDirection))\n            .map(item => item.index)\n\n        const newArticles = sortedIndices.map(index => localArticlesToUse[index])\n\n        setLocalArticles({ propsValue: props.articles, value: newArticles })\n\n        void navContext.navigate({\n            kind: 'comparison',\n            universe: navContext.universe,\n            longnames: newArticles.map(a => a.longname),\n        }, { history: 'push', scroll: { kind: 'none' } })\n    }\n\n    const mobileLayout = useMobileLayout()\n\n    const validOrdinalsByStat = dataByStatArticle.map(statData => statData.every(value => value.disclaimer !== 'heterogenous-sources'))\n\n    const includeOrdinals = (\n        localArticlesToUse.every(article => article.articleType === localArticlesToUse[0].articleType)\n        && (validOrdinalsByStat.length === 0 || validOrdinalsByStat.some(x => x))\n    )\n\n    const onlyColumns: ColumnIdentifier[] = includeOrdinals ? ['statval', 'statval_unit', 'statistic_ordinal', 'statistic_percentile'] : ['statval', 'statval_unit']\n\n    const maxColumns = mobileLayout ? 3 : 6\n\n    const expandedSettings = useSettings(dataByStatArticle.filter(statData => statData.some(row => row.extraStat !== undefined)).map(([{ statpath }]) => rowExpandedKey(statpath)))\n\n    const expandedByStatIndex = dataByStatArticle.map(([{ statpath }]) => expandedSettings[rowExpandedKey(statpath)] ?? false)\n    const numExpandedExtras = expandedByStatIndex.filter(v => v).length\n\n    let widthColumns = (includeOrdinals ? 1.5 : 1) * localArticlesToUse.length + 1\n    let widthTransposeColumns = (includeOrdinals ? 1.5 : 1) * (dataByArticleStat[0].length + numExpandedExtras) + 1.5\n\n    const transpose = widthColumns > maxColumns && widthColumns > widthTransposeColumns\n\n    if (transpose) {\n        ([widthColumns, widthTransposeColumns] = [widthTransposeColumns, widthColumns])\n    }\n\n    const leftMarginPercent = transpose ? 0.24 : 0.18\n    const numColumns = transpose ? dataByArticleStat[0].length : localArticlesToUse.length\n    const columnWidth = 100 * (1 - leftMarginPercent) / (numColumns + (transpose ? numExpandedExtras : 0))\n\n    const scrollColumnsDivisor = mobileLayout ? 3.5 : 5.3\n\n    const maybeScroll = (contents: React.ReactNode): ReactNode => {\n        if (widthColumns > maxColumns) {\n            return (\n                <div style={{ overflowX: 'scroll' }}>\n                    <div style={{ width: `${100 * widthColumns / scrollColumnsDivisor}%` }}>\n                        {contents}\n                    </div>\n                </div>\n            )\n        }\n        return contents\n    }\n\n    const highlightArticleIndicesByStat: (number | undefined)[] = dataByStatArticle.map(articlesStatData => getHighlightIndex(articlesStatData))\n\n    const headerTextClass = useHeaderTextClass()\n    const subHeaderTextClass = useSubHeaderTextClass()\n    const comparisonRightStyle = useComparisonHeadStyle('right')\n    const searchComparisonStyle = useComparisonHeadStyle()\n\n    const currentUniverse = useUniverse()\n\n    const navContext = useContext(Navigator.Context)\n\n    const sharedTypeOfAllArticles = localArticlesToUse.every(article => article.articleType === localArticlesToUse[0].articleType) ? localArticlesToUse[0].articleType : undefined\n\n    const rowToDisplayForStat = (statIndex: number): ArticleRow => {\n        return dataByStatArticle[statIndex].find(row => row.extraStat !== undefined) ?? dataByStatArticle[statIndex][0]\n    }\n\n    const plotProps = (statIndex: number): PlotProps[] => dataByStatArticle[statIndex].flatMap((row, articleIdx) =>\n        pullRelevantPlotProps(dataByArticleStat[articleIdx], statIndex, colorFromCycle(colors.hueColors, articleIdx), localArticlesToUse[articleIdx].shortname, localArticlesToUse[articleIdx].longname, sharedTypeOfAllArticles),\n    )\n\n    const longnameHeaderSpecs: CellSpec[] = Array.from({ length: localArticlesToUse.length }).map((_, articleIndex) => (\n        {\n            type: 'comparison-longname',\n            articleIndex,\n            articles: localArticlesToUse,\n            names,\n            transpose,\n            sharedTypeOfAllArticles,\n            highlightIndex: articleIndex,\n            draggable: true,\n            articleId: localArticlesToUse[articleIndex].shortname,\n        } satisfies CellSpec\n    ))\n\n    const statisticNameHeaderSpecsOriginal: (CellSpec & { type: 'statistic-name' })[] = Array.from({ length: dataByStatArticle.length }).map((_, statIndex) => {\n        const row = rowToDisplayForStat(statIndex)\n        return {\n            type: 'statistic-name',\n            row,\n            renderedStatname: row.renderedStatname,\n            longname: names[0],\n            currentUniverse,\n            center: transpose ? true : false,\n            transpose,\n            highlightIndex: highlightArticleIndicesByStat[statIndex],\n            sortInfo: {\n                onSort: () => {\n                    handleSort(statIndex)\n                },\n                sortDirection: sortByStatIndex === statIndex ? sortDirection : 'both',\n            },\n        } satisfies CellSpec\n    })\n\n    const { updatedNameSpecs: statisticNameHeaderSpecs, groupNames: statisticNameGroupNames } = computeNameSpecsWithGroups(statisticNameHeaderSpecsOriginal)\n\n    const rowSpecsByStat: CellSpec[][] = Array.from({ length: dataByStatArticle.length }).map((_, statIndex) => (\n        Array.from({ length: localArticlesToUse.length }).map((unused, articleIndex) => ({\n            type: 'statistic-row',\n            row: dataByArticleStat[articleIndex][statIndex],\n            longname: names[articleIndex],\n            onlyColumns,\n            blankColumns: validOrdinalsByStat[statIndex] ? [] : ['statistic_ordinal', 'statistic_percentile'],\n            simpleOrdinals: true,\n            statisticStyle: highlightArticleIndicesByStat[statIndex] === articleIndex ? { backgroundColor: mixWithBackground(colorFromCycle(colors.hueColors, articleIndex), colors.mixPct / 100, colors.background) } : {},\n            onNavigate: (x: string) => {\n                void navContext.navigate({\n                    kind: 'comparison',\n                    universe: navContext.universe,\n                    longnames: names.map((value, index) => index === articleIndex ? x : value),\n                }, { history: 'push', scroll: { kind: 'none' } })\n            },\n        }))\n    ))\n\n    const rowSpecsByStatTransposed = rowSpecsByStat.length === 0 ? [] : rowSpecsByStat[0].map((_, statIndex) => rowSpecsByStat.map(rowSpecs => rowSpecs[statIndex]))\n\n    const plotSpecs: ({ statDescription: string, plotProps: PlotProps[] } | undefined)[] = Array.from({ length: dataByStatArticle.length }).map((_, statIndex) =>\n        expandedByStatIndex[statIndex]\n            ? {\n                    statDescription: dataByStatArticle[statIndex][0].renderedStatname,\n                    plotProps: plotProps(statIndex),\n                }\n            : undefined,\n    )\n\n    const topLeftSpec: CellSpec = { type: 'comparison-top-left-header', statNameOverride: transpose ? 'Region' : undefined }\n\n    const csvData = generateCSVDataForArticles(localArticlesToUse, dataByArticleStat, includeOrdinals)\n    const csvFilename = `${sanitize(joinedString)}.csv`\n    const csvExportData: CSVExportData = { csvData, csvFilename }\n\n    return (\n        <TransposeContext.Provider value={transpose}>\n            <QuerySettingsConnection />\n            <PageTemplate\n                screencap={universe => createScreenshot(screencapElements(), universe, colors)}\n                csvExportData={csvExportData}\n                hasUniverseSelector={true}\n                universes={props.universes}\n            >\n                <DndContext\n                    sensors={sensors}\n                    onDragStart={handleDragStart}\n                    onDragEnd={handleDragEnd}\n                    collisionDetection={closestCenter}\n                >\n                    <SortableContext items={localArticlesToUse.map(a => a.shortname)} strategy={transpose ? verticalListSortingStrategy : horizontalListSortingStrategy}>\n                        <div>\n                            <div className={headerTextClass}>Comparison</div>\n                            <div className={subHeaderTextClass}>{joinedString}</div>\n                            <div style={{ marginBlockEnd: '16px' }}></div>\n\n                            <div style={{ display: 'flex' }}>\n                                <div style={{ width: `${100 * leftMarginPercent}%` }} />\n                                <div style={{ width: `${50 * (1 - leftMarginPercent)}%`, marginRight: '1em' }}>\n                                    <div className=\"serif\" style={comparisonRightStyle}>Add another region:</div>\n                                </div>\n                                <div style={{ width: `${50 * (1 - leftMarginPercent)}%` }}>\n                                    <SearchBox\n                                        style={{ ...searchComparisonStyle, width: '100%' }}\n                                        placeholder=\"Name\"\n                                        link={x =>\n                                            navContext.link({\n                                                kind: 'comparison',\n                                                universe: currentUniverse,\n                                                longnames: [...names, x],\n                                            }, { scroll: { kind: 'none' } })}\n                                        autoFocus={false}\n                                        prioritizeArticleType={sharedTypeOfAllArticles}\n                                    />\n                                </div>\n                            </div>\n\n                            <div style={{ marginBlockEnd: '1em' }}></div>\n\n                            {maybeScroll(\n                                <div ref={tableRef}>\n                                    {transpose\n                                        ? (\n                                                <TableContents\n                                                    superHeaderSpec={{ headerSpecs: statisticNameHeaderSpecs, showBottomBar: false, groupNames: statisticNameGroupNames }}\n                                                    leftHeaderSpec={{ leftHeaderSpecs: longnameHeaderSpecs }}\n                                                    rowSpecs={rowSpecsByStatTransposed}\n                                                    horizontalPlotSpecs={plotSpecs.map(() => undefined)}\n                                                    verticalPlotSpecs={plotSpecs}\n                                                    topLeftSpec={topLeftSpec}\n                                                    widthLeftHeader={leftMarginPercent * 100}\n                                                    columnWidth={columnWidth}\n                                                    onlyColumns={onlyColumns}\n                                                    simpleOrdinals={true}\n                                                />\n                                            )\n                                        : (\n                                                <TableContents\n                                                    superHeaderSpec={{ headerSpecs: longnameHeaderSpecs, showBottomBar: true }}\n                                                    leftHeaderSpec={{ leftHeaderSpecs: statisticNameHeaderSpecs, groupNames: statisticNameGroupNames }}\n                                                    rowSpecs={rowSpecsByStat}\n                                                    horizontalPlotSpecs={plotSpecs}\n                                                    verticalPlotSpecs={[]}\n                                                    topLeftSpec={topLeftSpec}\n                                                    widthLeftHeader={leftMarginPercent * 100}\n                                                    columnWidth={columnWidth}\n                                                    onlyColumns={onlyColumns}\n                                                    simpleOrdinals={true}\n                                                />\n                                            )}\n                                    <ArticleWarnings />\n                                </div>,\n                            )}\n                            <div className=\"gap\"></div>\n\n                            <div ref={mapRef}>\n                                <ComparisonMultiMap\n                                    longnames={localArticlesToUse.map(x => x.longname)}\n                                    colors={localArticlesToUse.map((_, i) => colorFromCycle(colors.hueColors, i))}\n                                    mapPartitions={props.mapPartitions}\n                                />\n                            </div>\n                        </div>\n                    </SortableContext>\n                    <DragOverlay>\n                        {activeId\n                            ? (\n                                    <div style={{ opacity: 0.5, backgroundColor: colors.background, padding: '8px', borderRadius: '4px' }}>\n                                        {localArticlesToUse.find(a => a.shortname === activeId)?.longname}\n                                    </div>\n                                )\n                            : null}\n                    </DragOverlay>\n                </DndContext>\n            </PageTemplate>\n        </TransposeContext.Provider>\n    )\n}\n\nexport function pullRelevantPlotProps(rows: ArticleRow[], statIndex: number, color: string, shortname: string, longname: string, sharedTypeOfAllArticles: string | undefined): PlotProps[] {\n    if (rows[statIndex].extraStat === undefined) {\n        return []\n    }\n    const sPs = rows.map(row => statParents.get(row.statpath)!).map((sP, i) => ({ sP, i }))\n    const byYear = new Map<Year, number[]>()\n    sPs.filter((\n        { sP, i }) => sP.group.id === sPs[statIndex].sP.group.id && rows[i].extraStat !== undefined,\n    ).forEach(({ sP: { year }, i }) => {\n        assert(year !== null, 'Year should not be null for plot data')\n        byYear.set(year, [...(byYear.get(year) ?? []), i])\n    })\n    const bestSourceEach = Array.from(byYear.entries()).map(([, indices]) => {\n        if (indices.length === 1) {\n            return indices[0]\n        }\n        const sources = indices.map(i => sPs[i].sP.source)\n        const exactMatch = sources.findIndex(source => JSON.stringify(source) === JSON.stringify(sPs[statIndex].sP.source))\n        if (exactMatch !== -1) {\n            return indices[exactMatch]\n        }\n        const nullMatch = sources.findIndex(source => source === null)\n        if (nullMatch !== -1) {\n            return indices[nullMatch]\n        }\n        return indices[0]\n    })\n    const statpaths = bestSourceEach.map(i => sPs[i])\n    const overOne = statpaths.length > 1\n    if (overOne) {\n        statpaths.forEach(({ sP: { year } }) => {\n            assert(year !== null, 'Year should not be null for plot data')\n        })\n        assert(statpaths.length === new Set(statpaths.map(({ sP: { year } }) => year)).size, 'All statpaths for plot data should have unique years')\n    }\n    return statpaths.map(({ i: idx, sP: { year } }) => {\n        assert(year !== null, 'unreachable, we checked this already')\n        return {\n            ...rows[idx],\n            color,\n            shortname,\n            longname,\n            sharedTypeOfAllArticles,\n            subseriesName: year.toString(),\n        } satisfies PlotProps\n    })\n}\n\nfunction getHighlightIndex(rows: ArticleRow[]): number | undefined {\n    return rows.map(x => x.statval).reduce<number | undefined>((iMax, x, i, arr) => {\n        if (isNaN(x)) {\n            return iMax\n        }\n        if (iMax === undefined) {\n            return i\n        }\n        return x > arr[iMax] ? i : iMax\n    }, undefined)\n}\n\nfunction ComparisonMultiMap(props: { longnames: string[], colors: string[], mapPartitions: number[][] }): ReactNode {\n    /*\n     If mobile, make 2 columns, if one at the end, use full width\n\n     If desktop, make 3 columns, if 4 at the end, make 4, if 2 at the end, make 2 (there will never be 1 at the end because that's 4)\n     */\n    const isMobile = useMobileLayout()\n    const rows: [number, number[]][][] = useMemo(() => {\n        const slice = (from: number, to: number): [number, number[]][] => {\n            return props.mapPartitions.slice(from, to).map((partition, sliceIndex) => [from + sliceIndex, partition])\n        }\n\n        if (isMobile) {\n            const result: [number, number[]][][] = []\n            for (let i = 0; i < props.mapPartitions.length; i += 2) {\n                result.push(slice(i, i + 2))\n            }\n            return result\n        }\n        else {\n            const result: [number, number[]][][] = []\n            for (let i = 0; i < props.mapPartitions.length; i += 3) {\n                if (props.mapPartitions.length - i === 4) {\n                    result.push(\n                        slice(i, i + 2),\n                        slice(i + 2, i + 4),\n                    )\n                    i += 1\n                }\n                else {\n                    result.push(slice(i, i + 3))\n                }\n            }\n            return result\n        }\n    }, [isMobile, props.mapPartitions])\n\n    return rows.map((row, rowIndex) => (\n        <div key={rowIndex} style={{ display: 'flex', width: '100%' }}>\n            {row.map(([partitionIndex, partition]) => {\n                return (\n                    <div key={partitionIndex} style={{ position: 'relative', width: `${100 / row.length}%` }}>\n                        <ComparisonMap\n                            longnames={partition.map(index => props.longnames[index])}\n                            colors={partition.map(index => props.colors[index])}\n                            attribution={\n                                partitionIndex === props.mapPartitions.length - 1\n                            }\n                        />\n                    </div>\n                )\n            })}\n        </div>\n    ))\n}\n\nfunction ComparisonMap({ longnames, colors, attribution }: { longnames: string[], colors: string[], attribution: boolean }): ReactNode {\n    const [mapRef, setMapRef] = useState<MapRef | null>(null)\n\n    const features = useMemo(() => polygonFeatureCollection(longnames.map((longname, i) => ({\n        name: longname,\n        color: colors[i], fillColor: colors[i], fillOpacity: 0.5, weight: 1,\n    }))), [longnames, colors]).use()\n\n    const readyFeatures = useMemo(() => features.filter(notWaiting), [features])\n    const id = useId()\n\n    useZoomAllFeatures(mapRef, features, readyFeatures)\n\n    return (\n        <div style={{ position: 'relative' }}>\n            <CommonMaplibreMap\n                id={id}\n                ref={setMapRef}\n                attributionControl={false}\n            >\n                <PolygonFeatureCollection features={readyFeatures} clickable={true} />\n                <FullscreenControl position=\"top-left\" />\n                { attribution && <CustomAttributionControlComponent startShowingAttribution={true} />}\n            </CommonMaplibreMap>\n            <ComparisonMapButtons longnames={longnames} colors={colors} features={features} mapRef={mapRef} />\n        </div>\n    )\n}\n\nexport function ComparisonMapButtons({ longnames, colors, features, mapRef }: { longnames: string[], colors: string[], features: (GeoJSON.Feature | typeof waiting)[], mapRef: MapRef | null }): ReactNode {\n    const systemColors = useColors()\n    const isScreenshot = useScreenshotMode()\n\n    if (isScreenshot) {\n        return null\n    }\n\n    const click = (i: number): void => {\n        if (features[i] !== waiting) {\n            mapRef?.fitBounds(boundingBox(features[i].geometry), { animate: true, padding: defaultMapPadding })\n        }\n    }\n\n    const zoomToAll = (): void => {\n        mapRef?.fitBounds(extendBoxes(features.filter(notWaiting).map(f => boundingBox(f.geometry))), { animate: true, padding: defaultMapPadding })\n    }\n\n    return (\n        <div style={\n            { zIndex: zIndex.comparisonMapButton, position: 'absolute', right: 0, top: 0, padding: '12px' }\n        }\n        >\n            <div style={{\n                display: 'flex', backgroundColor: systemColors.background, padding: '6px', borderRadius: '6px',\n                alignItems: 'center',\n            }}\n            >\n                <span className=\"serif\" style={{ fontSize: '15px', fontWeight: 500 }}>Zoom to:</span>\n                <div style={{ width: '3px' }} />\n                <ZoomButton color={systemColors.textMain} onClick={zoomToAll} />\n                {longnames.map((longname, i) => <ZoomButton key={i} color={colors[i]} onClick={() => { click(i) }} />)}\n            </div>\n        </div>\n    )\n}\n\nfunction ZoomButton({ color, onClick }: { color: string, onClick: () => void }): ReactNode {\n    return (\n        <div\n            style={{\n                display: 'inline-block', width: '24px', height: '24px',\n                backgroundColor: color, borderRadius: '50%', marginLeft: '5px', marginRight: '5px',\n                cursor: 'pointer',\n            }}\n            onClick={onClick}\n        />\n    )\n}\n","import { ArticleRow } from './components/load-article'\n\nexport function compareArticleRows(a: ArticleRow, b: ArticleRow, direction: 'up' | 'down'): number {\n    if (!isNaN(a.statval) && !isNaN(b.statval)) {\n        return direction === 'up' ? a.statval - b.statval : b.statval - a.statval\n    }\n    // always put NaN values at the end\n    if (isNaN(a.statval)) {\n        return 1\n    }\n    if (isNaN(b.statval)) {\n        return -1\n    }\n    return direction === 'up' ? a.renderedStatname.localeCompare(b.renderedStatname) : b.renderedStatname.localeCompare(a.renderedStatname)\n}\n","import { useEffect, useState } from 'react'\n\nexport class Property<T> {\n    private _value: T\n    readonly observers = new Set<() => void>()\n\n    readonly id = Math.random().toString(36).substring(2)\n\n    constructor(value: T) {\n        this._value = value\n    }\n\n    get value(): T {\n        return this._value\n    }\n\n    set value(newValue: T) {\n        this._value = newValue\n        this.observers.forEach((observer) => { observer() })\n    }\n\n    /* eslint-disable react-hooks/rules-of-hooks -- Custom hook method */\n    use(): T {\n        const [, setCounter] = useState(0)\n        useEffect(() => {\n            const observer = (): void => {\n                setCounter(counter => counter + 1)\n            }\n            this.observers.add(observer)\n            return () => {\n                this.observers.delete(observer)\n            }\n        // eslint-disable-next-line react-hooks/exhaustive-deps -- Needs this as the property can change around the effect\n        }, [this])\n        return this.value\n    }\n    /* eslint-enable react-hooks/rules-of-hooks */\n}\n"],"names":["ArticleWarnings","screenshotMode","useScreenshotMode","selectedGroups","useSelectedGroups","groupsMissingYearSelection","useGroupsMissingYearSelection","availableYears","useAvailableYears","dataSourceCheckboxes","useDataSourceCheckboxes","settings","useSettings","groupYearKeys","allUncheckedSourceGroups","category","checkboxSpecs","name","forcedOn","sourceEnabledKey","warnings","groupOrCategory","HierarchicalName","YearList","year","checkboxCategoryName","WarningBox","param","colors","useColors","warning","key","years","ArticleMap","props","articleType","related","longname","relatedCheckboxSettings","_useState","mapRef","setMapRef","features","useArticleFeatures","relatedSettingsKeys","useMemo","getRelated","x","relateds","relatedShapes","result","i","isAllowedToBeShown","relationshipKey","color","randomColor","polygonFeatureCollection","readyFeatures","notWaiting","useZoomFirstFeature","firstFeatureWaiting","waiting","RelativeLoader","CommonMaplibreMap","PolygonFeatureCollection","FullscreenControl","ExternalLinks","elementsEach","metadata","meta","foundMetadata","m","undefined","ExternalLink","sv","assert","computeLinkSuffix","normalizer","imageURLFor","site","useRelatedColor","rowType","colorIntensity","typeCategory","type_to_type_category","colorsEach","Object","relatedButtonColors","typ","mixWithBackground","RelatedButton","currentUniverse","useUniverse","navContext","useContext","Navigator","useMobileLayout","Label","RelationshipGroup","backgroundColor","txt","row","Row","settingKey","checkId","useId","universe","CheckboxSetting","displayType","Array","relationshipType","regions","Related","showSettings","buttons","DefaultMap","_iteratorError","_iteratorError1","button","buttonKeys","a","b","type_ordering_idx","buttonKey","elements","ArticlePanel","article","rows","headersRef","useRef","tableRef","headerTextClass","useHeaderTextClass","subHeaderTextClass","useSubHeaderTextClass","comparisonHeadStyle","useComparisonHeadStyle","filteredRows","csvData","generateCSVDataForArticles","csvFilename","sanitize","QuerySettingsConnection","PageTemplate","createScreenshot","ArticleTable","ComparisonSearchBox","computeNameSpecsWithGroups","nameSpecs","updatedNameSpecs","groupNames","spec","_getGroupAndDisplayNames","nameSpec","_statParent_source","_statParent_indentedName","statParent","statParents","groupRows","s","_statParents_get","groupSize","groupHasMultipleSources","groupSourcesSet","Set","source","sourceName","displayName","groupName","simpleOrdinals","isMobile","widthLeftHeader","expandedSettings","rowExpandedKey","expandedEach","_useSetting","_useWidths","nonPointerColumns","columnWidth","_computeNameSpecsWithGroups","leftHeaderSpecs","onlyColumns","cellSpecs","newArticle","plotSpecs","expanded","index","pullRelevantPlotProps","TableContents","StatisticHeader","type","SearchBox","ComparisonPanel","contents","_localArticlesToUse_find","localArticlesToUse","activeId","setActiveId","_useState1","localArticles","setLocalArticles","_useState2","sortByStatIndex","setSortByStatIndex","_useState3","sortDirection","setSortDirection","sensors","useSensors","useSensor","PointerSensor","TouchSensor","joinedString","names","dataByArticleStat","dataByStatArticle","_","statIndex","articleData","handleSort","newSortDirection","newArticles","sortedIndices","statData","direction","isNaN","item","mobileLayout","validOrdinalsByStat","value","includeOrdinals","maxColumns","statpath","expandedByStatIndex","_expandedSettings_rowExpandedKey","numExpandedExtras","v","widthColumns","widthTransposeColumns","transpose","leftMarginPercent","numColumns","highlightArticleIndicesByStat","articlesStatData","iMax","arr","comparisonRightStyle","searchComparisonStyle","sharedTypeOfAllArticles","rowToDisplayForStat","_dataByStatArticle_statIndex_find","longnameHeaderSpecs","articleIndex","statisticNameHeaderSpecsOriginal","statisticNameHeaderSpecs","statisticNameGroupNames","rowSpecsByStat","unused","colorFromCycle","rowSpecsByStatTransposed","rowSpecs","articleIdx","topLeftSpec","TransposeContext","DndContext","event","active","over","oldIndex","newIndex","arrayMove","newLongnames","closestCenter","SortableContext","verticalListSortingStrategy","horizontalListSortingStrategy","ComparisonMultiMap","DragOverlay","shortname","sPs","sP","byYear","Map","_byYear_get","statpaths","bestSourceEach","indices","sources","exactMatch","JSON","nullMatch","idx","slice","from","to","partition","sliceIndex","result1","i1","rowIndex","partitionIndex","ComparisonMap","longnames","attribution","id","useZoomAllFeatures","CustomAttributionControlComponent","ComparisonMapButtons","systemColors","click","boundingBox","defaultMapPadding","zIndex","ZoomButton","extendBoxes","f","onClick","Property","Math","newValue","observer","use","setCounter","useEffect","counter","t"],"mappings":"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"}