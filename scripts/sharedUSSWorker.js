(()=>{"use strict";var e={24342:function(e,t,n){n.d(t,{Z:()=>r});let r={blue:"#5a7dc3",orange:"#f7aa41",brown:"#af6707",purple:"#975ac3",red:"#f96d6d",grey:"#8e8e8e",darkGrey:"#4e525a",pink:"#c767b0",yellow:"#b8a32f",green:"#8ac35a",cyan:"#07a5af"}},37014:function(e,t,n){n.d(t,{J:()=>a});var r=n(24342).Z,a={"Light Mode":{background:"#fff8f0",cleanBackground:"#ffffff",slightlyDifferentBackground:"#f7f1e8",cleanSlightlyDifferentBackground:"#faf7f2",slightlyDifferentBackgroundFocused:"#ffe0e0",highlight:"#d4b5e2",textMain:"#000000",textMainOpposite:"#ffffff",textPointer:"#222222",borderShadow:"#333333",borderNonShadow:"#cccccc",ordinalTextColor:"#444444",unselectedButton:"#e6e9ef",selectedButton:"#4e525a",selectedButtonText:"#ffffff",blueLink:"#22f",mapInsetBorderColor:"#000000",buttonTextWhite:"#ffffff",bannerURL:"/banner.png",mixPct:70,hueColors:r,screenshotFooterUrl:"screenshot_footer.svg",pencilIcon:"/pencil-light.png",wikidataURL:"/wikidata-light.svg",mapperBannerURL:"/mapper-banner.png"},"Dark Mode":{background:"#00060f",cleanBackground:"#000000",slightlyDifferentBackground:"#080e17",cleanSlightlyDifferentBackground:"#080e17",slightlyDifferentBackgroundFocused:"#3d2900",highlight:"#3b1d49",textMain:"#dddddd",textMainOpposite:"#000000",textPointer:"#dddddd",borderShadow:"#cccccc",borderNonShadow:"#333333",ordinalTextColor:"#bbbbbb",unselectedButton:"#303030",selectedButton:"#a2a6ae",selectedButtonText:"#000000",blueLink:"#aaaaff",mapInsetBorderColor:"#000000",buttonTextWhite:"#ffffff",bannerURL:"/banner-dark.png",mixPct:50,hueColors:r,screenshotFooterUrl:"screenshot_footer_dark.svg",pencilIcon:"/pencil-dark.png",wikidataURL:"/wikidata-dark.svg",mapperBannerURL:"/mapper-banner-dark.png"}}},34672:function(e,t,n){n.d(t,{LU:()=>o,_x:()=>function e(t){switch(t.type){case"assignment":return i(t.value);case"statements":return e(t.result[t.result.length-1]);case"parseError":return a()(t.errors.length>0,"parseError node must have at least one error"),t.errors[0].location;default:return i(t)}},x9:()=>i});var r=n(39343),a=n.n(r);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a()(t.length>0,"At least one location must be provided for unification");var r=t.reduce(function(e,t){return Math.min(e,t.start.lineIdx)},Number.MAX_VALUE),o=t.reduce(function(e,t){return Math.max(e,t.end.lineIdx)},-Number.MAX_VALUE),i=t.reduce(function(e,t){return Math.min(e,t.start.colIdx)},Number.MAX_VALUE),c=t.reduce(function(e,t){return Math.max(e,t.end.colIdx)},-Number.MAX_VALUE),u=t.reduce(function(e,t){return Math.min(e,t.start.charIdx)},Number.MAX_VALUE),l=t.reduce(function(e,t){return Math.max(e,t.end.charIdx)},-Number.MAX_VALUE);return{start:{block:t[0].start.block,lineIdx:r,colIdx:i,charIdx:u},end:{block:t[0].end.block,lineIdx:o,colIdx:c,charIdx:l}}}function i(e){switch(e.type){case"unnamed":case"expression":return i(e.value);case"named":return o(e.name.location,i(e.value));case"constant":return e.value.location;case"identifier":return e.name.location;case"attribute":return o(e.name.location,i(e.expr));case"call":case"objectLiteral":case"vectorLiteral":case"if":case"do":case"condition":case"statements":case"customNode":return e.entireLoc;case"unaryOperator":return o(e.operator.location,i(e.expr));case"binaryOperator":return o(i(e.left),i(e.right),e.operator.location);case"assignment":return o(i(e.lhs),i(e.value));case"parseError":return a()(e.errors.length>0,"parseError node must have at least one error"),e.errors[0].location}}},24714:function(e,t,n){n.d(t,{B8:()=>d,IB:()=>y,JM:()=>p,Q_:()=>h,mC:()=>f});var r,a=n(24342),o=n(88452),i=n(89080),c=n(54509),u=n(78415);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}var p={type:"opaque",name:"color"},d={type:{type:"function",posArgs:[{type:"concrete",value:{type:"number"}},{type:"concrete",value:{type:"number"}},{type:"concrete",value:{type:"number"}}],namedArgs:{a:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,i._N)(1)}},returnType:{type:"concrete",value:p}},value:function(e,t,n){var r=n.a;return{type:"opaque",opaqueType:"color",value:function(e,t,n,r,a){if(e<0||e>1||t<0||t>1||n<0||n>1||r<0||r>1)throw Error("RGB values must be between 0 and 1, got (".concat(e,", ").concat(t,", ").concat(n,", ").concat(r,")"));return{r:e,g:t,b:n,a:r}}(t[0],t[1],t[2],r)}},documentation:{humanReadableName:"Color (RGB)",category:"color",namedArgs:{a:"Alpha"},longDescription:"Creates a color using RGB (Red, Green, Blue) values. Each component ranges from 0 to 1, where 0 is no color and 1 is full intensity."}},f={type:{type:"function",posArgs:[{type:"concrete",value:{type:"number"}},{type:"concrete",value:{type:"number"}},{type:"concrete",value:{type:"number"}}],namedArgs:{a:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,i._N)(1)}},returnType:{type:"concrete",value:p}},value:function(e,t,n){var r=n.a;return{type:"opaque",opaqueType:"color",value:function(e,t,n,r,a){if(e<0||e>360||t<0||t>1||n<0||n>1||r<0||r>1)throw Error("HSV values must be (hue: 0-360, saturation: 0-1, value: 0-1, alpha: 0-1), got (".concat(e,", ").concat(t,", ").concat(n,", ").concat(r,")"));return{h:e,s:t,v:n,a:r}}(t[0],t[1],t[2],r)}},documentation:{humanReadableName:"Color (HSV)",category:"color",longDescription:"Creates a color using HSV (Hue, Saturation, Value) values. Hue ranges from 0 to 360 degrees, saturation and value range from 0 to 1."}},y={type:{type:"function",posArgs:[{type:"concrete",value:p}],namedArgs:{},returnType:{type:"concrete",value:{type:"string"}}},value:function(e,t,n){var r=t[0].value;return(0,c.XF)(r)},documentation:{humanReadableName:"Color to String",category:"color",longDescription:'Converts a color object to its hexadecimal string representation (e.g., "#ff0000" for red). If the alpha channel is not 255, it will be included in the string, e.g., "#ff000088" for red with 50% opacity.'}};function m(e,t,n){var r=(0,u.g)(e),a=e.charAt(0).toUpperCase()+e.slice(1),i=(0,c.uG)(t,3);return["color".concat(a),{type:p,value:{type:"opaque",opaqueType:"color",value:i},documentation:{humanReadableName:r,category:"color",equivalentExpressions:[(0,o.hc)((0,c.io)(i,{round:3}),""),(0,o.hc)((0,c.v1)(i,{round:3}),"")],isDefault:n,longDescription:"Predefined color constant representing ".concat(r.toLowerCase(),"."),documentationTable:"predefined-colors",selectorRendering:{kind:"gradientBackground",ramp:[[0,t],[1,t]]}}}]}var h=((function(e){if(Array.isArray(e))return l(e)})(r=Object.entries(a.Z).map(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,2)||s(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return m(t[0],t[1])}))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||s(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([m("white","#ffffff"),m("black","#000000",!0)])},44640:function(e,t,n){n.d(t,{Et:()=>f,F6:()=>v,HC:()=>h,HE:()=>y,Yw:()=>p,xf:()=>d});var r=n(2194),a=n(51859),o=n(88452);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||l(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}var s={type:"opaque",name:"inset"},p={type:"opaque",name:"insets"},d={type:"object",properties:new Map([["west",{type:"number"}],["east",{type:"number"}],["north",{type:"number"}],["south",{type:"number"}]])},f={type:{type:"function",posArgs:[],namedArgs:{screenBounds:{type:{type:"concrete",value:d}},mapBounds:{type:{type:"concrete",value:d}},mainMap:{type:{type:"concrete",value:{type:"boolean"}}},name:{type:{type:"concrete",value:{type:"string"}}}},returnType:{type:"concrete",value:s}},value:function(e,t,n){var r,a,o=n.screenBounds,i=n.mapBounds,c=n.mainMap,u=n.name;return r={west:o.get("west"),east:o.get("east"),north:o.get("north"),south:o.get("south")},a={west:i.get("west"),east:i.get("east"),north:i.get("north"),south:i.get("south")},{type:"opaque",opaqueType:"inset",value:{bottomLeft:[r.west,r.south],topRight:[r.east,r.north],coordBox:[a.west,a.south,a.east,a.north],mainMap:c,name:u}}},documentation:{humanReadableName:"Custom Inset",category:"inset",longDescription:"Creates a custom map inset with specified screen bounds (bounding box of the inset on the screen, where bottom left corner has (0, 0) and top right corner has (1, 1)), map bounds (bounding box of the inset on the map, in longitude and latitude), and whether it is the main map (the interactive map).",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}},y={type:{type:"function",posArgs:[{type:"concrete",value:{type:"vector",elementType:s}}],namedArgs:{},returnType:{type:"concrete",value:p}},value:function(e,t,n){return{type:"opaque",opaqueType:"insets",value:t[0].map(function(e){return e.value})}},documentation:{humanReadableName:"Custom Insets",category:"inset",isDefault:!0,longDescription:"Creates a collection of map insets.",customConstructor:!0}};function m(e){return e=(e=e.replace(/[\s,().-]/g,"")).replaceAll("+","Plus"),e="inset".concat(e)}var h=Object.entries(a.Z).flatMap(function(e){return c(e,2)[1].map(function(e){var t,n=e.name;return[m(n),{type:s,value:{type:"opaque",opaqueType:"inset",value:{bottomLeft:u(e.bottomLeft),topRight:u(e.topRight),coordBox:u(e.coordBox),mainMap:e.mainMap,name:e.name}},documentation:{humanReadableName:n,category:"inset",equivalentExpressions:[(t="constructInset(screenBounds={ north: ".concat((0,r.NMM)(e.topRight[1],3),", east: ").concat((0,r.NMM)(e.topRight[0],3),", south: ").concat((0,r.NMM)(e.bottomLeft[1],3),", west: ").concat((0,r.NMM)(e.bottomLeft[0],3)," }, mapBounds={ north: ").concat((0,r.NMM)(e.coordBox[3],3),", east: ").concat((0,r.NMM)(e.coordBox[2],3),", south: ").concat((0,r.NMM)(e.coordBox[1],3),", west: ").concat((0,r.NMM)(e.coordBox[0],3)," }, mainMap=").concat(e.mainMap,', name="').concat(e.name,'")'),(0,o.hc)(t,""))],longDescription:'Predefined map inset for the region "'.concat(n,'".'),documentationTable:"predefined-insets"}}]})}),v=new Map(Object.entries(a.Z).flatMap(function(e){return c(e,2)[1].map(function(e){var t=e.name;return[t,m(t)]})}))},96766:function(e,t,n){n.d(t,{CX:()=>w,dI:()=>h});var r=n(88609),a=n(89080),o=n(24714),i=n(54509),c=n(20110);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){l(e,t,n[t])})}return e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||f(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}var y=r.z.string().transform(function(e){try{return(0,i.uG)(e)}catch(t){c.warn("".concat(e," is not a valid color"));return}}),m=r.z.object({size:r.z.optional(r.z.string().transform(function(e){if(!e.endsWith("px"))return void c.warn("Font size ".concat(e,' does not end with "px"'));var t=e.slice(0,e.length-2),n=parseFloat(t);return isFinite(n)?n:void c.warn("Font pixels ".concat(t," is not a valid number"))})),font:r.z.optional(r.z.string()),color:r.z.optional(r.z.union([y,r.z.array(y).transform(function(e){return 0===e.length?void 0:e[0]})])),bold:r.z.optional(r.z.boolean()),italic:r.z.optional(r.z.boolean()),underline:r.z.optional(r.z.boolean()),strike:r.z.optional(r.z.boolean()),list:r.z.optional(r.z.union([r.z.literal("ordered"),r.z.literal("bullet"),r.z.literal("")])),indent:r.z.optional(r.z.number()),align:r.z.optional(r.z.enum(["","center","right","justify"]))});r.z.object({insert:r.z.union([r.z.string(),r.z.object({formula:r.z.string()}),r.z.object({image:r.z.string().refine(function(e){return!e.startsWith("data:")})})]),attributes:r.z.optional(m)});var h={type:"opaque",name:"richTextDocument"},v={type:"opaque",name:"richTextSegment"},g={type:"opaque",name:"richTextList"},_={type:"opaque",name:"richTextAlign"};function b(e){var t,n,r,a,o,i,c,u,l,s,d=null==(t=e.color)?void 0:t.value,f=Object.entries({size:null!=(a=e.size)?a:void 0,font:null!=(o=e.font)?o:void 0,color:d,bold:null!=(i=e.bold)?i:void 0,italic:null!=(c=e.italic)?c:void 0,underline:null!=(u=e.underline)?u:void 0,list:null==(n=e.list)?void 0:n.value,indent:null!=(l=e.indent)?l:void 0,align:null==(r=e.align)?void 0:r.value,strike:null!=(s=e.strike)?s:void 0}).filter(function(e){return void 0!==p(e,2)[1]});if(0!==f.length)return Object.fromEntries(f)}var x={type:"function",posArgs:[{type:"concrete",value:{type:"string"}}],namedArgs:{size:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,a._N)(null)},font:{type:{type:"concrete",value:{type:"string"}},defaultValue:(0,a._N)(null)},color:{type:{type:"concrete",value:o.JM},defaultValue:(0,a._N)(null)},bold:{type:{type:"concrete",value:{type:"boolean"}},defaultValue:(0,a._N)(null)},italic:{type:{type:"concrete",value:{type:"boolean"}},defaultValue:(0,a._N)(null)},underline:{type:{type:"concrete",value:{type:"boolean"}},defaultValue:(0,a._N)(null)},strike:{type:{type:"concrete",value:{type:"boolean"}},defaultValue:(0,a._N)(null)},list:{type:{type:"concrete",value:g},defaultValue:(0,a._N)(null)},indent:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,a._N)(null)},align:{type:{type:"concrete",value:_},defaultValue:(0,a._N)(null)}},returnType:{type:"concrete",value:v}};l({ordered:"listOrdered",bullet:"listBullet"},"","listNone");var w=[["rtfDocument",{type:{type:"function",posArgs:[{type:"concrete",value:{type:"vector",elementType:v}}],namedArgs:{},returnType:{type:"concrete",value:h}},value:function(e,t,n){var r=t[0].map(function(e){return e.value});return 0===r.length&&(r=[{insert:"\n"}]),{type:"opaque",opaqueType:"richTextDocument",value:r}},documentation:{humanReadableName:"Rich Text Document",category:"richText",longDescription:"Creates a rich text document from a list of rich text segments.",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}}],["rtfString",{type:x,value:function(e,t,n){var r=t[0],a=b(n);return{type:"opaque",opaqueType:"richTextSegment",value:s({insert:r},a&&{attributes:a})}},documentation:{humanReadableName:"Rich Text String Segment",category:"richText",longDescription:"Creates a rich text segment containing a plain string. The string can have optional formatting attributes.",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}}],["rtfFormula",{type:x,value:function(e,t,n){var r=t[0],a=b(n);return{type:"opaque",opaqueType:"richTextSegment",value:s({insert:{formula:r}},a&&{attributes:a})}},documentation:{humanReadableName:"Rich Text Formula Segment",category:"richText",longDescription:"Creates a rich text segment containing a formula. The formula is represented as a string and can have optional formatting attributes.",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}}],["rtfImage",{type:x,value:function(e,t,n){var r=t[0],a=b(n);return{type:"opaque",opaqueType:"richTextSegment",value:s({insert:{image:r}},a&&{attributes:a})}},documentation:{humanReadableName:"Rich Text Image Segment",category:"richText",longDescription:"Creates a rich text segment containing an image. The image is represented as a URL string and can have optional formatting attributes.",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}}]].concat(d(Object.entries({alignLeft:"",alignCenter:"center",alignRight:"right",alignJustify:"justify"}).map(function(e){var t,n=p(e,2);return[n[0],{type:_,value:{type:"opaque",opaqueType:"richTextAlign",value:t=n[1]},documentation:{humanReadableName:"Align ".concat(""===t?"Left":t.charAt(0).toUpperCase()+t.slice(1)),category:"richText",longDescription:"Specifies the alignment of the text as ".concat(""===t?"left":t,"."),selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!1}}]})),d(Object.entries({listOrdered:"ordered",listBullet:"bullet",listNone:""}).map(function(e){var t,n=p(e,2);return[n[0],{type:g,value:{type:"opaque",opaqueType:"richTextList",value:t=n[1]},documentation:{humanReadableName:"List ".concat(t&&t.charAt(0).toUpperCase()+t.slice(1)||"None"),category:"richText",longDescription:"Specifies the list type as ".concat(t||"none","."),selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!1}}]})))},69851:function(e,t,n){n.d(t,{d3:()=>l,iu:()=>u});var r=n(89080);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var i={type:"opaque",name:"scale"},c=function(e,t,n,r){e=e.filter(function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)});var a,i,c=null!=t?t:(a=Math).min.apply(a,o(e)),u=null!=n?n:(i=Math).max.apply(i,o(e));if(void 0!==r)if(void 0!==t&&void 0!==n){if(Math.abs(r-(t+n)/2)>1e-10)throw Error("Inconsistent parameters: center ".concat(r," does not equal (min + max) / 2 = ").concat(t+n," / 2"))}else if(void 0!==t)u=2*r-t;else if(void 0!==n)c=2*r-n;else{var l=Math.max(u-r,r-c);c=r-l,u=r+l}return{kind:"linear",min:c,max:u}},u={type:{type:"function",posArgs:[],namedArgs:{min:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)},center:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)},max:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)}},returnType:{type:"concrete",value:i}},value:function(e,t,n){var r=n.min,a=n.max,o=n.center;return{type:"opaque",opaqueType:"scale",value:function(e){return c(e,null!=r?r:void 0,null!=a?a:void 0,null!=o?o:void 0)}}},documentation:{humanReadableName:"Linear Scale",category:"scale",isDefault:!0,longDescription:"Creates a linear scale that maps numeric values to a range. If min/max are not specified, they are computed from the data. Center parameter can be used to create symmetric ranges.",selectorRendering:{kind:"subtitleLongDescription"}}},l={type:{type:"function",posArgs:[],namedArgs:{min:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)},center:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)},max:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,r._N)(null)}},returnType:{type:"concrete",value:i}},value:function(e,t,n){var r=n.min,a=n.max,o=n.center;return{type:"opaque",opaqueType:"scale",value:function(e){var t,n,i;return t=null!=r?r:void 0,n=null!=a?a:void 0,i=null!=o?o:void 0,{kind:"log",linearScale:c(e.map(Math.log),void 0!==t?Math.log(t):void 0,void 0!==n?Math.log(n):void 0,void 0!==i?Math.log(i):void 0)}}}},documentation:{humanReadableName:"Logarithmic Scale",category:"scale",longDescription:"Creates a logarithmic scale that maps numeric values to a range using log transformation. Useful for data with wide ranges or exponential distributions. If min/max are not specified, they are computed from the data. Center parameter can be used to create symmetric ranges.",selectorRendering:{kind:"subtitleLongDescription"}}}},75211:function(e,t,n){n.d(t,{Io:()=>s,Rj:()=>p});var r=n(37014),a=n(88452),o=n(24714),i=n(54509),c=n(44640),u=n(96766),l={backgroundColor:(0,i.uG)(r.J["Light Mode"].background),borderColor:(0,i.uG)(r.J["Light Mode"].borderShadow),borderWidth:1},s={type:"opaque",name:"textBox"},p={type:{type:"function",posArgs:[],namedArgs:{screenBounds:{type:{type:"concrete",value:c.xf}},text:{type:{type:"concrete",value:u.dI}},backgroundColor:{type:{type:"concrete",value:o.JM},defaultValue:(0,a.hc)((0,i.z5)(l.backgroundColor),"")},borderColor:{type:{type:"concrete",value:o.JM},defaultValue:(0,a.hc)((0,i.z5)(l.borderColor),"")},borderWidth:{type:{type:"concrete",value:{type:"number"}},defaultValue:(0,a.hc)("".concat(l.borderWidth),"")}},returnType:{type:"concrete",value:s}},value:function(e,t,n){var r=n.screenBounds,a=n.text.value,o=n.backgroundColor.value,i=n.borderColor.value,c=n.borderWidth;return{type:"opaque",opaqueType:"textBox",value:{bottomLeft:[r.get("west"),r.get("south")],topRight:[r.get("east"),r.get("north")],text:a,backgroundColor:o,borderColor:i,borderWidth:c}}},documentation:{humanReadableName:"Map Text Box",category:"map",longDescription:"Create a text box on the map with specified screen bounds (bounding box of the inset on the screen, where bottom left corner has (0, 0) and top right corner has (1, 1))",selectorRendering:{kind:"subtitleLongDescription"},customConstructor:!0}}},5855:function(e,t,n){n.d(t,{jx:()=>v,p3:()=>y});var r=n(77053),a=n(34415);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||u(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}var l=["=",",",";",".",":"],s="!@$%^&*-+=~`<>/?:|,;.",p=["if","do","else","customNode","condition"];function d(e){return e>="0"&&e<="9"}function f(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e}function y(e){if(/^-?\d*(\.\d+)?([eE][+-]?\d+)?$/i.test(e)){var t=parseFloat(e);if(isNaN(t))return;return t}if(e.endsWith("k")){var n=y(e.slice(0,-1));if(void 0===n)return;return 1e3*n}if(e.endsWith("m")){var r=y(e.slice(0,-1));if(void 0===r)return;return 1e6*r}}var m={firstToken:f,innerToken:function(e){return f(e)||d(e)},parse:function(e){return{type:p.includes(e)?"keyword":"identifier",value:e}}},h={firstToken:function(e){return s.includes(e)},innerToken:function(e){return s.includes(e)},parse:function(e){return{type:"operator",value:e}}};function v(e,t){for(var n=[],o=t.split("\n"),u=0,s=0;s<o.length;s++){var p=o[s],f=function(e,t,n,o){var u=[];(0,r.h)(!e.includes("\n"),"Input contains new line characters");var s=0;e:for(;s<e.length;){var p,f=e[s];if(" "===f){s++;continue}if("("===f||")"===f||"{"===f||"}"===f||"["===f||"]"===f){var v={token:{type:"bracket",value:f},location:{start:{block:t,lineIdx:n,colIdx:s,charIdx:o+s},end:{block:t,lineIdx:n,colIdx:s+1,charIdx:o+s+1}}};u.push(v),s++;continue}if(d(f)){var _,b=void 0;if(s=(_=i(function(e,t,n,r,a){var o=/^\d+(\.\d+)?([eE][+-]?\d+|k|m)?/i.exec(e.slice(t));if(!o)return[t,void 0];var i=o[0],c=y(i);if(void 0===c)return[t+i.length,{token:{type:"error",value:"Invalid number format: ".concat(i)},location:{start:{block:n,lineIdx:r,colIdx:t,charIdx:a+t},end:{block:n,lineIdx:r,colIdx:t+i.length,charIdx:a+t+i.length}}}];var u={token:{type:"number",value:c},location:{start:{block:n,lineIdx:r,colIdx:t,charIdx:a+t},end:{block:n,lineIdx:r,colIdx:t+i.length,charIdx:a+t+i.length}}};return[t+i.length,u]}(e,s,t,n,o),2))[0],void 0!==(b=_[1])){u.push(b);continue}}for(var x=0,w=[m];x<w.length;x++){var S,k=w[x],A=void 0;if(s=(S=i(g(e,s,t,n,k,o),2))[0],void 0!==(A=S[1])){u.push(A);continue e}}var C,I=void 0;if(s=(C=i(function(e,t,n,o,c){var u=i(g(e,t,n,o,h,c),2),s=u[0],p=u[1];if(s===t)return[t,[]];(0,r.h)(void 0!==p,"unreachable"),(0,r.h)("operator"===p.token.type,"unreachable");var d=function(e){for(var t=function(){var e=new Set(l),t=!0,n=!1,r=void 0;try{for(var o,i=a.cP.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var c=o.value;e.add(c)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return Array.from(e).sort(function(e,t){return t.length-e.length})}(),n=[],r=0;r<e.length;){var o=!1,i=!0,c=!1,u=void 0;try{for(var s,p=t[Symbol.iterator]();!(i=(s=p.next()).done);i=!0){var d=s.value;if(e.startsWith(d,r)){n.push(d),r+=d.length,o=!0;break}}}catch(e){c=!0,u=e}finally{try{i||null==p.return||p.return()}finally{if(c)throw u}}if(!o)return}if(r===e.length)return n}(p.token.value);if(void 0===d)return[s,[{token:{type:"error",value:"Invalid operator sequence: ".concat(p.token.value)},location:p.location}]];var f=t;return[s,d.map(function(e){var t={start:{block:n,lineIdx:o,colIdx:f,charIdx:c+f},end:{block:n,lineIdx:o,colIdx:f+e.length,charIdx:c+f+e.length}};return f+=e.length,{token:{type:"operator",value:e},location:t}})]}(e,s,t,n,o),2))[0],(I=C[1]).length>0){u.push.apply(u,c(I));continue}var O=void 0;if(s=(p=i(function(e,t,n,a,o){if('"'!==e[t])return[t,void 0];var i,c=t;for(t++;;){if(t>=e.length)return[t,{token:{type:"error",value:"Unterminated string"},location:{start:{block:n,lineIdx:a,colIdx:c,charIdx:o+c},end:{block:n,lineIdx:a,colIdx:t,charIdx:o+c}}}];if('"'===e[t]){t++;break}if("\\"===e[t]){t+=2;continue}t++}try{var u=JSON.parse(e.slice(c,t));(0,r.h)("string"==typeof u,"Invalid string: ".concat(e.slice(c,t))),i=u}catch(r){return[t,{token:{type:"error",value:"Invalid string: ".concat(e.slice(c,t),": ").concat(r)},location:{start:{block:n,lineIdx:a,colIdx:c,charIdx:o+c},end:{block:n,lineIdx:a,colIdx:t,charIdx:o+t}}}]}var l={token:{type:"string",value:i},location:{start:{block:n,lineIdx:a,colIdx:c,charIdx:o+c},end:{block:n,lineIdx:a,colIdx:t,charIdx:o+t}}};return[t,l]}(e,s,t,n,o),2))[0],void 0!==(O=p[1])){u.push(O);continue}u.push({token:{type:"error",value:"Unexpected character: ".concat(f)},location:{start:{block:t,lineIdx:n,colIdx:s,charIdx:o+s},end:{block:t,lineIdx:n,colIdx:s+1,charIdx:o+s+1}}}),s++}return u}(p,e,s,u);n.push.apply(n,c(f)),u+=p.length,n.push({token:{type:"operator",value:"EOL"},location:{start:{block:e,lineIdx:s,colIdx:p.length,charIdx:u},end:{block:e,lineIdx:s,colIdx:p.length,charIdx:u}}}),u+=1}return n}function g(e,t,n,r,a,o){if(!a.firstToken(e[t]))return[t,void 0];for(var i=t;t<e.length&&a.innerToken(e[t]);)t++;var c={token:a.parse(e.slice(i,t)),location:{start:{block:n,lineIdx:r,colIdx:i,charIdx:o+i},end:{block:n,lineIdx:r,colIdx:t,charIdx:o+t}}};return[t,c]}},27193:function(e,t,n){n.d(t,{tU:()=>r});var r={start:{block:{type:"multi"},lineIdx:0,colIdx:0,charIdx:0},end:{block:{type:"multi"},lineIdx:0,colIdx:0,charIdx:0}}},88452:function(e,t,n){n.d(t,{Z2:()=>function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};function o(e){return"identifier"===e.type||"vectorLiteral"===e.type||"constant"===e.type||"customNode"===e.type}function i(e){return"    ".repeat(e)}n.inline&&(0,r.h)(null!=(b=n.expressionalContext)&&b,"expressionalContext must be true if inline is true"),n.indent=null!=(x=n.indent)?x:0,n.wrap=null==(w=n.wrap)||w;var u=80-i(n.indent).length;switch(t.type){case"customNode":if(!n.simplify)return"customNode(".concat(JSON.stringify(t.originalCode.trim()),")");if(n.expressionalContext&&"expression"!==t.expr.type)return e({type:"do",statements:[t.expr],entireLoc:(0,a.x9)(t.expr)},p(s({},n),{inline:!0}));return t.originalCode.trim();case"parseError":return t.originalCode;case"constant":if("string"===t.value.node.type)return JSON.stringify(t.value.node.value);return t.value.node.value.toString();case"identifier":return t.name.node;case"attribute":var l=e(t.expr,p(s({},n),{inline:!0,expressionalContext:!0}));return"".concat(l,".").concat(t.name.node);case"call":var f=e(t.fn,p(s({},n),{inline:!0,expressionalContext:!0})),y=t.args.map(function(t){switch(t.type){case"unnamed":return e(t.value,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!1}));case"named":return"".concat(t.name.node,"=").concat(e(t.value,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!1})))}}),m=o(t.fn)?f:"(".concat(f,")"),h="".concat(m,"(").concat(y.join(", "),")");if(h.length>u&&n.wrap){if(1===t.args.length&&"unnamed"===t.args[0].type&&"vectorLiteral"===t.args[0].value.type)return"".concat(m,"(").concat(e(t.args[0].value,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!0})),")");var v=t.args.map(function(t){switch(t.type){case"unnamed":return"".concat(i(n.indent+1)).concat(e(t.value,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!0,indent:n.indent+1})));case"named":return"".concat(i(n.indent+1)).concat(t.name.node,"=").concat(e(t.value,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!0,indent:n.indent+1})))}});return"".concat(m,"(\n").concat(v.join(",\n"),"\n").concat(i(n.indent),")")}return h;case"unaryOperator":var g=e(t.expr,p(s({},n),{inline:!0,expressionalContext:!0})),_=!o(t.expr);return"".concat(t.operator.node).concat(_?"(".concat(g,")"):g);case"binaryOperator":var b,x,w,S,k,A,C,I,O,E=e(t.left,p(s({},n),{inline:!0,expressionalContext:!0})),T=e(t.right,p(s({},n),{inline:!0,expressionalContext:!0})),j=null!=(k=null==(S=c.cP.get(t.operator.node))?void 0:S.precedence)?k:0,N=E;"binaryOperator"===t.left.type?(null!=(C=null==(A=c.cP.get(t.left.operator.node))?void 0:A.precedence)?C:0)<j&&(N="(".concat(E,")")):o(t.left)||(N="(".concat(E,")"));var M=T;return"binaryOperator"===t.right.type?(null!=(O=null==(I=c.cP.get(t.right.operator.node))?void 0:I.precedence)?O:0)<=j&&(M="(".concat(T,")")):o(t.right)||(M="(".concat(T,")")),"".concat(N," ").concat(t.operator.node," ").concat(M);case"vectorLiteral":var L=t.elements.map(function(t){return e(t,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!1}))}),U="[".concat(L.join(", "),"]");if(U.length>u&&n.wrap){var D=t.elements.map(function(t){return"".concat(i(n.indent+1)).concat(e(t,p(s({},n),{inline:!0,expressionalContext:!0,wrap:!0,indent:n.indent+1})))});return"[\n".concat(D.join(",\n"),"\n").concat(i(n.indent),"]")}return U;case"objectLiteral":var B=t.properties.map(function(t){var r=d(t,2),a=r[0],o=e(r[1],p(s({},n),{inline:!0,expressionalContext:!0,wrap:!1}));return"".concat(a,": ").concat(o)}),P="{".concat(B.join(", "),"}");if(P.length>u&&n.wrap){var R=t.properties.map(function(t){var r=d(t,2),a=r[0],o=e(r[1],p(s({},n),{inline:!0,expressionalContext:!0,wrap:!0}));return"".concat(i(n.indent+1)).concat(a,": ").concat(o)});return"{\n".concat(R.join(",\n"),"\n").concat(i(n.indent),"}")}return P;case"assignment":var V=e(t.lhs,p(s({},n),{expressionalContext:!0})),z=e(t.value,p(s({},n),{expressionalContext:!0}));return n.inline?"".concat(V," = ").concat(z):"".concat(i(n.indent)).concat(V," = ").concat(z);case"expression":return n.inline?e(t.value,n):"".concat(i(n.indent)).concat(e(t.value,n));case"statements":return t.result.map(function(t){return e(t,n)}).filter(function(e){return""!==e&&"do {  }"!==e}).join(n.inline?"; ":";\n");case"if":var q=e(t.condition,p(s({},n),{expressionalContext:!0})),G=e(t.then,p(s({},n),{indent:n.indent+1})),F=n.inline?"if (".concat(q,") { ").concat(G," }"):"if (".concat(q,") {\n").concat(G,"\n").concat(i(n.indent),"}");if(t.else){var H=e(t.else,p(s({},n),{indent:n.indent+1}));F+=n.inline?" else { ".concat(H," }"):" else {\n".concat(H,"\n").concat(i(n.indent),"}")}return F;case"do":var J=e({type:"statements",result:t.statements,entireLoc:t.entireLoc},p(s({},n),{indent:n.indent+1}));return n.inline?"do { ".concat(J," }"):"do {\n".concat(J,"\n").concat(i(n.indent),"}");case"condition":var K=e(t.condition,p(s({},n),{expressionalContext:!0})),Z=e({type:"statements",result:t.rest,entireLoc:t.entireLoc},n);if(n.simplify&&"identifier"===t.condition.type&&"true"===t.condition.name.node)return Z;return"".concat(i(n.indent),"condition (").concat(K,")\n").concat(Z)}},gD:()=>g,hc:()=>_});var r=n(77053),a=n(34672),o=n(5855),i=n(27193),c=n(34415);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){l(e,t,n[t])})}return e}function p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||y(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}var m=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");l(this,"tokens",void 0),l(this,"index",void 0),this.tokens=e,this.index=0}return e=[{key:"skipEOL",value:function(){if(this.index>=this.tokens.length)return!1;var e=this.tokens[this.index];return"operator"===e.token.type&&"EOL"===e.token.value&&(this.index++,!0)}},{key:"consumeTokenOfType",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.index>=this.tokens.length)return!1;var a=this.tokens[this.index];if(a.token.type===e&&(0===n.length||n.includes(a.token.value)))return this.index++,!0;if(this.skipEOL()){if(this.consumeTokenOfType.apply(this,[e].concat(f(n))))return!0;this.index--}return!1}},{key:"consumeOperator",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.consumeTokenOfType.apply(this,["operator"].concat(f(t)))}},{key:"consumeBracket",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.consumeTokenOfType.apply(this,["bracket"].concat(f(t)))}},{key:"consumeIdentifier",value:function(){return this.consumeTokenOfType("identifier")}},{key:"consumeKeyword",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.consumeTokenOfType.apply(this,["keyword"].concat(f(t)))}},{key:"maybeLastNonEOLToken",value:function(e){for(var t=this.index+e;t>=0;t--){var n=this.tokens[t];if("operator"!==n.token.type||"EOL"!==n.token.value)return n}return this.tokens[this.index+e]}},{key:"parseSingleExpression",value:function(){for(;this.skipEOL(););if(this.index>=this.tokens.length)return{type:"error",value:"Unexpected end of input",location:this.maybeLastNonEOLToken(-1).location};var e=this.tokens[this.index];switch(e.token.type){case"number":return this.index++,{type:"constant",value:{node:{type:"number",value:e.token.value},location:e.location}};case"string":return this.index++,{type:"constant",value:{node:{type:"string",value:e.token.value},location:e.location}};case"identifier":return this.index++,{type:"identifier",name:{node:e.token.value,location:e.location}};case"keyword":return{type:"error",value:"Unexpected keyword ".concat(e.token.value),location:e.location};case"bracket":switch(e.token.value){case"(":this.index++;var t=this.parseExpression();if("error"===t.type)return t;if(!this.consumeBracket(")"))return{type:"error",value:"Expected closing bracket ) to match this one",location:e.location};return t;case"{":this.index++;for(var n=e.location,o=[];!this.consumeBracket("}");){if(o.length>0&&!this.consumeOperator(","))return{type:"error",value:"Expected comma , or closing bracket } after object field name; instead received ".concat(this.tokens[this.index].token.value),location:this.tokens[this.index].location};if(!this.consumeIdentifier())return{type:"error",value:"Expected identifier for object field name",location:this.maybeLastNonEOLToken(-1).location};var i=this.tokens[this.index-1];if((0,r.h)("identifier"===i.token.type,"Expected identifier token, but got ".concat(i.token.type)),!this.consumeOperator(":"))return{type:"error",value:"Expected : token after object field name",location:i.location};var c=this.parseExpression();if("error"===c.type)return c;o.push([i.token.value,c])}var u=this.tokens[this.index-1].location;return{type:"objectLiteral",entireLoc:(0,a.LU)(n,u),properties:o};case"[":this.index++;for(var l=e.location,s=[];!this.consumeBracket("]");){if(s.length>0&&!this.consumeOperator(","))return{type:"error",value:"Expected comma , or closing bracket ] after vector element",location:this.maybeLastNonEOLToken(0).location};var p=this.parseExpression();if("error"===p.type)return p;s.push(p)}var d=this.tokens[this.index-1].location;return{type:"vectorLiteral",entireLoc:(0,a.LU)(l,d),elements:s}}return{type:"error",value:"Unexpected bracket ".concat(e.token.value),location:e.location};case"operator":return{type:"error",value:"Unexpected operator ".concat(e.token.value),location:e.location}}}},{key:"parseArg",value:function(){var e=this.parseExpression();if("error"===e.type)return e;if(!this.consumeOperator("="))return{type:"unnamed",value:e};var t=this.parseExpression();return"error"===t.type?t:"identifier"!==e.type?{type:"error",value:"Expected identifier for named argument",location:(0,a.x9)(e)}:{type:"named",name:{node:e.name.node,location:e.name.location},value:t}}},{key:"parseParenthesizedArgs",value:function(){if(this.consumeBracket("("))for(var e=this.tokens[this.index-1].location,t=[];;){if(this.consumeBracket(")")){var n=this.tokens[this.index-1].location;return{type:"args",args:[t,(0,a.LU)(e,n)]}}if(t.length>0&&!this.consumeOperator(","))return{type:"error",value:"Expected comma , or closing bracket ); instead received ".concat(this.tokens[this.index].token.value),location:this.tokens[this.index].location};var r=this.parseArg();if("error"===r.type)return r;t.push(r)}}},{key:"parseFunctionalExpression",value:function(){if(this.consumeKeyword("customNode"))return this.parseCustomNodeExpression();var e=this.parseSingleExpression();if("error"===e.type)return e;for(;;){var t=!0,n=this.parseParenthesizedArgs();if(void 0!==n){if(t=!1,"error"===n.type)return n;e={type:"call",fn:e,entireLoc:(0,a.LU)((0,a.x9)(e),n.args[1]),args:n.args[0]}}if(this.consumeOperator(".")){if(t=!1,!this.consumeIdentifier())return{type:"error",value:"Expected identifier after the dot",location:this.maybeLastNonEOLToken(-1).location};var o=this.tokens[this.index-1];(0,r.h)("identifier"===o.token.type,"Expected identifier token, but got ".concat(o.token.type)),e={type:"attribute",expr:e,name:{node:o.token.value,location:o.location}}}if(t)break}return e}},{key:"parseExpression",value:function(){if(this.consumeKeyword("if"))return this.parseIfExpression();if(this.consumeKeyword("do"))return this.parseDoExpression();var e=[],t="expressionOrUnaryOperator";t:for(;;)switch(t){case"expressionOrUnaryOperator":if(this.consumeOperator.apply(this,f(c.mL))){var n=this.tokens[this.index-1];(0,r.h)("operator"===n.token.type,"Expected operator token"),e.push({type:"operator",operatorType:"unary",value:{node:n.token.value,location:n.location}});continue}var a=this.parseFunctionalExpression();if("error"===a.type)return a;e.push(a),t="binaryOperator";break;case"binaryOperator":if(this.consumeOperator.apply(this,f(c.iD))){var o=this.tokens[this.index-1];(0,r.h)("operator"===o.token.type,"Expected operator token"),e.push({type:"operator",operatorType:"binary",value:{node:o.token.value,location:o.location}}),t="expressionOrUnaryOperator"}else break t}return this.parseInfixSequence(e)}},{key:"parseInfixSequence",value:function(e){if((0,r.h)(0!==e.length,"Expected expression"),1===e.length)return(0,r.h)("operator"!==e[0].type,"Unexpected operator ".concat(JSON.stringify(e[0])," at beginning of infix sequence")),e[0];var t,n=e.map(function(e){var t,n;return"operator"===e.type&&null!=(n=null==(t=c.cP.get(e.value.node))?void 0:t.precedence)?n:0}),a=(t=Math).max.apply(t,f(n));(0,r.h)(a>0,"No valid operator found in infix sequence");var o=n.findIndex(function(e){return e===a});return(0,r.h)(o>-1,"No operator found with maximum precedence; this should not happen"),this.parseInfixSequence(this.resolveOperator(e,o))}},{key:"resolveOperator",value:function(e,t){(0,r.h)("operator"===e[t].type,"Expected operator at index ".concat(t,", but found expression: ").concat(JSON.stringify(e[t])));var n=e[t+1];if("operator"===n.type)return this.resolveOperator(e,t+1);switch(e[t].operatorType){case"unary":return f(e.slice(0,t)).concat([{type:"unaryOperator",operator:e[t].value,expr:n}],f(e.slice(t+2)));case"binary":var a=e[t-1],o=e[t+1];return(0,r.h)("operator"!==a.type&&"operator"!==o.type,"unreachable: left or right should not be an operator"),f(e.slice(0,t-1)).concat([{type:"binaryOperator",operator:e[t].value,left:a,right:o}],f(e.slice(t+2)))}}},{key:"checkLHS",value:function(e){switch(e.type){case"identifier":case"attribute":return e;case"constant":case"call":case"unaryOperator":case"binaryOperator":case"vectorLiteral":case"objectLiteral":case"if":case"do":case"customNode":return{type:"error",value:"Cannot assign to this expression",location:(0,a.x9)(e)}}}},{key:"parseStatement",value:function(){if(this.consumeKeyword("condition"))return this.parseConditionStatement();var e=this.parseExpression();if("error"===e.type)return e;if(this.consumeOperator("=")){var t=this.parseExpression();if("error"===t.type)return t;var n=this.checkLHS(e);return"error"===n.type?n:{type:"assignment",lhs:n,value:t}}return{type:"expression",value:e}}},{key:"parseIfExpression",value:function(){var e=this,t=this.tokens[this.index-1];if(!this.consumeBracket("("))return{type:"error",value:"Expected opening bracket ( after if",location:this.maybeLastNonEOLToken(-1).location};var n=this.parseExpression();if("error"===n.type)return n;if(!this.consumeBracket(")"))return{type:"error",value:"Expected closing bracket ) after if condition",location:this.maybeLastNonEOLToken(-1).location};if(!this.consumeBracket("{"))return{type:"error",value:"Expected opening bracket { after if condition",location:this.maybeLastNonEOLToken(-1).location};var r=this.parseStatements(!0,function(){return e.consumeBracket("}")},"Expected } after if block");if("error"===r.type)return r;var o=void 0;if(this.consumeKeyword("else")){if(!this.consumeBracket("{"))return{type:"error",value:"Expected opening bracket { after else",location:this.maybeLastNonEOLToken(-1).location};var i=this.parseStatements(!0,function(){return e.consumeBracket("}")},"Expected } after else block");if("error"===i.type)return i;o=i}var c=this.tokens[this.index-1];return{type:"if",entireLoc:(0,a.LU)(t.location,c.location),condition:n,then:r,else:o}}},{key:"parseDoExpression",value:function(){var e=this,t=this.tokens[this.index-1];if(!this.consumeBracket("{"))return{type:"error",value:"Expected opening bracket { after do",location:this.maybeLastNonEOLToken(-1).location};var n=this.parseStatements(!0,function(){return e.consumeBracket("}")},"Expected } after do block");if("error"===n.type)return n;var r=this.tokens[this.index-1];return{type:"do",entireLoc:(0,a.LU)(t.location,r.location),statements:"statements"===n.type?n.result:[n]}}},{key:"parseConditionStatement",value:function(){var e=this.tokens[this.index-1];if(!this.consumeBracket("("))return{type:"error",value:"Expected opening bracket ( after condition",location:this.maybeLastNonEOLToken(-1).location};var t=this.parseExpression();return"error"===t.type?t:this.consumeBracket(")")?{type:"condition",entireLoc:(0,a.LU)(e.location,this.tokens[this.index-1].location),condition:t,rest:[]}:{type:"error",value:"Expected closing bracket ) after condition",location:this.maybeLastNonEOLToken(-1).location}}},{key:"parseStatements",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!1},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Expected end of line or ; after",r=[];this.index<this.tokens.length&&!t();){for(;this.skipEOL(););if(this.index>=this.tokens.length)break;var o=this.parseStatement();if("error"===o.type)return o;if(r.push(o),t())break;if(!this.consumeOperator("EOL",";"))return{type:"error",value:n,location:this.maybeLastNonEOLToken(-1).location};for(;this.skipEOL(););}return this.index===this.tokens.length&&e?{type:"error",value:n,location:this.maybeLastNonEOLToken(-1).location}:function(e,t){if(1===(e=function e(t){for(var n=[],r=0;r<t.length;r++){var a,o=t[r];if("condition"===o.type){(a=o.rest).push.apply(a,f(e(t.slice(r+1)))),n.push(o);break}n.push(o)}return n}(e)).length)return e[0];var n=e.length>0?a.LU.apply(void 0,f(e.map(a.x9))):null!=t?t:i.tU;return{type:"statements",result:e,entireLoc:n}}(r,this.index>0?this.tokens[this.index-1].location:void 0)}},{key:"parseCustomNodeExpression",value:function(){var e=this.parseParenthesizedArgs();if(void 0===e)return{type:"error",value:"Expected arguments for customNode",location:this.maybeLastNonEOLToken(-1).location};if("error"===e.type)return e;var t=d(e.args,2),n=t[0],r=t[1],o=n[0];if(1!==n.length||"unnamed"!==o.type)return{type:"error",value:"Incorrect arguments for customNode, expected 1 unnamed argument",location:e.args[1]};if("constant"!==o.value.type||"string"!==o.value.value.node.type)return{type:"error",value:"Expected string constant as argument to customNode",location:(0,a.x9)(o)};var i=h(o.value.value.node.value,o.value.value.location.start.block);return"error"===i.type?{type:"customNode",expr:{type:"parseError",errors:i.errors,originalCode:o.value.value.node.value},originalCode:o.value.value.node.value,entireLoc:r}:{type:"customNode",expr:i,originalCode:o.value.value.node.value,entireLoc:r}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.filter(function(e){return"error"===e.token.type});if(a.length>0){var o=a.map(function(e){return{type:"error",value:"Unrecognized token: ".concat(e.token.value),location:e.location}});return n?{type:"parseError",originalCode:t,errors:o}:{type:"error",errors:o}}var i=new m(e),c=i.parseStatements();return"error"===c.type?n?{type:"parseError",originalCode:t,errors:[c]}:{type:"error",errors:[c]}:((0,r.h)(i.index===i.tokens.length,"Parser did not consume all tokens: ".concat(i.index," < ").concat(i.tokens.length)),c)}((0,o.jx)(null!=t?t:{type:"multi"},e),e,n)}function v(e){var t,n=new Set;return(t=[],!function e(n){switch(n.type){case"unnamed":case"expression":return e(n.value),!0;case"named":return t.push(n.value),e(n.value),!0;case"constant":case"identifier":return t.push(n),!0;case"attribute":case"unaryOperator":return t.push(n),e(n.expr),!0;case"call":return t.push(n),e(n.fn),n.args.forEach(e),!0;case"binaryOperator":return t.push(n),e(n.left),e(n.right),!0;case"objectLiteral":return t.push(n),n.properties.forEach(function(r){var a=d(r,2),o=a[0],i=a[1];t.push({type:"constant",value:{node:{type:"string",value:o},location:n.entireLoc}}),e(i)}),!0;case"vectorLiteral":return t.push(n),n.elements.forEach(e),!0;case"assignment":return e(n.lhs),e(n.value),!0;case"statements":return n.result.forEach(e),!0;case"if":return e(n.condition),e(n.then),n.else&&e(n.else),!0;case"do":return n.statements.forEach(e),!0;case"condition":return e(n.condition),n.rest.forEach(e),!0;case"parseError":return!0;case"customNode":return e(n.expr),!0}}(e),t).forEach(function(e){"identifier"===e.type&&n.add(e.name.node)}),n}function g(e,t){for(var n=v(e);"break"!==function(){var e=new Set;if(n.forEach(function(r){var a,o=null==(a=t.getVariable(r))?void 0:a.type;void 0!==o&&"function"===o.type&&Object.entries(o.namedArgs).forEach(function(t){var r=d(t,2)[1].defaultValue;void 0!==r&&v(r).forEach(function(t){n.has(t)||e.add(t)})})}),0===e.size)return"break";e.forEach(function(e){return n.add(e)})}(););return n}function _(e,t){var n,a=(n=h(e,{type:"single",ident:t},!0),(0,r.h)("error"!==n.type,"Should not have an error"),n);return(0,r.h)("expression"===a.type,"Must be expression, got ".concat(JSON.stringify(a))),a.value}},89080:function(e,t,n){n.d(t,{Kz:()=>function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===n){if("number"==typeof t)return{type:"number"};if("string"==typeof t)return{type:"string"};if("boolean"==typeof t)return{type:"boolean"};if(null===t)return{type:"null"}}return(0,r.h)(Array.isArray(t),"Expected a primitive value, but got ".concat(void 0===t?"undefined":l(t))),e(t[0],n-1)},Mu:()=>f,_N:()=>d,gs:()=>function e(t,n,a){if("elementOfEmptyVector"===t.type)return n;if("elementOfEmptyVector"===n.type||y(t)===y(n))return t;if("vector"===t.type&&"vector"===n.type)return{type:"vector",elementType:e(t.elementType,n.elementType,a)};if("object"===t.type&&"object"===n.type){if(JSON.stringify(u(t.properties.keys()).sort())!==JSON.stringify(u(n.properties.keys()).sort()))throw a();var o=new Map,i=!0,l=!1,s=void 0;try{for(var p,d=t.properties[Symbol.iterator]();!(i=(p=d.next()).done);i=!0){var f=c(p.value,2),m=f[0],h=f[1];o.set(m,h)}}catch(e){l=!0,s=e}finally{try{i||null==d.return||d.return()}finally{if(l)throw s}}var v=!0,g=!1,_=void 0;try{for(var b,x=n.properties[Symbol.iterator]();!(v=(b=x.next()).done);v=!0){var w=c(b.value,2),S=w[0],k=w[1],A=e(o.get(S),k,a);(0,r.h)("elementOfEmptyVector"!==A.type,"Unreachable"),o.set(S,A)}}catch(e){g=!0,_=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw _}}return{type:"object",properties:o}}throw a()},j6:()=>function e(t,n){if(y(t)===y(n))return!0;switch(n.type){case"number":case"string":case"boolean":case"null":case"opaque":case"function":return!1;case"vector":return(0,r.h)("elementOfEmptyVector"!==n.elementType.type,"Unreachable"),e(t,n.elementType);case"object":if("object"!==t.type||t.properties.size!==n.properties.size||!u(t.properties.keys()).every(function(e){return n.properties.has(e)}))return!1;return u(t.properties.keys()).every(function(r){return e(t.properties.get(r),n.properties.get(r))})}},vR:()=>m,wB:()=>y,xr:()=>p});var r=n(77053),a=n(27193),o=n(88452);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||s(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function s(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}function p(e,t){return{type:t,value:e,documentation:void 0}}function d(e){return"number"==typeof e?{type:"constant",value:{node:{type:"number",value:e},location:a.tU}}:"string"==typeof e?{type:"constant",value:{node:{type:"string",value:e},location:a.tU}}:"boolean"==typeof e?{type:"identifier",name:{node:e.toString(),location:a.tU}}:{type:"identifier",name:{node:"null",location:a.tU}}}function f(e,t){return"concrete"===e.type?y(e.value)===y(t):"number"===t.type||"string"===t.type||"boolean"===t.type||"null"===t.type}function y(e){var t,n,a;if("number"===e.type)return"number";if("string"===e.type)return"string";if("boolean"===e.type)return"boolean";if("vector"===e.type)return"[".concat("elementOfEmptyVector"===e.elementType.type?"":y(e.elementType),"]");if("object"===e.type){return(0,r.h)((t=e.properties,null!=(n=Map)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):t instanceof n),"Expected properties to be a Map, got ".concat(l(e.properties))),"{".concat(u(e.properties.entries()).sort().map(function(e){var t=c(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(y(r))}).join(", "),"}")}return"null"===e.type?"null":"opaque"===e.type?e.name:"(".concat(e.posArgs.map(m).join(", "),"; ").concat(Object.entries(e.namedArgs).map(function(e){var t,n,r=c(e,2),a=r[0],i=r[1];return"".concat(a,": ").concat((n=m((t=i).type),void 0!==t.defaultValue?"".concat(n," = ").concat((0,o.Z2)(t.defaultValue)):n))}).join(", "),") -> ").concat("concrete"===(a=e.returnType).type?y(a.value):"any")}function m(e){return"concrete"===e.type?y(e.value):"any"}},66011:function(e,t,n){var r,a=n(39343),o=n.n(a),i=n(12132);function c(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function u(e,t){var n=c(e,t,"get");return n.get?n.get.call(e):n.value}function l(e,t,n){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}function s(e,t,n){var r=c(e,t,"set");if(r.set)r.set.call(e,n);else{if(!r.writable)throw TypeError("attempted to set read only private field");r.value=n}return n}var p=new WeakMap,d=new WeakMap,f=new WeakMap,y=new WeakMap,m=function(){var e;function t(e,n,r,a){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");l(this,p,{writable:!0,value:void 0}),l(this,d,{writable:!0,value:void 0}),l(this,f,{writable:!0,value:void 0}),l(this,y,{writable:!0,value:void 0}),s(this,p,e),s(this,d,n),s(this,f,r),s(this,y,a);var i=!0,c=!1,u=void 0;try{for(var m,h=a.keys()[Symbol.iterator]();!(i=(m=h.next()).done);i=!0){var v=m.value;o()(!r.has(v),'Variable name "'.concat(v,'" conflicts with a constant'))}}catch(e){c=!0,u=e}finally{try{i||null==h.return||h.return()}finally{if(c)throw u}}}return e=[{key:"effect",value:function(e){u(this,p).call(this,e)}},{key:"error",value:function(e,t){return u(this,d).call(this,e,t)}},{key:"getVariable",value:function(e){return u(this,f).has(e)?u(this,f).get(e):u(this,y).get(e)}},{key:"assignVariable",value:function(e,t){if(u(this,f).has(e))return'Cannot assign to constant "'.concat(e,'"');u(this,y).set(e,t)}},{key:"variableEntries",value:function(){return u(this,y).entries()}},{key:"evolveVariables",value:function(e){return new t(u(this,p),u(this,d),u(this,f),e)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),h=n(77053),v=n(34672),g=n(89080);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||S(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function S(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}}function k(e,t,n){if(t(e.type))return{type:"success",result:[[],e.type,e.value]};var r=e.type;return"vector"===r.type?function(e,t,n){var r=e.type.elementType;if("elementOfEmptyVector"===r.type)return{type:"error",message:"".concat(n.role," is an empty vector whose type cannot be inferred")};var a=e.value.map(function(a){return k({type:r,value:a,documentation:e.documentation},t,n)});if((0,h.h)(0!==a.length,"Expected at least one vector element, but got an empty vector"),a.some(function(e){return"error"===e.type}))return a.find(function(e){return"error"===e.type});var o=a.map(function(e){return e.result}),i=o.map(function(e){return e[0]}),c=o.map(function(e){return e[1]}),u=o.map(function(e){return e[2]});return i.some(function(e){return JSON.stringify(e)!==JSON.stringify(i[0])})?{type:"error",message:"Jagged vector (nested vector where not all are the same length) cannot be broadcasted"}:c.some(function(e){return(0,g.wB)(e)!==(0,g.wB)(c[0])})?{type:"error",message:"Array of different types cannot be broadcasted: ".concat(c.map(g.wB).join(", "))}:{type:"success",result:[[i.length].concat(x(i[0])),c[0],u]}}(e,t,n):"object"===r.type&&x(r.properties.values()).some(function(e){return"vector"===e.type})?function(e,t,n){var r=x(e.type.properties.entries()).filter(function(e){return"vector"===b(e,2)[1].type}).map(function(e){return b(e,1)[0]});(0,h.h)(0!==r.length,"Expected an object with at least one vector property, but got ".concat((0,g.wB)(e.type)));var a=e.value,o=r.map(function(e){var t=a.get(e);return(0,h.h)(void 0!==t,"Expected object to have property ".concat(e,", but it is undefined")),(0,h.h)((void 0===t?"undefined":w(t))==="object"&&Array.isArray(t),"Expected object property ".concat(e," to be a vector, but got ").concat(void 0===t?"undefined":w(t))),t.length});if(o.some(function(e){return e!==o[0]}))return{type:"error",message:"Object properties ".concat(r.join(", ")," have different lengths (").concat(o.join(", "),"), cannot be broadcasted")};for(var i=[],c=0;c<o[0];c++){var u=new Map,l=!0,s=!1,p=void 0;try{for(var d,f=a.keys()[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var y=d.value;if(!r.includes(y)){u.set(y,a.get(y));continue}var m=a.get(y);(0,h.h)(void 0!==m&&Array.isArray(m),"Expected object to have property ".concat(y," as a vector, but it is undefined or not a vector")),u.set(y,m[c])}}catch(e){s=!0,p=e}finally{try{l||null==f.return||f.return()}finally{if(s)throw p}}i.push(u)}var v=[],_=!0,S=!1,A=void 0;try{for(var C,I=e.type.properties.entries()[Symbol.iterator]();!(_=(C=I.next()).done);_=!0){var O=b(C.value,2),E=O[0],T=O[1];if(!r.includes(E)){v.push([E,T]);continue}if((0,h.h)("vector"===T.type,"Expected object property ".concat(E," to be a vector, but got ").concat((0,g.wB)(T))),"elementOfEmptyVector"===T.elementType.type)return{type:"error",message:"Cannot broadcast object property ".concat(E," because its type is an empty vector with no inferred type")};v.push([E,T.elementType])}}catch(e){S=!0,A=e}finally{try{_||null==I.return||I.return()}finally{if(S)throw A}}return k({value:i,type:{type:"vector",elementType:{type:"object",properties:new Map(v)}},documentation:e.documentation},t,n)}(e,t,n):{type:"error",message:"Expected ".concat(n.role," to be a ").concat(n.typeDesc," (or vector thereof) but got ").concat((0,g.wB)(e.type))}}function A(e,t){return 0===e.length?t:A(e.slice(0,e.length-1),Array.from({length:e[e.length-1]},function(){return t}))}function C(e,t,n,r,a){var o=function(e,t,n,r){var a=function(e){var n=k(t[e],function(t){return(0,g.Mu)(c.posArgs[e],t)},{role:"positional argument ".concat(e+1),typeDesc:(0,g.vR)(c.posArgs[e])});if("error"===n.type)return{v:n};C.push(n.result)},o=k(e,function(e){return"function"===e.type},{role:"function",typeDesc:"function"});if("error"===o.type)return o;var i=o.result,c=i[1];if((0,h.h)("function"===c.type,"Expected a function type, but got ".concat((0,g.wB)(c))),c.posArgs.length!==t.length)return{type:"error",message:"Function expects ".concat(c.posArgs.length," positional arguments, but received ").concat(t.length)};var u=[],l=!0,s=!1,p=void 0;try{for(var d,f=Object.keys(c.namedArgs)[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var y=function(){var e=d.value;if(!n.some(function(t){return t[0]===e})){var t=c.namedArgs[e],a=function(e,t){if(e.defaultValue)return(0,h.h)("concrete"===e.type.type,"Expected named argument to have a concrete type"),J(e.defaultValue,t)}(t,r);if(void 0===a)return{v:{type:"error",message:"Function expects named argument ".concat(e,", but it was not provided")}};n.push([e,a]),u.push(e)}}();if("object"===w(y))return y.v}}catch(e){s=!0,p=e}finally{try{l||null==f.return||f.return()}finally{if(s)throw p}}var m=!0,v=!1,_=void 0;try{for(var x,S=n[Symbol.iterator]();!(m=(x=S.next()).done);m=!0){var A=b(x.value,1)[0];if(!Object.keys(c.namedArgs).includes(A))return{type:"error",message:"Function does not expect named argument ".concat(A,", but it was provided")}}}catch(e){v=!0,_=e}finally{try{m||null==S.return||S.return()}finally{if(v)throw _}}(0,h.h)(JSON.stringify(Object.keys(c.namedArgs).sort())===JSON.stringify(n.map(function(e){return e[0]}).sort()),"Function expects arguments named ".concat(Object.keys(c.namedArgs).join(", "),", but received [").concat(n.map(function(e){return e[0]}).join(", "),"]"));for(var C=[],I=0;I<c.posArgs.length;I++){var O=a(I);if("object"===w(O))return O.v}var E=[],T=!0,j=!1,N=void 0;try{for(var M,L=n[Symbol.iterator]();!(T=(M=L.next()).done);T=!0){var U=function(){var e=b(M.value,2),t=e[0],n=e[1],r=u.includes(t),a=k(n,function(e){return(0,g.Mu)(c.namedArgs[t].type,e)||r&&"null"===e.type},{role:"named argument ".concat(t),typeDesc:(0,g.vR)(c.namedArgs[t].type)});if("error"===a.type)return{v:a};E.push(a.result)}();if("object"===w(U))return U.v}}catch(e){j=!0,N=e}finally{try{T||null==L.return||L.return()}finally{if(j)throw N}}return{type:"success",result:[i,C,E]}}(e,t,n,r);if("error"===o.type)return o;var i=b(o.result,3),c=i[0],u=i[1],l=i[2],s=[c].concat(x(u),x(l)),p=function(e,t){for(var n=[],r=-1,a=0;a<e.length;a++){var o=b(e[a],1)[0];o.length>n.length&&(n=o,r=a)}for(var i=0;i<e.length;i++){var c=function(a){var o=b(e[a],1)[0],i=n.length-o.length;if(!o.every(function(e,t){return e===n[t+i]}))return{v:{type:"error",message:"Incompatibility between the shape of ".concat(t[a]," (").concat(o.join(", "),") and the shape of ").concat(t[r]," (").concat(n.join(", "),")")}}}(i);if("object"===w(c))return c.v}return{type:"success",result:e.map(function(e){var t=b(e,3),r=t[0],a=t[1],o=t[2];return[n,a,A(n.slice(0,n.length-r.length),o)]})}}(s,["function"].concat(x(u.map(function(e,t){return"positional argument ".concat(t+1)})),x(n.map(function(e){return"named argument ".concat(e[0])}))));if("error"===p.type)return p;c=(s=p.result)[0],u=s.slice(1,1+u.length),l=s.slice(1+u.length);var d=c[0].length,f=function e(t,n,r,a,o,i,c,u){if(0===i){(0,h.h)("function"==typeof t,"Expected a function, but got ".concat(void 0===t?"undefined":w(t)));var l=Object.fromEntries(a.map(function(e,t){return[r[t],e]}));try{return t(c,n,l,o)}catch(e){if(null!=H&&"undefined"!=typeof Symbol&&H[Symbol.hasInstance]?!!H[Symbol.hasInstance](e):e instanceof H)throw e;throw c.error("Error while executing function: ".concat(e),u)}}return(0,h.h)(Array.isArray(t),"Expected an array of functions, but got ".concat(void 0===t?"undefined":w(t))),Array.from({length:t.length},function(l,s){var p=n.map(function(e){return(0,h.h)(Array.isArray(e),"Expected an array of positional arguments, but got ".concat(void 0===e?"undefined":w(e))),e[s]}),d=a.map(function(e){return(0,h.h)(Array.isArray(e),"Expected an array of keyword arguments, but got ".concat(void 0===e?"undefined":w(e))),e[s]});return e(t[s],p,r,d,o,i-1,c,u)})}(c[2],u.map(function(e){return e[2]}),n.map(function(e){return e[0]}),l.map(function(e){return e[2]}),{posArgs:t,namedArgs:Object.fromEntries(n)},d,r,a),y=c[1].returnType,m="inferFromPrimitive"===y.type?(0,g.Kz)(f,d):y.value;return{type:"success",result:(0,g.xr)(f,function e(t,n){return 0===n?t:{type:"vector",elementType:e(t,n-1)}}(m,d))}}var I=n(34415);function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||N(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}}function M(e){return"vector"===e.type?((0,h.h)("elementOfEmptyVector"!==e.elementType.type,"Unreachable: should have failed earlier if elementType was elementOfEmptyVector"),e.elementType):e}function L(e,t,n){var r,a,o=function(e){var t=e.filter(function(e){return"null"!==e.type.type});if(1===t.length){var n=t[0];if("opaque"===n.type.type&&("cMap"===n.type.name||"cMapRGB"===n.type.name||"pMap"===n.type.name))return{type:"success",value:n}}}(e);if(void 0!==o)return o;var i=e.map(function(e){return e.type}).filter(function(e){return"null"!==e.type}).map(M);if(0===i.length)return{type:"success",value:(0,g.xr)(null,{type:"null"})};var c=i[0];if(i.some(function(e){return(0,g.wB)(e)!==(0,g.wB)(c)})){var u=Array.from(new Set(i.map(g.wB))).sort();return{type:"error",message:"Cannot merge values of different types: ".concat(u.join(", "))}}(0,h.h)(e.length===n.length,"Expected the number of values (".concat(e.length,") to match the number of references (").concat(n.length,")"));var l=t.type;if("boolean"!==l.elementType.type&&"number"!==l.elementType.type&&"string"!==l.elementType.type)return{type:"error",message:"Cannot condition on a mask of type ".concat((0,g.wB)(l))};for(var s=t.value,p=Array.from({length:e.length},function(){return 0}),d=[],f=0;f<s.length;f++){var y=n.indexOf(s[f]);(0,h.h)(-1!==y,"Reference ".concat(n[f]," not found in mask}")),d.push("null"===e[y].type.type?void 0:function(e,t){var n=e.type;if("vector"===n.type){var r=e.value;return(0,h.h)(t>=0&&t<r.length,"Index ".concat(t," out of bounds for vector of length ").concat(r.length)),(0,h.h)("elementOfEmptyVector"!==n.elementType.type,"Unreachable: should have failed earlier if elementType was elementOfEmptyVector"),{type:n.elementType,value:r[t],documentation:e.documentation}}return e}(e[y],p[y])),p[y]++}var m=void 0,v=d.map(function(e){return void 0!==e?e.value:(void 0===m&&(m=function e(t){switch(t.type){case"number":return NaN;case"string":return"";case"boolean":return!1;case"null":return null;case"vector":return[];case"object":return new Map(j(t.properties.entries()).map(function(t){var n=T(t,2);return[n[0],e(n[1])]}));case"function":return function(){throw Error("no default value for function type ".concat((0,g.wB)(t)))};case"opaque":throw Error("no default value for opaque type ".concat((0,g.wB)(t)))}}(c)),m)}),_={type:{type:"vector",elementType:i[0]},value:v,documentation:null==(r=e.find(function(e){return void 0!==e.documentation}))?void 0:r.documentation};return{type:"success",value:null!=(a=function e(t,n){if((0,g.wB)(t.type)===(0,g.wB)(n))return t;if("vector"===t.type.type){var r=t.value;if(r.length>0&&r.every(function(e){return e===r[0]}))return(0,h.h)("elementOfEmptyVector"!==t.type.elementType.type,"Unreachable: elementType was elementOfEmptyVector but contents is non-empty"),e({type:t.type.elementType,value:r[0],documentation:t.documentation},n)}}(_,c))?a:_}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t,n){return(D=F()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&V(a,n.prototype),a}).apply(null,arguments)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function q(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}}function G(e){var t="function"==typeof Map?new Map:void 0;return(G=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return D(e,arguments,P(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),V(n,e)})(e)}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(F=function(){return!!e})()}var H=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(e,n){var r,a,o,i;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return a=t,o=["".concat(e," at ").concat((i=n).start.lineIdx===i.end.lineIdx?i.start.colIdx+1===i.end.colIdx?"".concat(i.start.lineIdx+1,":").concat(i.start.colIdx+1):"".concat(i.start.lineIdx+1,":").concat(i.start.colIdx+1,"-").concat(i.end.colIdx):"".concat(i.start.lineIdx+1,":").concat(i.start.colIdx+1," - ").concat(i.end.lineIdx+1,":").concat(i.end.colIdx))],a=P(a),B(r=function(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,F()?Reflect.construct(a,o||[],P(this).constructor):a.apply(this,o)),"location",void 0),B(r,"value",void 0),r.location=n,r.name="InterpretationError",r.value=e,r.location=n,r}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e),t}(G(Error));function J(e,t){switch(e.type){case"constant":var n=e.value.node;if("number"===n.type)return(0,g.xr)(n.value,{type:"number"});return(0,g.xr)(n.value,{type:"string"});case"identifier":var r=e.name.node,a=t.getVariable(r);if(void 0!==a)return a;throw t.error("Undefined variable: ".concat(r),e.name.location);case"attribute":var o=Z(J(e.expr,t),e.name.node,void 0);if("error"===o.type)throw t.error(o.message,(0,v.x9)(e));return o.value;case"call":var i,c=J(e.fn,t),u=e.args.map(function(e){var n=e,r=t;switch(n.type){case"named":return{type:"named",name:n.name.node,value:J(n.value,r)};case"unnamed":return{type:"unnamed",value:J(n.value,r)}}}),l=(i=(0,v.x9)(e),C(c,u.filter(function(e){return"unnamed"===e.type}).map(function(e){return e.value}),u.filter(function(e){return"named"===e.type}).map(function(e){return[e.name,e.value]}),t,i));if("error"===l.type)throw t.error(l.message,(0,v.x9)(e));return l.result;case"unaryOperator":return function(e,t,n,r){var a=I.cP.get(t);(0,h.h)((null==a?void 0:a.unary)!==void 0,"Unknown operator: ".concat(t));var o=C(a.unary(t,r),[e],[],n,r);if("error"===o.type)throw n.error(o.message,r);return o.result}(J(e.expr,t),e.operator.node,t,(0,v.x9)(e));case"binaryOperator":return function(e,t,n,r,a){var o=I.cP.get(n);(0,h.h)((null==o?void 0:o.binary)!==void 0,"Unknown operator: ".concat(n));var i=C(o.binary(n,a),[e,t],[],r,a);if("error"===i.type)throw r.error(i.message,a);return i.result}(J(e.left,t),J(e.right,t),e.operator.node,t,(0,v.x9)(e));case"vectorLiteral":var s=e.elements.map(function(e){return J(e,t)}),p={type:"elementOfEmptyVector"},d=!0,f=!1,y=void 0;try{for(var m,_=s[Symbol.iterator]();!(d=(m=_.next()).done);d=!0)!function(){var n=m.value;p=(0,g.gs)(p,n.type,function(){return(0,h.h)("elementOfEmptyVector"!==p.type,"Unreachable: elementType should not be elementOfEmptyVector at ".concat(JSON.stringify(n.value))),t.error("vector literal contains heterogenous types ".concat((0,g.wB)(p)," and ").concat((0,g.wB)(n.type)),(0,v.x9)(e))})}()}catch(e){f=!0,y=e}finally{try{d||null==_.return||_.return()}finally{if(f)throw y}}return(0,g.xr)(s.map(function(e){return e.value}),{type:"vector",elementType:p});case"objectLiteral":var b=new Map,x=new Map,w=!0,S=!1,k=void 0;try{for(var A,O=e.properties[Symbol.iterator]();!(w=(A=O.next()).done);w=!0){var N,M=(N=A.value,function(e){if(Array.isArray(e))return e}(N)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(N,2)||q(N,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),U=M[0],D=M[1],B=J(D,t);if(b.has(U))throw t.error("Duplicate key ".concat(U," in object literal"),(0,v.x9)(D));b.set(U,B.type),x.set(U,B.value)}}catch(e){S=!0,k=e}finally{try{w||null==O.return||O.return()}finally{if(S)throw k}}return(0,g.xr)(x,{type:"object",properties:b});case"if":var P=J(e.condition,t);return function(e,t,n,r,a){var o=new Set;if(!function e(t,n){var r=n.type;switch(r.type){case"boolean":case"number":case"string":case"null":return t.add(n.value),!0;case"vector":var a=r.elementType;if("elementOfEmptyVector"===a.type)return!0;return n.value.map(function(n){return e(t,(0,g.xr)(n,a))}).every(function(e){return e});case"object":case"function":case"opaque":return!1}}(o,t))throw e.error("Conditional mask must be a vector of numbers, strings, or booleans, but got ".concat((0,g.wB)(t.type)),r);var i=Array.from(o).sort(function(e,t){var n=JSON.stringify(e),r=JSON.stringify(t);return n<r?-1:+(n>r)});if(0===i.length)throw e.error("Conditional mask must have at least one unique value, but got none",r);var c=t.type;if(1===i.length)return n({type:(0,g.Kz)(i[0]),value:i[0],documentation:t.documentation},e);(0,h.h)("vector"===c.type,"unreachable");var u=i.map(function(a){var o=function(e,t,n){var r=new Map,a=!0,o=!1,i=void 0;try{for(var c,u=e.variableEntries()[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=T(c.value,2),s=l[0],p=l[1],d=function(e,t,n){switch(e.type.type){case"vector":case"object":return function e(t,n,r){var a=t.type,o=n.type;switch(o.type){case"boolean":case"number":case"string":case"null":return{type:"success",value:{type:{type:"vector",elementType:a},value:n.value===r?[t.value]:[],documentation:t.documentation}};case"vector":var i=n.value;if("vector"!==a.type){var c=function e(t,n){var r=t.type;if("vector"===r.type)return((0,h.h)(E(t.value,Array),"unreachable"),t.value.length!==n)?{type:"error",message:"Expected vector of length ".concat(n,", but got ").concat(t.value.length)}:{type:"success",value:{type:r,value:t.value}};if("object"===r.type){var a=new Map,o=new Map,i=!0,c=!1,u=void 0;try{for(var l,s=r.properties.entries()[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var p=T(l.value,2),d=p[0],f=p[1];(0,h.h)(E(t.value,Map),"unreachable");var y=t.value.get(d);(0,h.h)(void 0!==y,"unreachable");var m=e((0,g.xr)(y,f),n);if("error"===m.type)return m;(0,h.h)(E(m.value.value,Array),"unreachable"),(0,h.h)("elementOfEmptyVector"!==m.value.type.elementType.type,"unreachable"),o.set(d,m.value.value),a.set(d,m.value.type.elementType)}}catch(e){c=!0,u=e}finally{try{i||null==s.return||s.return()}finally{if(c)throw u}}return{type:"success",value:{type:{type:"vector",elementType:{type:"object",properties:a}},value:Array.from({length:n},function(e,t){return new Map(Array.from(o.entries()).map(function(e){var n=T(e,2);return[n[0],n[1][t]]}))}),documentation:t.documentation}}}return{type:"success",value:{type:{type:"vector",elementType:t.type},value:Array.from({length:n},function(){return t.value}),documentation:t.documentation}}}(t,i.length);if("error"===c.type)return c;return e(c.value,n,r)}var u=t.value;if(i.length!==u.length)return{type:"error",message:"Mask length ".concat(i.length," does not match value length ").concat(u.length)};for(var l=void 0,s=[],p=0;p<i.length;p++){(0,h.h)("elementOfEmptyVector"!==a.elementType.type,"Value element type cannot be elementOfEmptyVector, got ".concat((0,g.wB)(a))),(0,h.h)("elementOfEmptyVector"!==o.elementType.type,"Mask element type cannot be elementOfEmptyVector, got ".concat((0,g.wB)(o)));var d=e({type:a.elementType,value:u[p],documentation:t.documentation},{type:o.elementType,value:i[p],documentation:n.documentation},r);if("error"===d.type)return d;s.push.apply(s,j(d.value.value));var f=d.value.type.elementType;l=void 0===l?f:(0,g.gs)(l,f,function(){return Error("Should be unreachable")})}return(0,h.h)(void 0!==l,"already handled empty vector case"),{type:"success",value:{type:{type:"vector",elementType:l},value:s,documentation:t.documentation}};case"object":case"function":case"opaque":throw Error("this case was already handled earlier, should not be reachable")}}(e,t,n);case"number":case"string":case"boolean":case"null":case"opaque":case"function":return{type:"success",value:e}}}(p,t,n);if("error"===d.type)return{type:"error",message:"Error indexing variable ".concat(s,": ").concat(d.message)};r.set(s,d.value)}}catch(e){o=!0,i=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw i}}return{type:"success",value:e.evolveVariables(r)}}(e,t,a);if("error"===o.type)throw e.error("Conditional error: ".concat(o.message),r);return(0,h.h)("elementOfEmptyVector"!==c.elementType.type,"Unreachable: should have failed earlier if elementType was elementOfEmptyVector"),[n({type:(0,g.Kz)(a),value:a,documentation:t.documentation},o.value),o.value]}),l=new Map,s=new Set,p=!0,d=!1,f=void 0;try{for(var y,m=u[Symbol.iterator]();!(p=(y=m.next()).done);p=!0){var v=T(y.value,2)[1],_=!0,b=!1,x=void 0;try{for(var w,S=v.variableEntries()[Symbol.iterator]();!(_=(w=S.next()).done);_=!0){var k=T(w.value,1)[0];s.add(k)}}catch(e){b=!0,x=e}finally{try{_||null==S.return||S.return()}finally{if(b)throw x}}}}catch(e){d=!0,f=e}finally{try{p||null==m.return||m.return()}finally{if(d)throw f}}var A=!0,C=!1,I=void 0;try{for(var O,N=s[Symbol.iterator]();!(A=(O=N.next()).done);A=!0)!function(){var n=O.value,r=u.map(function(e){var t;return null!=(t=T(e,2)[1].getVariable(n))?t:(0,g.xr)(null,{type:"null"})});(0,h.h)("vector"===t.type.type,"unreachable");var o=L(r,t,i);if("error"===o.type)throw e.error("Error merging values for variable ".concat(n,": ").concat(o.message),a);if("null"!==o.value.type.type)l.set(n,o.value)}()}catch(e){C=!0,I=e}finally{try{A||null==N.return||N.return()}finally{if(C)throw I}}var M=!0,U=!1,D=void 0;try{for(var B,P=l.entries()[Symbol.iterator]();!(M=(B=P.next()).done);M=!0){var R=T(B.value,2),V=R[0],z=R[1],q=e.assignVariable(V,z);(0,h.h)(void 0===q,"Error assigning variable ".concat(V,": ").concat(q))}}catch(e){U=!0,D=e}finally{try{M||null==P.return||P.return()}finally{if(U)throw D}}var G=L(u.map(function(e){return T(e,1)[0]}),t,i);return"error"===G.type?(0,g.xr)(null,{type:"null"}):G.value}(t,P,function(n,r){if("boolean"!==n.type.type)throw t.error("Condition in if statement must be a boolean, but got ".concat((0,g.wB)(n.type)),(0,v.x9)(e.condition));return n.value?K(e.then,r):void 0===e.else?(0,g.xr)(null,{type:"null"}):K(e.else,r)},(0,v.x9)(e.condition),(0,v.x9)(e));case"do":if(0===e.statements.length)return(0,g.xr)(null,{type:"null"});var R=K(e.statements[0],t),V=!0,z=!1,G=void 0;try{for(var F,H=e.statements.slice(1)[Symbol.iterator]();!(V=(F=H.next()).done);V=!0){var W=F.value;R=K(W,t)}}catch(e){z=!0,G=e}finally{try{V||null==H.return||H.return()}finally{if(z)throw G}}return R;case"customNode":var $=K(e.expr,t);if(e.expectedType&&!e.expectedType.some(function(e){return(0,g.j6)($.type,e)}))throw t.error("Custom expression expected to return type ".concat(e.expectedType.map(function(e){return(0,g.wB)(e)}).join(" or "),", but got ").concat((0,g.wB)($.type)),(0,v.x9)(e));return $}}function K(e,t){switch(e.type){case"condition":var n;if(0===e.rest.length)throw t.error("condition(..) must be followed by at least one statement",(0,v.x9)(e));return J({type:"if",condition:e.condition,then:{type:"statements",result:e.rest,entireLoc:v.LU.apply(void 0,function(e){if(Array.isArray(e))return U(e)}(n=e.rest.map(v.x9))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||q(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},entireLoc:e.entireLoc},t);case"assignment":var r=J(e.value,t);return function(e,t,n){switch(e.type){case"identifier":var r=e.name.node,a=n.assignVariable(r,t);if(void 0!==a)throw n.error(a,(0,v.x9)(e));return;case"attribute":var o=Z(J(e.expr,n),e.name.node,t);if("error"===o.type)throw n.error(o.message,(0,v.x9)(e));return}}(e.lhs,r,t),r;case"expression":return J(e.value,t);case"statements":if(0===e.result.length)return(0,g.xr)(null,{type:"null"});var a=K(e.result[0],t),o=!0,i=!1,c=void 0;try{for(var u,l=e.result.slice(1)[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var s=u.value;a=K(s,t)}}catch(e){i=!0,c=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw c}}return a;case"parseError":throw(0,h.h)(e.errors.length>0,"parseError node must have at least one error"),t.error("Parse error: ".concat(e.errors.map(function(e){return e.value}).join(", ")),e.errors[0].location)}}function Z(e,t,n){var r=e.type;if("object"===r.type){var a=e.value;(0,h.h)(R(a,Map),"Expected object type because of ".concat((0,g.wB)(r),", but got ").concat(void 0===a?"undefined":z(a)," at ").concat(JSON.stringify(e.value)));var o=r.properties.get(t);if(void 0===o)return{type:"error",message:"Attribute ".concat(t," not found in object of type ").concat((0,g.wB)(r))};if(void 0!==n)return(0,g.wB)(o)!==(0,g.wB)(n.type)?{type:"error",message:"Type mismatch: expected ".concat((0,g.wB)(o)," but got ").concat((0,g.wB)(n.type)," for attribute ").concat(t," in object of type ").concat((0,g.wB)(r))}:(a.set(t,n.value),{type:"success",value:(0,g.xr)(n.value,o)});var i=a.get(t);return(0,h.h)(void 0!==i,"Expected attribute ".concat(t," to be defined in object, but got undefined at ").concat(JSON.stringify(e.value))),{type:"success",value:(0,g.xr)(a.get(t),o)}}if("vector"===r.type){var c=e.value;(0,h.h)(R(c,Array),"Expected vector type because of ".concat((0,g.wB)(r),", but got ").concat(void 0===c?"undefined":z(c)," at ").concat(JSON.stringify(e.value)));var u=function(){};if(void 0!==n){if("vector"!==n.type.type&&(n=(0,g.xr)(A([c.length],n.value),{type:"vector",elementType:n.type})),(0,h.h)(Array.isArray(n.value),"It should be an array at this point"),n.value.length!==c.length)return{type:"error",message:"Expected vector of length ".concat(c.length," but got ").concat(n.value.length," for attribute ").concat(t," in object of type ").concat((0,g.wB)(r))};var l=n.value,s=n.type.elementType;(0,h.h)("elementOfEmptyVector"!==s.type,"Unreachable: elementType should not be elementOfEmptyVector at ".concat(JSON.stringify(n.value))),u=function(e){return(0,g.xr)(l[e],s)}}var p=c.map(function(n,a){return(0,h.h)("elementOfEmptyVector"!==r.elementType.type,"Unreachable: elementType should not be elementOfEmptyVector at ".concat(JSON.stringify(e.value))),Z((0,g.xr)(n,r.elementType),t,u(a))});if(p.some(function(e){return"error"===e.type}))return{type:"error",message:p.filter(function(e){return"error"===e.type}).map(function(e){return e.message})[0]};var d=p.map(function(e){return e.value}),f=d.map(function(e){return e.value}),y=d[0].type;return{type:"success",value:(0,g.xr)(f,{type:"vector",elementType:y})}}return{type:"error",message:"Cannot access attribute of type ".concat((0,g.wB)(r),". Only objects and vectors support attributes.")}}var W=n(88452);(0,g._N)(1);let $=["County","MSA","CSA","Urban Area","ZIP","CCD","City","Neighborhood","Congressional District","State House District","State Senate District","Congressional District (1780s)","Congressional District (1790s)","Congressional District (1800s)","Congressional District (1810s)","Congressional District (1820s)","Congressional District (1830s)","Congressional District (1840s)","Congressional District (1850s)","Congressional District (1860s)","Congressional District (1870s)","Congressional District (1880s)","Congressional District (1890s)","Congressional District (1900s)","Congressional District (1910s)","Congressional District (1920s)","Congressional District (1930s)","Congressional District (1940s)","Congressional District (1950s)","Congressional District (1960s)","Congressional District (1970s)","Congressional District (1980s)","Congressional District (1990s)","Congressional District (2000s)","Congressional District (2010s)","Congressional District (2020s)","Native Area","Native Statistical Area","Native Subdivision","School District","Judicial District","Judicial Circuit","County Cross CD","USDA County Type","Hospital Referral Region","Hospital Service Area","Media Market","CA Census Division","CA Census Subdivision","CA Population Center","CA CMA","CA Riding","Continent","Country","Subnational Region","Urban Center","Metropolitan Cluster","5M Person Circle","10M Person Circle","20M Person Circle","50M Person Circle","100M Person Circle","200M Person Circle","500M Person Circle","1B Person Circle"],X=["2008 Presidential Election-margin","2008-2012 Swing-margin","2012 Presidential Election-margin","2012-2016 Swing-margin","2016 Presidential Election-margin","2016-2020 Swing-margin","2020 Presidential Election-margin","2020-2024 Swing-margin","2024 Presidential Election-margin","ARTHRITIS_cdc_2","BINGE_cdc_2","BPHIGH_cdc_2","CANCER_cdc_2","CASTHMA_cdc_2","CHD_cdc_2","CHECKUP_cdc_2","CHOLSCREEN_cdc_2","COGNITION_cdc_2","COPD_cdc_2","CSMOKING_cdc_2","DENTAL_cdc_2","DIABETES_cdc_2","DISABILITY_cdc_2","GHLTH_cdc_2","HEARING_cdc_2","INDEPLIVE_cdc_2","KIDNEY_cdc_2","LPA_cdc_2","MOBILITY_cdc_2","OBESITY_cdc_2","PHLTH_cdc_2","SELFCARE_cdc_2","SLEEP_cdc_2","STROKE_cdc_2","VISION_cdc_2","ad_0.25","ad_0.25_2000","ad_0.25_2010","ad_0.25_change_2000","ad_0.25_change_2010","ad_0.5","ad_0.5_2000","ad_0.5_2010","ad_0.5_change_2000","ad_0.5_change_2010","ad_1","ad_1.609344","ad_1.609344_2000","ad_1.609344_2010","ad_1.609344_change_2000","ad_1.609344_change_2010","ad_16","ad_16_2000","ad_16_2010","ad_16_change_2000","ad_16_change_2010","ad_1_2000","ad_1_2010","ad_1_change_2000","ad_1_change_2010","ad_2","ad_2_2000","ad_2_2010","ad_2_change_2000","ad_2_change_2010","ad_32","ad_32_2000","ad_32_2010","ad_32_change_2000","ad_32_change_2010","ad_4","ad_4_2000","ad_4_2010","ad_4_change_2000","ad_4_change_2010","ad_64","ad_64_2000","ad_64_2010","ad_64_change_2000","ad_64_change_2010","ad_8","ad_8_2000","ad_8_2010","ad_8_change_2000","ad_8_change_2010","area","asian","asian_2000","asian_2010","birthplace_non_us","birthplace_us_not_state","birthplace_us_state","black","black_2000","black_2010","citizenship_citizen_by_birth","citizenship_citizen_by_naturalization","citizenship_not_citizen","compactness","days_above_90_4","days_below_40_4","days_between_40_and_90_4","days_dewpoint_-inf_50_4","days_dewpoint_50_70_4","days_dewpoint_70_inf_4","density_2021_pw_0.25_canada","density_2021_pw_0.5_canada","density_2021_pw_1.609344_canada","density_2021_pw_16_canada","density_2021_pw_1_canada","density_2021_pw_2_canada","density_2021_pw_32_canada","density_2021_pw_4_canada","density_2021_pw_64_canada","density_2021_pw_8_canada","education_field_business","education_field_humanities","education_field_stem","education_grad","education_grad_canada","education_high_school","education_high_school_canada","education_ugrad","education_ugrad_canada","female_grad_gap_4","female_hs_gap_4","female_ugrad_gap_4","generation_boomer","generation_boomer_canada","generation_genalpha","generation_genalpha_canada","generation_genx","generation_genx_canada","generation_genz","generation_genz_canada","generation_millenial","generation_millenial_canada","generation_silent","generation_silent_canada","gpw_aw_density","gpw_population","gpw_pw_density_1","gpw_pw_density_1.609344","gpw_pw_density_16","gpw_pw_density_2","gpw_pw_density_32","gpw_pw_density_4","gpw_pw_density_64","gpw_pw_density_8","gridded_elevation","gridded_hilliness","hawaiian_pi","hawaiian_pi_2000","hawaiian_pi_2010","heating_bottled_tank_lp_gas","heating_electricity","heating_feul_oil_kerosene","heating_no","heating_other","heating_utility_gas","hispanic","hispanic_2000","hispanic_2010","homogeneity_250_2000","homogeneity_250_2010","homogeneity_250_2020","homogeneity_250_diff_2000","homogeneity_250_diff_2010","hours_sunny_4","household_income_50_to_100cad","household_income_50k_to_100k","household_income_above_100_cad","household_income_over_100k","household_income_under_50cad","household_income_under_50k","housing_per_pop","housing_per_pop_2000","housing_per_pop_2010","individual_income_50_to_100cad","individual_income_50k_to_100k","individual_income_above_100_cad","individual_income_over_100k","individual_income_under_50cad","individual_income_under_50k","industry_accommodation_and_food_services","industry_accommodation_and_food_services_canada","industry_administrative_and_support_and_waste_management_services","industry_administrative_and_support_and_waste_management_services_canada","industry_agriculture,_forestry,_fishing_and_hunting","industry_agriculture,_forestry,_fishing_and_hunting_canada","industry_arts,_entertainment,_and_recreation","industry_arts,_entertainment,_and_recreation_canada","industry_construction","industry_construction_canada","industry_educational_services","industry_educational_services_canada","industry_finance_and_insurance","industry_finance_and_insurance_canada","industry_health_care_and_social_assistance","industry_health_care_and_social_assistance_canada","industry_information","industry_information_canada","industry_management_of_companies_and_enterprises","industry_management_of_companies_and_enterprises_canada","industry_manufacturing","industry_manufacturing_canada","industry_mining,_quarrying,_and_oil_and_gas_extraction","industry_mining,_quarrying,_and_oil_and_gas_extraction_canada","industry_other_services,_except_public_administration","industry_other_services,_except_public_administration_canada","industry_professional,_scientific,_and_technical_services","industry_professional,_scientific,_and_technical_services_canada","industry_public_administration","industry_public_administration_canada","industry_real_estate_and_rental_and_leasing","industry_real_estate_and_rental_and_leasing_canada","industry_retail_trade","industry_retail_trade_canada","industry_transportation_and_warehousing","industry_transportation_and_warehousing_canada","industry_utilities","industry_utilities_canada","industry_wholesale_trade","industry_wholesale_trade_canada","insurance_coverage_govt","insurance_coverage_none","insurance_coverage_private","internet_no_access","language_english_only","language_other","language_spanish","lapop10share_usda_fra_1","lapop1share_usda_fra_1","lapop20share_usda_fra_1","lapophalfshare_usda_fra_1","lico_at_canada","life_expectancy_2019","marriage_divorced","marriage_divorced_canada","marriage_married_not_divorced","marriage_married_not_divorced_canada","marriage_never_married","marriage_never_married_canada","mean_dist_Active Superfund Site_updated","mean_dist_Airport_updated","mean_dist_Hospital_updated","mean_dist_Public School_updated","mean_high_dewpoint_4","mean_high_heat_index_4","mean_high_temp_4","mean_high_temp_djf","mean_high_temp_fall_4","mean_high_temp_jja","mean_high_temp_mam","mean_high_temp_son","mean_high_temp_spring_4","mean_high_temp_summer_4","mean_high_temp_winter_4","mean_low_temp","mean_low_temp_djf","mean_low_temp_jja","mean_low_temp_mam","mean_low_temp_son","median_household_income","native","native_2000","native_2010","occupation_architecture_and_engineering_occupations","occupation_arts,_design,_entertainment,_sports,_and_media_occupations","occupation_building_and_grounds_cleaning_and_maintenance_occupations","occupation_business_and_financial_operations_occupations","occupation_community_and_social_service_occupations","occupation_computer_and_mathematical_occupations","occupation_construction_and_extraction_occupations","occupation_educational_instruction,_and_library_occupations","occupation_farming,_fishing,_and_forestry_occupations","occupation_firefighting_and_prevention,_and_other_protective_service_workers_including_supervisors","occupation_food_preparation_and_serving_related_occupations","occupation_health_diagnosing_and_treating_practitioners_and_other_technical_occupations","occupation_health_technologists_and_technicians","occupation_healthcare_support_occupations","occupation_installation,_maintenance,_and_repair_occupations","occupation_law_enforcement_workers_including_supervisors","occupation_legal_occupations","occupation_life,_physical,_and_social_science_occupations","occupation_management_occupations","occupation_material_moving_occupations","occupation_office_and_administrative_support_occupations","occupation_personal_care_and_service_occupations","occupation_production_occupations","occupation_sales_and_related_occupations","occupation_transportation_occupations","other  slash  mixed","other  slash  mixed_2000","other  slash  mixed_2010","park_percent_1km_v2","performance_score_adj_2019","pm_25_2018_2022","population","population_2000","population_2010","population_2021_canada","population_change_2000","population_change_2010","poverty_below_line","rainfall_4","rent_1br_750_to_1500","rent_1br_over_1500","rent_1br_under_750","rent_2br_750_to_1500","rent_2br_over_1500","rent_2br_under_750","rent_burden_20_to_40","rent_burden_over_40","rent_burden_under_20","rent_or_own_rent","sd","sd_2000","sd_2010","sd_2021_canada","segregation_250_10_2000","segregation_250_10_2010","segregation_250_10_2020","segregation_250_10_diff_2000","segregation_250_10_diff_2010","segregation_250_2000","segregation_250_2010","segregation_250_2020","segregation_250_diff_2000","segregation_250_diff_2010","snowfall_4","sors_child","sors_cohabiting_partnered_gay","sors_cohabiting_partnered_straight","sors_other","sors_unpartnered_householder","traffic_fatalities_last_decade","traffic_fatalities_last_decade_per_capita","traffic_fatalities_ped_last_decade","traffic_fatalities_ped_last_decade_per_capita","transportation_commute_time_15_to_29","transportation_commute_time_15_to_29_canada","transportation_commute_time_30_to_59","transportation_commute_time_30_to_59_canada","transportation_commute_time_median","transportation_commute_time_median_canada","transportation_commute_time_over_60","transportation_commute_time_over_60_canada","transportation_commute_time_under_15","transportation_commute_time_under_15_canada","transportation_means_bike","transportation_means_car","transportation_means_transit","transportation_means_walk","transportation_means_worked_at_home","vacancy","vacancy_2000","vacancy_2010","vehicle_ownership_at_least_1","vehicle_ownership_at_least_2","vehicle_ownership_none","white","white_2000","white_2010","wind_speed_over_10mph_4","within_Active Superfund Site_10","within_Airport_30","within_Hospital_10","within_Public School_2","year_built_1969_or_earlier","year_built_1970_to_1979","year_built_1980_to_1989","year_built_1990_to_1999","year_built_2000_to_2009","year_built_2010_or_later"];var Y=n(22379),Q=n(58788);let ee={"10M Person Circle":[105,105,105,60],"20M Person Circle":[205,170],"5M Person Circle":[54,54,54,54,54,54,51],"CA Census Division":[285,90],"CA Census Subdivision":[18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,15],"CA Population Center":[82,82,82,82,47],"CA Riding":[247,128],CCD:[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],City:[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"Congressional District":[192,183],"Congressional District (1810s)":[328,47],"Congressional District (1820s)":[344,31],"Congressional District (1830s)":[288,87],"Congressional District (1840s)":[230,145],"Congressional District (1850s)":[241,134],"Congressional District (1860s)":[295,80],"Congressional District (1870s)":[153,153,69],"Congressional District (1880s)":[140,140,95],"Congressional District (1890s)":[169,169,37],"Congressional District (1900s)":[168,168,39],"Congressional District (1910s)":[124,124,124,3],"Congressional District (1920s)":[169,169,37],"Congressional District (1930s)":[168,168,39],"Congressional District (1940s)":[149,149,77],"Congressional District (1950s)":[162,162,51],"Congressional District (1960s)":[82,82,82,82,47],"Congressional District (1970s)":[152,152,71],"Congressional District (1980s)":[139,139,97],"Congressional District (1990s)":[122,122,122,9],"Congressional District (2000s)":[154,154,67],"Congressional District (2010s)":[161,161,53],County:[26,26,26,26,26,26,26,26,26,26,26,26,26,26,11],"County Cross CD":[23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,7],"Hospital Referral Region":[263,112],"Hospital Service Area":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],MSA:[88,88,88,88,23],"Metropolitan Cluster":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"Native Area":[223,152],"Native Statistical Area":[290,85],"Native Subdivision":[181,181,13],Neighborhood:[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,3],"School District":[7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4],"State House District":[18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,15],"State Senate District":[43,43,43,43,43,43,43,43,31],"Subnational Region":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"Urban Area":[32,32,32,32,32,32,32,32,32,32,32,23],"Urban Center":[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,6],ZIP:[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]},et=["world","Africa","Asia","Europe","North America","Oceania","South America","Andorra","United Arab Emirates","Afghanistan","Antigua and Barbuda","Anguilla","Albania","Armenia","Angola","Argentina","Austria","Australia","Aruba","Azerbaijan","Bosnia and Herzegovina","Barbados","Bangladesh","Belgium","Burkina Faso","Bulgaria","Bahrain","Burundi","Benin","Bermuda","Brunei","Bolivia","Brazil","The Bahamas","Bhutan","Botswana","Belarus","Belize","Canada","Cocos (Keeling) Islands","Democratic Republic of the Congo","Central African Republic","Congo","Switzerland","Ivory Coast","Cook Islands","Chile","Cameroon","China","Colombia","Costa Rica","Cuba","Cape Verde","Christmas Island","Cyprus","Czech Republic","Germany","Djibouti","Denmark","Dominica","Dominican Republic","Algeria","Ecuador","Estonia","Egypt","Eritrea","Spain","Ethiopia","Finland","Fiji","Falkland Islands","Micronesia","Faroe Islands","France","Gabon","United Kingdom","Grenada","Georgia","Guernsey","Ghana","Gibraltar","Greenland","The Gambia","Guinea","Equatorial Guinea","Greece","Guatemala","Guinea-Bissau","Guyana","Honduras","Croatia","Haiti","Hungary","Indonesia","Ireland","Israel","Isle of Man","India","Iraq","Iran","Iceland","Italy","Jersey","Jamaica","Jordan","Japan","Kenya","Kyrgyzstan","Cambodia","Kiribati","Comoros","Saint Kitts and Nevis","North Korea","South Korea","Kuwait","Cayman Islands","Kazakhstan","Laos","Lebanon","Saint Lucia","Liechtenstein","Sri Lanka","Liberia","Lesotho","Lithuania","Luxembourg","Latvia","Libya","Morocco","Monaco","Moldova","Montenegro","Madagascar","Marshall Islands","North Macedonia","Mali","Myanmar","Mongolia","Mauritania","Montserrat","Malta","Mauritius","Maldives","Malawi","Mexico","Malaysia","Mozambique","Namibia","Niger","Norfolk Island","Nigeria","Nicaragua","Netherlands","Norway","Nepal","Nauru","Niue","New Zealand","Oman","Panama","Peru","Papua New Guinea","Philippines","Pakistan","Poland","Pitcairn Islands","State of Palestine","Portugal","Palau","Paraguay","Qatar","Romania","Serbia","Russia","Rwanda","Saudi Arabia","Solomon Islands","Seychelles","Sudan","Sweden","Singapore","Saint Helena, Ascension and Tristan da Cunha","Slovenia","Slovakia","Sierra Leone","San Marino","Senegal","Somalia","Suriname","South Sudan","S\xe3o Tom\xe9 and Pr\xedncipe","El Salvador","Syria","Eswatini","Turks and Caicos Islands","Chad","Togo","Thailand","Tajikistan","Tokelau","East Timor","Turkmenistan","Tunisia","Tonga","Turkey","Trinidad and Tobago","Tuvalu","Tanzania","Ukraine","Uganda","USA","Uruguay","Uzbekistan","Vatican City","Saint Vincent and the Grenadines","Venezuela","British Virgin Islands","Vietnam","Vanuatu","Samoa","Yemen","South Africa","Zambia","Zimbabwe","Alabama, USA","Alaska, USA","Arizona, USA","Arkansas, USA","California, USA","Colorado, USA","Connecticut, USA","Delaware, USA","Florida, USA","Georgia, USA","Hawaii, USA","Idaho, USA","Illinois, USA","Indiana, USA","Iowa, USA","Kansas, USA","Kentucky, USA","Louisiana, USA","Maine, USA","Maryland, USA","Massachusetts, USA","Michigan, USA","Minnesota, USA","Mississippi, USA","Missouri, USA","Montana, USA","Nebraska, USA","Nevada, USA","New Hampshire, USA","New Jersey, USA","New Mexico, USA","New York, USA","North Carolina, USA","North Dakota, USA","Ohio, USA","Oklahoma, USA","Oregon, USA","Pennsylvania, USA","Rhode Island, USA","South Carolina, USA","South Dakota, USA","Tennessee, USA","Texas, USA","Utah, USA","Vermont, USA","Virginia, USA","Washington, USA","West Virginia, USA","Wisconsin, USA","Wyoming, USA","American Samoa, USA","Guam, USA","Northern Mariana Islands, USA","Puerto Rico, USA","US Virgin Islands, USA","District of Columbia, USA","Alberta, Canada","British Columbia, Canada","Manitoba, Canada","New Brunswick, Canada","Newfoundland and Labrador, Canada","Northwest Territories, Canada","Nova Scotia, Canada","Nunavut, Canada","Ontario, Canada","Prince Edward Island, Canada","Quebec, Canada","Saskatchewan, Canada","Yukon, Canada"];var en=n(69417);function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ea(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=e;return(n=t?n.replaceAll("/"," slash "):n.replaceAll("/","slash")).replaceAll("%","%25")}function eo(e,t,n){return(eo=el()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&ec(a,n.prototype),a}).apply(null,arguments)}Object.fromEntries(Object.entries(en.Z).map(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,2)||function(e,t){if(e){if("string"==typeof e)return er(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return er(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=t[0];return[t[1],n]})),n(12391);function ei(e){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ec(e,t){return(ec=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eu(e){var t="function"==typeof Map?new Map:void 0;return(eu=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return eo(e,arguments,ei(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ec(n,e)})(e)}function el(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(el=function(){return!!e})()}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ep(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return es(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return es(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ef(e){}eu(Map),Object.keys(en.Z).filter(function(e){return e.startsWith("Congressional District (")}).map(function(e){return en.Z[e]}),Object.entries(en.Z).filter(function(e){return ep(e,1)[0].endsWith("Person Circle")}).map(function(e){return ep(e,2)[1]}),n(20110);var ey={match:5,position:5,priority:1.6,population:2,incompleteMatches:1,swapOverlap:1,priorityType:.2},em=Object.values(ey).reduce(function(e,t){return e+t},0);Object.fromEntries(Object.entries(ey).map(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,2)||function(e,t){if(e){if("string"==typeof e)return ed(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ed(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return[t[0],t[1]/em]}));var eh=n(15445),ev=n(52904).Buffer;function eg(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){n(e);return}c.done?t(u):Promise.resolve(u).then(r,a)}function e_(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){eg(o,r,a,i,c,"next",e)}function c(e){eg(o,r,a,i,c,"throw",e)}i(void 0)})}}function eb(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){var l=[c,u];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function ex(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return e_(function(){var r,a,o,i,c;return eb(this,function(u){switch(u.label){case 0:return r=performance.now(),[4,fetch(e)];case 1:if((a=u.sent()).status<200||a.status>299){if(!n)return[2,void 0];throw Error("Expected response status 2xx for ".concat(e,", got ").concat(a.status,": ").concat(a.statusText))}return[4,a.arrayBuffer()];case 2:if(o=u.sent(),"SearchIndex"===t&&ef("Took ".concat(performance.now()-r,"ms networking to load search index")),r=performance.now(),i=new Uint8Array((0,Q.gunzipSync)(ev.from(o))),"SearchIndex"===t&&ef("Took ".concat(performance.now()-r,"ms to decompress search index")),r=performance.now(),"Article"===t)return[2,eh.d2.decode(i)];if("Feature"===t)return[2,eh.L0.decode(i)];if("ArticleOrderingList"===t)return[2,eh.qF.decode(i)];else if("OrderLists"===t)return[2,eh.cK.decode(i)];else if("DataLists"===t)return[2,eh.Sh.decode(i)];else if("ConsolidatedShapes"===t)return[2,eh.wB.decode(i)];else if("SearchIndex"===t)return c=eh.WV.decode(i),ef("Took ".concat(performance.now()-r,"ms to decode search index")),[2,c];else if("QuizQuestionTronche"===t)return[2,eh.MB.decode(i)];else if("QuizFullData"===t)return[2,eh.dM.decode(i)];else if("CountsByArticleUniverseAndType"===t)return[2,eh.hy.decode(i)];else if("Symlinks"===t)return[2,eh.Kp.decode(i)];else if("PointSeries"===t)return[2,eh.oW.decode(i)];else if("ArticleUniverseList"===t)return[2,eh.$5.decode(i)];else throw Error("protobuf type not recognized (see load_json.ts)")}})})()}var ew=n(51859),eS=n(44640),ek=n(27193);function eA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eC(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){n(e);return}c.done?t(u):Promise.resolve(u).then(r,a)}function eI(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){eC(o,r,a,i,c,"next",e)}function c(e){eC(o,r,a,i,c,"throw",e)}i(void 0)})}}function eO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||eT(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eE(e){return function(e){if(Array.isArray(e))return eA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eT(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eT(e,t){if(e){if("string"==typeof e)return eA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eA(e,t)}}function ej(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){var l=[c,u];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var eN=function(e){var t=new Map,n=!0,r=!1,a=void 0;try{for(var o,c=i.Z[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var u=eO(o.value,2),l=u[0],s=u[1];t.set(l,s)}}catch(e){r=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}t.set("geoName",{type:{type:"vector",elementType:{type:"string"}},documentation:{humanReadableName:"Default Universe Geography Names",category:"mapper",longDescription:"A vector containing the names of geographic units for the current universe. Each element represents a geographic unit (e.g., census block, county) and can be used for labeling and identification purposes in mapping and spatial analysis.",includedInOutputContext:!0}}),t.set("geo",{type:{type:"vector",elementType:{type:"opaque",name:"geoFeatureHandle"}},documentation:{humanReadableName:"Default Universe Geography",category:"map",longDescription:"A vector containing geographic feature handles for the current universe. Each element represents a geographic unit (e.g., census block, county) that can be used for mapping and spatial analysis."}}),t.set("geoCentroid",{type:{type:"vector",elementType:{type:"opaque",name:"geoCentroidHandle"}},documentation:{humanReadableName:"Default Universe Geography (Centroids)",category:"mapper",longDescription:"A vector containing geographic centroid handles for the current universe. Each element represents the center point of a geographic unit, useful for point-based visualizations and distance calculations."}}),t.set("defaultInsets",{type:{type:"opaque",name:"insets"},documentation:{humanReadableName:"Default Insets",category:"mapper",longDescription:"Predefined map inset configurations for the current universe (whatever that is). E.g., for the US, it would be the continental US, Alaska, Hawaii, Puerto Rico, and Guam.",equivalentExpressions:void 0!==e?[(y=e,m=ew.Z[y].map(function(e){return e.name}).map(function(e){var t=eS.F6.get(e);return(0,h.h)(void 0!==t,"No inset constant for ".concat(e)),{type:"identifier",name:{node:t,location:ek.tU}}}),{type:"call",fn:{type:"identifier",name:{node:"constructInsets",location:ek.tU}},args:[{type:"unnamed",value:{type:"vectorLiteral",elements:m,entireLoc:ek.tU}}],entireLoc:ek.tU})]:[],selectorRendering:{kind:"subtitleLongDescription"}}});var p=!0,d=!1,f=void 0;try{for(var y,m,v,g=Y.Z.variableNames[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var _=v.value,b=_.order;t.set(_.varName,{type:{type:"vector",elementType:{type:"number"}},documentation:{humanReadableName:_.humanReadableName,priority:_.comesFromMultiSourceSet?1e3+b:b,category:"mapper",longDescription:"Data from ".concat(_.humanReadableName),documentationTable:"mapper-data-variables",includedInOutputContext:!0,fromStatisticColumn:!0}})}}catch(e){d=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(d)throw f}}var x=!0,w=!1,S=void 0;try{for(var k,A=Y.Z.multiSourceVariables[Symbol.iterator]();!(x=(k=A.next()).done);x=!0){var C,I=eO(k.value,2),O=I[0],E=I[1],T=E.individualVariables.map(function(e){var t=Y.Z.variableNames.find(function(t){return t.varName===e});return(0,h.h)(void 0!==t,"Variable info for ".concat(e," not found")),t.order}),j=(C=Math).min.apply(C,eE(T));t.set(O,{type:{type:"vector",elementType:{type:"number"}},documentation:{humanReadableName:E.humanReadableName,priority:j,category:"mapper",longDescription:"Data from ".concat(E.humanReadableName," (from whatever source is most reliable)"),documentationTable:"mapper-data-variables",isDefault:"density_pw_1km"===O,selectorRendering:{kind:"subtitleLongDescription"},includedInOutputContext:!0,fromStatisticColumn:!0}})}}catch(e){w=!0,S=e}finally{try{x||null==A.return||A.return()}finally{if(w)throw S}}return t},eM=n(20110);function eL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eU(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){n(e);return}c.done?t(u):Promise.resolve(u).then(r,a)}function eD(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){eU(o,r,a,i,c,"next",e)}function c(e){eU(o,r,a,i,c,"throw",e)}i(void 0)})}}function eB(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function eP(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw r}}return o}}(e,t)||eV(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eR(e){return function(e){if(Array.isArray(e))return eL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eV(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eV(e,t){if(e){if("string"==typeof e)return eL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eL(e,t)}}function ez(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){var l=[c,u];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}onmessage=function(e){return eD(function(){return ez(this,function(t){switch(t.label){case 0:var n;if(!("request"in e.data))return[2];return[4,(n=e.data.request,eD(function(){var e,t,a,o,c,u,l;return ez(this,function(s){switch(s.label){case 0:var p;return s.trys.push([0,2,,3]),[4,(p=n,eD(function(){var e,t;return ez(this,function(n){switch(n.label){case 0:switch(e=[],t=function(){return e.filter(function(e){return"warning"===e.type}).map(function(e){return{type:"error",value:e.message,location:e.location,kind:"warning"}})},p.descriptor.kind){case"generic":return[3,1];case"mapper":return[3,2]}return[3,4];case 1:return[2,[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return new m(function(t){void 0!==e&&e.push(t)},function(e,t){return new H(e,t)},i.Z,new Map)}(e),t]];case 2:var a,o;return[4,(a=p,o=e,eD(function(){var e,t,n,c,u,l;return ez(this,function(s){var p,d,f,y;switch(s.label){case 0:if(e=a.descriptor.geographyKind,n=eN(t=a.descriptor.universe),!$.includes(e))throw Error("invalid geography");if((null==r?void 0:r.geographyKind)!==e||r.universe!==t)return[3,1];return c=r.longnames,[3,3];case 1:return[4,ex((p=t,d=e,"/index/".concat(p,"/").concat(encodeURIComponent(ea(d,!1)),".gz")),"ArticleOrderingList")];case 2:c=s.sent().longnames,r={universe:t,geographyKind:e,longnames:c,dataCache:new Map},s.label=3;case 3:return u=function(e,t){var r=n.get(e);return(0,h.h)(void 0!==r,"Type info for ".concat(e," not found")),{type:r.type,documentation:r.documentation,value:t}},l=function(n){return eD(function(){var o,i,l,s,p;return ez(this,function(d){switch(d.label){case 0:var f,y,m,v;if((0,h.h)(void 0!==r,"mapperCache was initialized above and is never undefined after that"),"geoName"===n)return[2,u("geoName",c)];if("geo"===n)return[2,u("geo",c.map(function(e){return{type:"opaque",opaqueType:"geoFeatureHandle",value:e}}))];if("geoCentroid"===n)return[2,u("geoCentroid",c.map(function(e){return{type:"opaque",opaqueType:"geoCentroidHandle",value:e}}))];if("defaultInsets"===n)return[2,u("defaultInsets",{type:"opaque",opaqueType:"insets",value:(f=a.descriptor.universe,y=ew.Z[f],(0,h.h)(y.length>0,"No insets for universe ".concat(f)),(0,h.h)(y[0].mainMap,"No main map for universe ".concat(f)),y.map(function(e){return{bottomLeft:[e.bottomLeft[0],e.bottomLeft[1]],topRight:[e.topRight[0],e.topRight[1]],coordBox:eE(e.coordBox),mainMap:e.mainMap}}))})];if(!(o=Y.Z.variableNames.find(function(e){return e.varName===n})))return[2,void 0];if(i=o.index,void 0!==(l=r.dataCache.get(n)))return[2,u(n,l)];return s=X[i],[4,(m=t,v=e,e_(function(){var e,t,n,r,a,o,i;return eb(this,function(c){switch(c.label){case 0:return t=v in(e=ee)?function(e,t){var n=X.indexOf(t);if(-1===n)throw Error("statistic path not found: ".concat(t));for(var r=0,a=0;a<e.length;a++)if(n<(r+=e[a]))return a;throw Error("index not found")}(e[v],s):0,[4,ex("/order/".concat(encodeURIComponent(ea(v,!1)),"_").concat(t,"_data.gz"),"DataLists")];case 1:return r=(n=c.sent()).statnames.indexOf(s),a=n.dataLists[r],o=et.indexOf(m),[4,e_(function(){return eb(this,function(e){return[2,ex("/universes/".concat(v,".gz"),"ArticleUniverseList")]})})()];case 2:return i=c.sent(),[2,{value:a.value.filter(function(e,t){var n;return null==(n=i.universes[t].universeIdxs)?void 0:n.includes(o)}),populationPercentile:a.populationPercentileByUniverse.flatMap(function(e,t){var n=i.universes[t].universeIdxs.indexOf(o);return -1===n?[]:[a.populationPercentileByUniverse[t].populationPercentile[n]]})}]}})})())];case 1:return p=d.sent(),(0,h.h)(Array.isArray(p.value),"Expected variable data for ".concat(n," to be an array")),r.dataCache.set(n,p.value),[2,u(n,p.value)]}})})()},[4,(f=a.stmts,y=t,eI(function(){var e;return ej(this,function(t){switch(t.label){case 0:var n,r,a,c;return[4,(n=e=new m(function(e){o.push(e)},function(e,t){return new H(e,t)},i.Z,new Map),r=f,a=l,c=y,eI(function(){var e,t;return ej(this,function(o){switch(o.label){case 0:return e=eN(c),t=(0,W.gD)(r,n),[4,Promise.all(eE(Y.Z.variableNames.map(function(e){return e.varName})).concat(["geoName","geo","geoCentroid","defaultInsets"]).filter(function(e){return t.has(e)||"geoName"===e}).map(function(e){return eI(function(){var t;return ej(this,function(r){switch(r.label){case 0:return[4,a(e)];case 1:return void 0!==(t=r.sent())&&n.assignVariable(e,t),[2]}})})()}))];case 1:return o.sent(),[4,Promise.all(Y.Z.multiSourceVariables.filter(function(e){var n=eO(e,1)[0];return t.has(n)}).map(function(t){var r=eO(t,2),o=r[0],i=r[1];return eI(function(){var t,r,c,u,l,s,p,d,f,y,m,h,v;return ej(this,function(g){switch(g.label){case 0:t=i.individualVariables,r=[],c=!0,u=!1,l=void 0;try{for(s=t[Symbol.iterator]();!(c=(p=s.next()).done);c=!0)d=p.value,f=n.getVariable(d),void 0!==f?r.push(Promise.resolve(f)):r.push(a(d))}catch(e){u=!0,l=e}finally{try{c||null==s.return||s.return()}finally{if(u)throw l}}return[4,Promise.all(r)];case 1:if((y=g.sent().map(function(e){return null==e?void 0:e.value})).some(function(e){return void 0===e}))return[2];return h=(m=y)[0].map(function(e,t){return function(e){var t=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value;if(!isNaN(i))return i}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return NaN}(m.map(function(e){return e[t]}))}),v=e.get(o),n.assignVariable(o,{type:v.type,value:h,documentation:v.documentation}),[2]}})})()}))];case 2:return o.sent(),[2]}})})())];case 1:return t.sent(),[2,e]}})})())];case 4:return[2,s.sent()]}})})())];case 3:return[2,[n.sent(),t]];case 4:return[2]}})})())];case 1:switch(e=(a=eP.apply(void 0,[s.sent(),2]))[0],t=a[1],o=K(n.stmts,e),n.descriptor.kind){case"generic":break;case"mapper":if("cMap"!==(0,g.wB)(o.type)&&"cMapRGB"!==(0,g.wB)(o.type)&&"pMap"!==(0,g.wB)(o.type))throw new H("USS expression did not return a cMap, cMapRGB, or pMap type, got: ".concat((0,g.wB)(o.type)),(0,v._x)(n.stmts))}return[2,{resultingValue:{type:o.type,value:function e(t){return eB(t,Function)?null:Array.isArray(t)?t.map(e):eB(t,Map)?new Map(Array.from(t.entries()).map(function(t){var n=eP(t,2);return[n[0],e(n[1])]})):eB(t,Object)&&eB(t.value,Function)?((0,h.h)("scale"===t.opaqueType,"only scales can have functions in their value"),null):t}(o.value)},error:t(),context:new Map(eR(e.variableEntries()).filter(function(e){var t;return null==(t=eP(e,2)[1].documentation)?void 0:t.includedInOutputContext}))}];case 2:return eB(c=s.sent(),H)?u=c:(eM.error("Unknown interpretation error",c),u=new H("Unknown interpretation error",ek.tU)),[2,{error:[{type:"error",value:u.value,location:u.location,kind:"error"}].concat(eR(null!=(l=null==t?void 0:t())?l:[])),context:new Map}];case 3:return[2]}})})())];case 1:return postMessage({result:t.sent(),id:e.data.id}),[2]}})})()}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.x=()=>{var e=n.O(void 0,["597","90","879","680","257","427"],function(){return n(66011)});return n.O(e)},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>""+e+".js",n.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e=[];n.O=(t,r,a,o)=>{if(r){o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[r,a,o];return}for(var c=1/0,i=0;i<e.length;i++){for(var[r,a,o]=e[i],u=!0,l=0;l<r.length;l++)(!1&o||c>=o)&&Object.keys(n.O).every(e=>n.O[e](r[l]))?r.splice(l--,1):(u=!1,o<c&&(c=o));if(u){e.splice(i--,1);var s=a();void 0!==s&&(t=s)}}return t}})(),n.rv=()=>"1.3.15",(()=>{var e=n.x;n.x=()=>Promise.all(["597","90","879","680","257","427"].map(n.e,n)).then(e)})(),(()=>{n.g.importScripts&&(e=n.g.location+"");var e,t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw Error("Automatic publicPath is not supported in this browser");n.p=e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/")})(),(()=>{var e={438:1};n.f.i=(t,r)=>{e[t]||importScripts(n.p+n.u(t))};var t=self.webpackChunkassets=self.webpackChunkassets||[],r=t.push.bind(t);t.push=t=>{var[a,o,i]=t;for(var c in o)n.o(o,c)&&(n.m[c]=o[c]);for(i&&i(n);a.length;)e[a.pop()]=1;r(t)}})(),n.ruid="bundler=rspack@1.3.15",n.x()})();
//# sourceMappingURL=sharedUSSWorker.js.map