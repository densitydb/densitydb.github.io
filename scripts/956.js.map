{"version":3,"file":"956.js","sources":["webpack://assets/./src/mapper/context.ts","webpack://assets/./src/urban-stats-script/Editor.tsx","webpack://assets/./src/urban-stats-script/StandaloneEditor.tsx","webpack://assets/./src/urban-stats-script/constants/scale.ts","webpack://assets/./src/urban-stats-script/workerManager.ts","webpack://assets/./src/uss-documentation.tsx"],"sourcesContent":["import insets from '../data/insets'\nimport statistic_variables_info from '../data/statistic_variables_info'\nimport { Universe } from '../universe'\nimport { UrbanStatsASTExpression, UrbanStatsASTStatement } from '../urban-stats-script/ast'\nimport { defaultConstants } from '../urban-stats-script/constants/constants'\nimport { Inset, insetNameToConstantName } from '../urban-stats-script/constants/insets'\nimport { Context } from '../urban-stats-script/context'\nimport { Effect, InterpretationError } from '../urban-stats-script/interpreter'\nimport { noLocation } from '../urban-stats-script/location'\nimport { allIdentifiers } from '../urban-stats-script/parser'\nimport { TypeEnvironment, USSValue } from '../urban-stats-script/types-values'\nimport { assert } from '../utils/defensive'\nimport { firstNonNan } from '../utils/math'\n\nexport async function mapperContext(stmts: UrbanStatsASTStatement, getVariable: (name: string) => Promise<USSValue | undefined>, effects: Effect[], universe: Universe): Promise<Context> {\n    const ctx = new Context(\n        (eff) => { effects.push(eff) },\n        (msg, loc) => { return new InterpretationError(msg, loc) },\n        defaultConstants,\n        new Map(),\n    )\n\n    await addVariablesToContext(ctx, stmts, getVariable, universe)\n    return ctx\n}\n\nasync function addVariablesToContext(ctx: Context, stmts: UrbanStatsASTStatement, getVariable: (name: string) => Promise<USSValue | undefined>, universe: Universe): Promise<void> {\n    const dte = defaultTypeEnvironment(universe)\n    const ids = allIdentifiers(stmts, ctx)\n\n    const variables = [...statistic_variables_info.variableNames.map(v => v.varName), 'geoName', 'geo', 'geoCentroid', 'defaultInsets']\n\n    // Some variables are always loaded, regardless of whether they are used in the statements\n    // This is helpful for some operations, such as CSV export\n    const forceName = (name: string): boolean => name === 'geoName'\n\n    // Load all variables in parallel\n    const variablePromises = variables\n        .filter(name => ids.has(name) || forceName(name))\n        .map(async (name) => {\n            const va = await getVariable(name)\n            if (va !== undefined) {\n                ctx.assignVariable(name, va)\n            }\n        })\n\n    await Promise.all(variablePromises)\n\n    // Handle multi-source variables in parallel\n    const multiSourcePromises = statistic_variables_info.multiSourceVariables\n        .filter(([name]) => ids.has(name))\n        .map(async ([name, info]) => {\n            const subvars = info.individualVariables\n            const vsPromise: Promise<USSValue | undefined>[] = []\n            for (const subvar of subvars) {\n                const existing = ctx.getVariable(subvar)\n                if (existing !== undefined) {\n                    vsPromise.push(Promise.resolve(existing))\n                }\n                else {\n                    vsPromise.push(getVariable(subvar))\n                }\n            }\n            const vs = await Promise.all(vsPromise)\n            const values = vs.map(v => v?.value as (undefined | number[]))\n            if (values.some(v => v === undefined)) {\n                return\n            }\n            const valuesNotNull = values as number[][] // cast is fine because we checked for undefined above\n            const value = valuesNotNull[0].map((_, i) => firstNonNan(valuesNotNull.map(v => v[i]))) // take first non-NaN value\n\n            const typeInfo = dte.get(name)!\n            ctx.assignVariable(name, {\n                type: typeInfo.type,\n                value,\n                documentation: typeInfo.documentation,\n            })\n        })\n\n    await Promise.all(multiSourcePromises)\n}\n\nexport const defaultTypeEnvironment = (universe: Universe | undefined): TypeEnvironment => {\n    const te: TypeEnvironment = new Map()\n\n    for (const [key, value] of defaultConstants) {\n        te.set(key, value)\n    }\n\n    te.set('geoName', {\n        type: { type: 'vector', elementType: { type: 'string' } },\n        documentation: {\n            humanReadableName: 'Default Universe Geography Names',\n            category: 'mapper',\n            longDescription: 'A vector containing the names of geographic units for the current universe. Each element represents a geographic unit (e.g., census block, county) and can be used for labeling and identification purposes in mapping and spatial analysis.',\n            includedInOutputContext: true,\n        },\n    })\n\n    te.set('geo', {\n        type: { type: 'vector', elementType: { type: 'opaque', name: 'geoFeatureHandle' } },\n        documentation: {\n            humanReadableName: 'Default Universe Geography',\n            category: 'map',\n            longDescription: 'A vector containing geographic feature handles for the current universe. Each element represents a geographic unit (e.g., census block, county) that can be used for mapping and spatial analysis.',\n        },\n    })\n\n    te.set('geoCentroid', {\n        type: { type: 'vector', elementType: { type: 'opaque', name: 'geoCentroidHandle' } },\n        documentation: {\n            humanReadableName: 'Default Universe Geography (Centroids)',\n            category: 'mapper',\n            longDescription: 'A vector containing geographic centroid handles for the current universe. Each element represents the center point of a geographic unit, useful for point-based visualizations and distance calculations.',\n        },\n    })\n\n    te.set('defaultInsets', {\n        type: { type: 'opaque', name: 'insets' },\n        documentation: {\n            humanReadableName: 'Default Insets',\n            category: 'mapper',\n            longDescription: 'Predefined map inset configurations for the current universe (whatever that is). E.g., for the US, it would be the continental US, Alaska, Hawaii, Puerto Rico, and Guam.',\n            equivalentExpressions: universe !== undefined ? [loadInsetExpression(universe)] : [],\n            selectorRendering: { kind: 'subtitleLongDescription' },\n        },\n    })\n\n    for (const variableInfo of statistic_variables_info.variableNames) {\n        const order = variableInfo.order\n        te.set(variableInfo.varName, {\n            type: { type: 'vector', elementType: { type: 'number' } },\n            documentation: {\n                humanReadableName: variableInfo.humanReadableName,\n                priority: variableInfo.comesFromMultiSourceSet ? 1000 + order : order,\n                category: 'mapper',\n                longDescription: `Data from ${variableInfo.humanReadableName}`,\n                documentationTable: 'mapper-data-variables',\n                includedInOutputContext: true,\n                fromStatisticColumn: true,\n            },\n        })\n    }\n    for (const [name, info] of statistic_variables_info.multiSourceVariables) {\n        // Find the minimum priority of the individual variables (using raw order values)\n        const individualPriorities = info.individualVariables.map((varName) => {\n            const variableInfo = statistic_variables_info.variableNames.find(v => v.varName === varName)\n            assert(variableInfo !== undefined, `Variable info for ${varName} not found`)\n            return variableInfo.order\n        })\n        const minPriority = Math.min(...individualPriorities)\n\n        te.set(name, {\n            type: { type: 'vector', elementType: { type: 'number' } },\n            documentation: {\n                humanReadableName: info.humanReadableName,\n                priority: minPriority,\n                category: 'mapper',\n                longDescription: `Data from ${info.humanReadableName} (from whatever source is most reliable)`,\n                documentationTable: 'mapper-data-variables',\n                isDefault: name === 'density_pw_1km',\n                selectorRendering: { kind: 'subtitleLongDescription' },\n                includedInOutputContext: true,\n                fromStatisticColumn: true,\n            },\n        })\n    }\n\n    return te\n}\n\nexport function loadInsets(universe: Universe): Inset[] {\n    const insetsU = insets[universe]\n    assert(insetsU.length > 0, `No insets for universe ${universe}`)\n    assert(insetsU[0].mainMap, `No main map for universe ${universe}`)\n    const insetsProc = insetsU.map((inset) => {\n        return {\n            bottomLeft: [inset.bottomLeft[0], inset.bottomLeft[1]],\n            topRight: [inset.topRight[0], inset.topRight[1]],\n            // copy to get rid of readonly\n            coordBox: [...inset.coordBox],\n            mainMap: inset.mainMap,\n        } satisfies Inset\n    })\n    return insetsProc\n}\n\nexport function loadInsetExpression(universe: Universe): UrbanStatsASTExpression {\n    const insetsU = insets[universe]\n    const names = insetsU.map(x => x.name)\n\n    const exprs = names.map((name) => {\n        const expr = insetNameToConstantName.get(name)\n        assert(expr !== undefined, `No inset constant for ${name}`)\n        return { type: 'identifier', name: { node: expr, location: noLocation } } satisfies UrbanStatsASTExpression\n    })\n\n    return {\n        type: 'call',\n        fn: { type: 'identifier', name: { node: 'constructInsets', location: noLocation } },\n        args: [{\n            type: 'unnamed',\n            value: {\n                type: 'vectorLiteral',\n                elements: exprs,\n                entireLoc: noLocation,\n            } satisfies UrbanStatsASTExpression,\n        }],\n        entireLoc: noLocation,\n    } satisfies UrbanStatsASTExpression\n}\n","import '@fontsource/inconsolata/500.css'\n\nimport React, { CSSProperties, ReactNode, useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { createPortal } from 'react-dom'\n\nimport { totalOffset } from '../components/screenshot'\nimport { Colors } from '../page_template/color-themes'\nimport { useColors } from '../page_template/colors'\nimport { LongFormDocumentation, linkContext } from '../uss-documentation'\nimport { TestUtils } from '../utils/TestUtils'\n\nimport { renderCode, getRange, nodeContent, Range, setRange, EditorResult, longMessage, Script, makeScript, getAutocompleteOptions, createAutocompleteMenu, createPlaceholder, createDocumentationPopover } from './editor-utils'\nimport { AnnotatedToken } from './lexer'\nimport { LocInfo } from './location'\nimport { TypeEnvironment, USSDocumentedType } from './types-values'\n\ninterface AutocompleteState {\n    kind: 'autocomplete'\n    location: LocInfo\n    options: string[]\n    element: HTMLElement\n    apply: (optionIdx: number) => void\n}\n\ninterface DocumentationState {\n    kind: 'documentation'\n    location: LocInfo\n    name: string\n    value: USSDocumentedType\n    element: HTMLElement\n}\n\ntype PopoverState = AutocompleteState | DocumentationState | undefined\n\nexport function Editor(\n    { uss, setUss, typeEnvironment, results, placeholder, selection, setSelection, eRef }: {\n        uss: string\n        setUss: (newScript: string) => void\n        typeEnvironment: TypeEnvironment\n        results: EditorResult[]\n        placeholder?: string\n        selection: Range | null\n        setSelection: (newRange: Range | null) => void\n        eRef?: React.MutableRefObject<HTMLPreElement | null>\n    },\n): ReactNode {\n    const setSelectionRef = useRef(setSelection)\n    setSelectionRef.current = setSelection\n\n    const script = useMemo(() => makeScript(uss), [uss])\n\n    const colors = useColors()\n\n    const editorRef = useRef<HTMLPreElement | null>(null)\n\n    const [popoverState, setPopoverState] = useState<PopoverState>(undefined)\n    const [autocompleteSelectionIdx, setAutocompleteSelectionIdx] = useState(0)\n\n    const spanTokenMapRef = useRef<Map<Element, AnnotatedToken>>(new Map())\n\n    const renderScript = useCallback((newScript: Script) => {\n        spanTokenMapRef.current.clear()\n\n        const fragment = renderCode(\n            newScript, colors, results.filter(r => r.kind !== 'success'),\n            (token, content) => {\n                if (popoverState?.location.end.charIdx === token.location.end.charIdx && token.token.type === 'identifier') {\n                    if (popoverState.kind === 'documentation') {\n                        // put the text node in a span that has a background so we hightlight the token we're popovering\n                        const text = content[0]\n                        const span = document.createElement('span')\n                        span.appendChild(text)\n                        span.style.backgroundColor = colors.slightlyDifferentBackgroundFocused\n                        content[0] = span\n                    }\n\n                    content.push(popoverState.element)\n                }\n                if (placeholder !== undefined && newScript.tokens.every(t => t.token.type === 'operator' && t.token.value === 'EOL') && token.location.end.charIdx === 0) {\n                    content.push(createPlaceholder(colors, placeholder))\n                }\n            },\n            (token, span) => {\n                spanTokenMapRef.current.set(span, token)\n            },\n        )\n\n        const editor = editorRef.current!\n        editor.replaceChildren(...fragment)\n        // Usually you want to set the selection after this, since it has been reset\n    }, [colors, results, popoverState, placeholder])\n\n    const lastRenderScript = useRef<typeof renderScript>(renderScript)\n    const lastScript = useRef<Script | undefined>(undefined)\n\n    useEffect(() => {\n        const editor = editorRef.current!\n\n        // Rerendering when just a selection change happens causes the selection interaction to be interrupted\n        if (script !== lastScript.current || renderScript !== lastRenderScript.current) {\n            renderScript(script)\n        }\n        setRange(editor, selection)\n\n        lastRenderScript.current = renderScript\n        lastScript.current = script\n    }, [renderScript, script, selection])\n\n    const editScript = useCallback((newUss: string, newRange: Range) => {\n        const newScript = makeScript(newUss)\n        renderScript(newScript)\n        setRange(editorRef.current!, newRange)\n        setUss(newScript.uss)\n        setSelection(newRange)\n        setPopoverState(undefined)\n    }, [renderScript, setUss, setSelection])\n\n    useEffect(() => {\n        const listener = (): void => {\n            // These events are often spurious\n\n            const range = getRange(editorRef.current!)\n            setSelectionRef.current(range)\n            // Cancel autocomplete if the selection is no longer at the end\n            setPopoverState(s => s?.kind === 'autocomplete' && (s.location.end.charIdx !== range?.start || s.location.end.charIdx !== range.end) ? undefined : s)\n        }\n        document.addEventListener('selectionchange', listener)\n        return () => {\n            document.removeEventListener('selectionchange', listener)\n        }\n    }, []) // Rebinding can cause problems with multiple editors as they stop listening when one editor changes selection\n\n    useEffect(() => {\n        const editor = editorRef.current!\n        const listener = (): void => {\n            const range = getRange(editor)\n            const newScript = makeScript(nodeContent(editor))\n            const token = range !== null && range.start === range.end\n                ? newScript.tokens.find(t => t.token.type === 'identifier' && t.location.end.charIdx === range.start)\n                : undefined\n            if (token !== undefined) {\n                const tokenValue = token.token.value as string\n                const options = getAutocompleteOptions(typeEnvironment, newScript.tokens, tokenValue)\n                if (options.length === 0) {\n                    setPopoverState(undefined)\n                }\n                else {\n                    setPopoverState({\n                        kind: 'autocomplete',\n                        location: token.location,\n                        options,\n                        element: createAutocompleteMenu(colors),\n                        apply(optionIdx) {\n                            const option = options[optionIdx]\n                            const delta = option.length - tokenValue.length\n                            const editedUss = newScript.uss.slice(0, token.location.start.charIdx) + option + newScript.uss.slice(token.location.end.charIdx)\n                            const editedRange = { start: token.location.end.charIdx + delta, end: token.location.end.charIdx + delta }\n                            editScript(editedUss, editedRange)\n                        },\n                    })\n                    setAutocompleteSelectionIdx(0)\n                }\n            }\n            else {\n                setPopoverState(undefined)\n            }\n            setUss(newScript.uss)\n            setSelection(range)\n        }\n        editor.addEventListener('input', listener)\n        return () => { editor.removeEventListener('input', listener) }\n    }, [typeEnvironment, colors, editScript, setUss, setSelection])\n\n    useEffect(() => {\n        const editor = editorRef.current!\n        const listener = (e: KeyboardEvent): void => {\n            if (popoverState?.kind === 'autocomplete') {\n                switch (e.key) {\n                    case 'Enter':\n                    case 'Tab':\n                        e.preventDefault()\n                        popoverState.apply(autocompleteSelectionIdx)\n                        return\n                    case 'Escape':\n                        e.preventDefault()\n                        setPopoverState(undefined)\n                        return\n                    case 'ArrowDown':\n                    case 'ArrowUp':\n                        e.preventDefault()\n                        if (e.key === 'ArrowDown') {\n                            setAutocompleteSelectionIdx(i => i + 1 >= popoverState.options.length ? 0 : i + 1)\n                        }\n                        else {\n                            setAutocompleteSelectionIdx(i => i - 1 < 0 ? popoverState.options.length - 1 : i - 1)\n                        }\n                        return\n                }\n            }\n\n            if (e.key === 'Tab') {\n                e.preventDefault()\n                const range = getRange(editor)\n                if (range !== null) {\n                    editScript(\n                        `${script.uss.slice(0, range.start)}    ${script.uss.slice(range.end)}`,\n                        { start: range.start + 4, end: range.start + 4 },\n                    )\n                }\n            }\n            else if (e.key === 'Backspace') {\n                const range = getRange(editor)\n                if (range !== null && range.start === range.end && range.start >= 4 && script.uss.slice(range.start - 4, range.start) === '    ') {\n                    e.preventDefault()\n                    editScript(\n                        `${script.uss.slice(0, range.start - 4)}${script.uss.slice(range.start)}`,\n                        { start: range.start - 4, end: range.start - 4 },\n                    )\n                }\n            }\n        }\n        editor.addEventListener('keydown', listener)\n        return () => { editor.removeEventListener('keydown', listener) }\n    }, [script, renderScript, popoverState, autocompleteSelectionIdx, editScript])\n\n    useEffect(() => {\n        const editor = editorRef.current!\n        const listener = (): void => {\n            setPopoverState(undefined)\n        }\n        editor.addEventListener('blur', listener)\n        return () => { editor.removeEventListener('blur', listener) }\n    }, [])\n\n    useEffect(() => {\n        let hoveredToken: AnnotatedToken | undefined\n        const listener = (event: MouseEvent): void => {\n            for (const elem of document.elementsFromPoint(event.clientX, event.clientY)) {\n                let token: AnnotatedToken | undefined, name, value\n                if ((token = spanTokenMapRef.current.get(elem)) !== undefined && token.token.type === 'identifier' && (name = token.token.value) && (value = typeEnvironment.get(name)) !== undefined) {\n                    hoveredToken = token\n                    const opts = {\n                        location: token.location,\n                        name,\n                        value,\n                    }\n                    const elemOffset = totalOffset(elem).left\n                    setTimeout(() => {\n                        if (hoveredToken === token) {\n                            setPopoverState({\n                                kind: 'documentation',\n                                ...opts,\n                                element: createDocumentationPopover(colors, editorRef.current!, elemOffset),\n                            })\n                        }\n                    }, 500)\n                    return\n                }\n                if (popoverState?.kind === 'documentation' && popoverState.element === elem) {\n                    hoveredToken = undefined\n                    return\n                }\n            }\n            hoveredToken = undefined\n            if (popoverState?.kind === 'documentation') {\n                setPopoverState(undefined)\n            }\n        }\n        document.addEventListener('mousemove', listener)\n        return () => { document.removeEventListener('mousemove', listener) }\n    }, [colors, typeEnvironment, popoverState])\n\n    const borderColor = useResultsColor(colorKey(results))\n\n    return (\n        <div style={{ marginTop: '0.25em' }}>\n            <pre\n                id=\"test-editor-body\"\n                style={{\n                    ...codeStyle(colors),\n                    caretColor: TestUtils.shared.isTesting ? 'transparent' : colors.textMain,\n                    border: `1px solid ${borderColor}`,\n                    borderRadius: TestUtils.shared.isTesting ? 0 : (results.length > 0 ? '5px 5px 0 0' : '5px'),\n                }}\n                ref={(e) => {\n                    editorRef.current = e\n                    if (eRef !== undefined) {\n                        eRef.current = e\n                    }\n                }}\n                contentEditable=\"plaintext-only\"\n                spellCheck=\"false\"\n            />\n            <DisplayResults results={results} editor={true} />\n            {popoverState === undefined\n                ? null\n                : createPortal(\n                    popoverState.kind === 'autocomplete'\n                        ? (\n                                <Autocomplete\n                                    state={popoverState}\n                                    selectionIdx={autocompleteSelectionIdx}\n                                    setSelectionIdx={setAutocompleteSelectionIdx}\n                                    apply={(i) => { popoverState.apply(i) }}\n                                />\n                            )\n                        : (\n                                <linkContext.Provider value=\"link\">\n                                    <LongFormDocumentation name={popoverState.name} value={popoverState.value} />\n                                </linkContext.Provider>\n                            ),\n                    popoverState.element,\n                )}\n        </div>\n    )\n}\n\nexport function codeStyle(colors: Colors): CSSProperties {\n    return {\n        whiteSpace: 'pre-wrap',\n        fontFamily: 'Inconsolata, monospace',\n        fontWeight: 500,\n        lineHeight: '175%',\n        margin: 0,\n        padding: '1em',\n        backgroundColor: colors.background,\n    }\n}\n\nfunction colorKey(results: EditorResult[]): 'r' | 'o' | 'g' | 's' {\n    switch (true) {\n        case results.some(r => r.kind === 'error'):\n            return 'r'\n        case results.some(r => r.kind === 'warning'):\n            return 'o'\n        case results.some(r => r.kind === 'success'):\n            return 'g'\n        default:\n            return 's'\n    }\n}\n\nfunction useResultsColor(cKey: 'r' | 'o' | 'g' | 's'): string {\n    const colors = useColors()\n    switch (cKey) {\n        case 'r':\n            return colors.hueColors.red\n        case 'o':\n            return colors.hueColors.orange\n        case 'g':\n            return colors.hueColors.green\n        case 's':\n            return colors.borderShadow\n    }\n}\n\nexport function DisplayResults(props: { results: EditorResult[], editor: boolean }): ReactNode | undefined {\n    const colors = useColors()\n    const cKey = colorKey(props.results)\n    const color = useResultsColor(cKey)\n    if (props.results.length === 0) {\n        return undefined\n    }\n    const border = `2px solid ${color}`\n    const style = {\n        ...codeStyle(colors),\n        borderRadius: TestUtils.shared.isTesting ? 0 : (props.editor ? '0 0 5px 5px' : '5px'),\n        backgroundColor: colors.slightlyDifferentBackground,\n        color: colors.textMain,\n        borderTop: props.editor ? 'none' : border,\n        borderRight: border,\n        borderBottom: border,\n        borderLeft: border,\n        marginTop: props.editor ? '0' : '0.25em',\n    }\n    return (\n        <div id=\"test-editor-result\" className={`color-${cKey}`}>\n            <pre style={style}>\n                {props.results.map((error, _, errors) => `${errors.length > 1 ? '- ' : ''}${longMessage(error, props.editor)}`).join('\\n')}\n            </pre>\n        </div>\n    )\n}\n\nfunction Autocomplete(props: { state: Exclude<AutocompleteState, undefined>, selectionIdx: number, setSelectionIdx: (idx: number) => void, apply: (idx: number) => void }): ReactNode {\n    return props.state.options.map((option, index) => (\n        <AutocompleteOption\n            key={option}\n            option={option}\n            index={index}\n            selected={index === props.selectionIdx}\n            apply={() => { props.apply(index) }}\n        />\n    ))\n}\n\nfunction AutocompleteOption(props: { option: string, index: number, selected: boolean, apply: () => void }): ReactNode {\n    const colors = useColors()\n    const [hovering, setHovering] = useState(false)\n    const style: CSSProperties = {\n        cursor: 'pointer',\n        backgroundColor: (props.selected || hovering\n            ? colors.slightlyDifferentBackgroundFocused\n            : props.index % 2 === 0 ? colors.background : colors.slightlyDifferentBackground),\n        padding: '0 0.5em',\n    }\n\n    const optionRef = useRef<HTMLDivElement>(null)\n\n    useEffect(() => {\n        optionRef.current?.scrollIntoView({ block: 'nearest' })\n    }, [props.selected])\n\n    return (\n        <div\n            ref={optionRef}\n            style={style}\n            onMouseEnter={() => { setHovering(true) }}\n            onMouseLeave={() => { setHovering(false) }}\n            onClick={props.apply}\n        >\n            {props.option}\n        </div>\n    )\n}\n","/**\n * Typically an Editor is connected to another system (e.g. the mapper) that manages its state.\n * This Editor mostly manages its own state, and presents its own result.\n */\n\nimport React, { ReactNode, useEffect, useRef, useState } from 'react'\n\nimport { Editor } from './Editor'\nimport { defaultConstants } from './constants/constants'\nimport { EditorResult, Range, UndoRedoOptions, useUndoRedo } from './editor-utils'\nimport { parse } from './parser'\nimport { TypeEnvironment } from './types-values'\nimport { executeAsync } from './workerManager'\n\nexport function StandaloneEditor(props: { ident: string, getCode: () => string, onChange?: (code: string) => void }): ReactNode {\n    const editorRef = useRef<HTMLPreElement | null>(null)\n\n    const { uss, setUss, typeEnvironment, results, selection, setSelection, undoRedoUi } = useStandaloneEditorState<Range | null>({\n        ...props,\n        getSelection: () => null,\n        undoRedoOptions: { onlyElement: editorRef },\n    })\n\n    return (\n        <div id=\"test-editor-panel\">\n            <Editor\n                uss={uss}\n                setUss={setUss}\n                typeEnvironment={typeEnvironment}\n                results={results}\n                placeholder=\"Enter Urban Stats Script\"\n                selection={selection}\n                setSelection={setSelection}\n                eRef={editorRef}\n            />\n            {undoRedoUi}\n        </div>\n    )\n}\n\nexport function useStandaloneEditorState<Selection>({ ident, getCode, onChange, getSelection, undoRedoOptions }: {\n    ident: string\n    getCode: () => string\n    onChange?: (code: string) => void\n    getSelection: () => Selection\n    undoRedoOptions: UndoRedoOptions\n}): {\n        uss: string\n        setUss: (newUss: string) => void\n        typeEnvironment: TypeEnvironment\n        results: EditorResult[]\n        selection: Selection\n        setSelection: (newSelection: Selection) => void\n        undoRedoUi: ReactNode\n    } {\n    const [results, setResults] = useState<EditorResult[]>([])\n\n    const [uss, setUss] = useState(getCode)\n    const ussVersion = useRef(0)\n\n    const [selection, setSelection] = useState<Selection>(getSelection)\n\n    const updateUss = async (newScript: string): Promise<void> => {\n        setUss(newScript)\n        const version = ++ussVersion.current\n        onChange?.(newScript)\n\n        const stmts = parse(newScript, { type: 'single', ident })\n\n        if (stmts.type === 'error') {\n            setResults(stmts.errors.map(e => ({ ...e, kind: 'error' })))\n            return\n        }\n\n        const exec = await executeAsync({ descriptor: { kind: 'generic' }, stmts })\n\n        if (version === ussVersion.current) {\n            // avoid race conditions\n            setResults([\n                ...(exec.resultingValue !== undefined ? [{ kind: 'success' as const, result: exec.resultingValue }] : []),\n                ...exec.error,\n            ])\n        }\n    }\n\n    const { addState, updateCurrentSelection, ui: undoRedoUi } = useUndoRedo(\n        uss,\n        selection,\n        updateUss,\n        setSelection,\n        undoRedoOptions,\n    )\n\n    useEffect(\n        () => {\n            void updateUss(getCode())\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps -- run once at beginning\n        [],\n    )\n\n    const typeEnvironment = defaultConstants as TypeEnvironment\n\n    return {\n        uss,\n        setUss: (newUss) => {\n            void updateUss(newUss)\n            addState(newUss, selection)\n        },\n        setSelection: (newSelection) => {\n            setSelection(newSelection)\n            updateCurrentSelection(newSelection)\n        },\n        typeEnvironment,\n        selection,\n        results,\n        undoRedoUi,\n    }\n}\n","import { USSType, USSValue, createConstantExpression } from '../types-values'\n\n// Functions can't be send over the worker boundary, so instead we must send descriptors\nexport interface LinearScaleDescriptor { kind: 'linear', min: number, max: number }\n\nexport type ScaleDescriptor =\n    LinearScaleDescriptor |\n    { kind: 'log', linearScale: LinearScaleDescriptor }\nexport type Scale = (values: number[], min?: number, max?: number, center?: number) => ScaleDescriptor\n\nexport interface ScaleInstance {\n    forward: (value: number) => number\n    inverse: (value: number) => number\n}\n\nexport const scaleType = {\n    type: 'opaque',\n    name: 'scale',\n} satisfies USSType\n\nexport function instantiate(descriptor: ScaleDescriptor): ScaleInstance {\n    switch (descriptor.kind) {\n        case 'linear':\n            const { min, max } = descriptor\n            if (min === max) {\n                // just arbitrarily map min <=> 0.5\n                return {\n                    forward: x => 0.5 + x - min,\n                    inverse: x => x - 0.5 + min,\n                }\n            }\n            const range = max - min\n\n            return {\n                forward: (value: number) => (value - min) / range,\n                inverse: (value: number) => value * range + min,\n            }\n        case 'log':\n            const { forward, inverse } = instantiate(descriptor.linearScale)\n            return {\n                forward: (value: number) => forward(Math.log(value)),\n                inverse: (value: number) => Math.exp(inverse(value)),\n            }\n    }\n}\n\nconst linearScale: Scale = (values: number[], min?: number, max?: number, center?: number) => {\n    values = values.filter(value => typeof value === 'number' && !isNaN(value) && isFinite(value))\n\n    let computedMin = min ?? Math.min(...values)\n    let computedMax = max ?? Math.max(...values)\n\n    if (center !== undefined) {\n        if (min !== undefined && max !== undefined) {\n            if (Math.abs(center - (min + max) / 2) > 1e-10) {\n                throw new Error(`Inconsistent parameters: center ${center} does not equal (min + max) / 2 = ${min + max} / 2`)\n            }\n        }\n        else if (min !== undefined) {\n            computedMax = 2 * center - min\n        }\n        else if (max !== undefined) {\n            computedMin = 2 * center - max\n        }\n        else {\n            const range = Math.max(computedMax - center, center - computedMin)\n            computedMin = center - range\n            computedMax = center + range\n        }\n    }\n    return {\n        kind: 'linear',\n        min: computedMin,\n        max: computedMax,\n    }\n}\n\nconst logScale: Scale = (values: number[], min?: number, max?: number, center?: number) => {\n    const logVals = values.map(Math.log)\n    const logMin = min !== undefined ? Math.log(min) : undefined\n    const logMax = max !== undefined ? Math.log(max) : undefined\n    const logCenter = center !== undefined ? Math.log(center) : undefined\n    const linearScaleDescriptor = linearScale(logVals, logMin, logMax, logCenter) as LinearScaleDescriptor\n    return {\n        kind: 'log',\n        linearScale: linearScaleDescriptor,\n    }\n}\n\nexport const linearScaleValue: USSValue = {\n    type: {\n        type: 'function',\n        posArgs: [],\n        namedArgs: {\n            min: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n            center: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n            max: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n        },\n        returnType: { type: 'concrete', value: scaleType },\n    },\n    value: (ctx, posArgs, namedArgs) => {\n        const min = namedArgs.min as number | null | undefined\n        const max = namedArgs.max as number | null | undefined\n        const center = namedArgs.center as number | null | undefined\n        // Return a scale function that closes over these params\n        return {\n            type: 'opaque',\n            opaqueType: 'scale',\n            value: (values: number[]) => linearScale(values, min ?? undefined, max ?? undefined, center ?? undefined),\n        }\n    },\n    documentation: {\n        humanReadableName: 'Linear Scale',\n        category: 'scale',\n        isDefault: true,\n        longDescription: 'Creates a linear scale that maps numeric values to a range. If min/max are not specified, they are computed from the data. Center parameter can be used to create symmetric ranges.',\n        selectorRendering: { kind: 'subtitleLongDescription' },\n    },\n} satisfies USSValue\n\nexport const logScaleValue: USSValue = {\n    type: {\n        type: 'function',\n        posArgs: [],\n        namedArgs: {\n            min: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n            center: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n            max: {\n                type: { type: 'concrete', value: { type: 'number' } },\n                defaultValue: createConstantExpression(null),\n            },\n        },\n        returnType: { type: 'concrete', value: scaleType },\n    },\n    value: (ctx, posArgs, namedArgs) => {\n        const min = namedArgs.min as number | null | undefined\n        const max = namedArgs.max as number | null | undefined\n        const center = namedArgs.center as number | null | undefined\n        // Return a scale function that closes over these params\n        return {\n            type: 'opaque',\n            opaqueType: 'scale',\n            value: (values: number[]) => logScale(values, min ?? undefined, max ?? undefined, center ?? undefined),\n        }\n    },\n    documentation: {\n        humanReadableName: 'Logarithmic Scale',\n        category: 'scale',\n        longDescription: 'Creates a logarithmic scale that maps numeric values to a range using log transformation. Useful for data with wide ranges or exponential distributions. If min/max are not specified, they are computed from the data. Center parameter can be used to create symmetric ranges.',\n        selectorRendering: { kind: 'subtitleLongDescription' },\n    },\n} satisfies USSValue\n","import validGeographies from '../data/mapper/used_geographies'\nimport { Universe } from '../universe'\n\nimport { UrbanStatsASTStatement } from './ast'\nimport { EditorError } from './editor-utils'\nimport { USSOpaqueType, USSOpaqueValue, USSValue } from './types-values'\n\nexport type USSExecutionDescriptor = { kind: 'generic' } | { kind: 'mapper', geographyKind: typeof validGeographies[number], universe: Universe }\nexport interface USSExecutionRequest { descriptor: USSExecutionDescriptor, stmts: UrbanStatsASTStatement }\nexport type AsyncInterpretationError = EditorError[]\n\nexport interface USSExecutionResult<Value extends USSValue = USSValue> {\n    resultingValue?: Value\n    error: AsyncInterpretationError\n    context: Map<string, USSValue>\n}\n\nexport function executeAsync(request: { descriptor: { kind: 'mapper', geographyKind: typeof validGeographies[number], universe: Universe }, stmts: UrbanStatsASTStatement }): Promise<USSExecutionResult<{ type: USSOpaqueType, value: USSOpaqueValue & { opaqueType: 'cMap' | 'cMapRGB' | 'pMap' } }>>\nexport function executeAsync(request: USSExecutionRequest): Promise<USSExecutionResult>\nexport async function executeAsync(request: USSExecutionRequest): Promise<USSExecutionResult> {\n    if (sharedUSSWorker === undefined) {\n        sharedUSSWorker = createUSSWorker()\n    }\n    return await sharedUSSWorker(request)\n}\n\ntype USSWorker = (params: USSExecutionRequest) => Promise<USSExecutionResult>\n\nlet sharedUSSWorker: USSWorker | undefined\n\nconst terminationDelay = 10_000\n\nfunction createUSSWorker(): USSWorker {\n    const worker = new Worker(new URL('./worker', import.meta.url), { name: 'sharedUSSWorker' })\n    // The worker may return responses out of order, so we need to give them identifiers\n    const messageQueue = new Map<number, (result: USSExecutionResult) => void>()\n    worker.addEventListener('message', (message: MessageEvent<{ result: USSExecutionResult, id: number }>) => {\n        messageQueue.get(message.data.id)!(message.data.result)\n        messageQueue.delete(message.data.id)\n    })\n\n    // worker should terminate if not used\n    let terminationTimer: ReturnType<typeof setTimeout> | undefined\n    function resetTerminationTimer(): void {\n        clearTimeout(terminationTimer)\n        terminationTimer = setTimeout(() => {\n            if (messageQueue.size > 0) {\n                resetTerminationTimer()\n            }\n            else {\n                worker.terminate()\n                sharedUSSWorker = undefined\n            }\n        }, terminationDelay)\n    }\n    resetTerminationTimer()\n\n    let counter = 0\n    const result: USSWorker = (request) => {\n        resetTerminationTimer()\n        const id = ++counter\n        worker.postMessage({ request, id })\n        return new Promise((resolve) => {\n            messageQueue.set(id, resolve)\n        })\n    }\n\n    return result\n}\n","import { MathJaxContext } from 'better-react-mathjax'\nimport React, { ReactNode, useContext, useEffect, useState } from 'react'\nimport { Footnotes, FootnotesProvider } from 'react-a11y-footnotes'\n\nimport './style.css'\nimport './common.css'\nimport { defaultTypeEnvironment } from './mapper/context'\nimport { urlFromPageDescriptor } from './navigation/PageDescriptor'\nimport { useColors } from './page_template/colors'\nimport { PageTemplate } from './page_template/template'\nimport { StandaloneEditor } from './urban-stats-script/StandaloneEditor'\nimport { defaultConstants } from './urban-stats-script/constants/constants'\nimport { expressionOperatorMap } from './urban-stats-script/operators'\nimport { constantCategories, ConstantCategory, DocumentationTable, renderType, USSDocumentedType, USSValue } from './urban-stats-script/types-values'\nimport { DefaultMap } from './utils/DefaultMap'\nimport { assert } from './utils/defensive'\nimport { useHeaderTextClass } from './utils/responsive'\n\nexport function USSDocumentationPanel({ hash }: { hash: string }): ReactNode {\n    const textHeaderClass = useHeaderTextClass()\n\n    return (\n        <MathJaxContext>\n            <PageTemplate>\n                <FootnotesProvider>\n                    <div className=\"serif\">\n                        <div className={textHeaderClass}>USS Documentation</div>\n\n                        <Header title=\"Urban Stats Script (USS)\" header=\"h1\" ident=\"uss-title\">\n                            <p>\n                                Urban Stats Script (USS) is a scripting language for describing operations on\n                                data. It is designed to allow users to describe programs as if they refer to a\n                                single row of data, while simultaneously allowing global operations like regression.\n                            </p>\n                            <p>\n                                The basic syntax of USS should be familiar to any programmer. Arithmetic operations are\n                                written as you would expect. Feel free to edit the code below to see how the result changes:\n                            </p>\n                            <StandaloneEditor ident=\"aritmetic\" getCode={() => 'x = 2 ** 3 + 3 * 4' + '\\n' + 'y = x + 2' + '\\n' + 'y'} />\n                            <p>\n                                A full list of operators is available\n                                {' '}\n                                <a href=\"#all-operators\">here</a>\n                                .\n                            </p>\n                            <Header title=\"Lists\" header=\"h2\" ident=\"lists\">\n                                <p>\n                                    The language also supports lists, which are denoted by square brackets. You can use operators on these as well:\n                                </p>\n                                <StandaloneEditor ident=\"lists\" getCode={() => 'x = [1, 2, 3]' + '\\n' + 'y = x + [4, 5, 6]' + '\\n' + 'y'} />\n                                <p>\n                                    For details on broadcasting, see the\n                                    {' '}\n                                    <a href=\"#broadcasting\">broadcasting</a>\n                                    {' '}\n                                    section.\n                                </p>\n                            </Header>\n                            <Header title=\"Objects\" header=\"h2\" ident=\"objects\">\n                                <p>\n                                    The language also supports objects, which are denoted by curly braces. You can use operators on these as well:\n                                </p>\n                                <StandaloneEditor ident=\"objects\" getCode={() => 'x = {a: 1, b: 2}' + '\\n' + 'y = x.a + x.b' + '\\n' + 'y'} />\n                            </Header>\n                            <Header title=\"Opaque Types\" header=\"h2\" ident=\"opaque-types\">\n                                <p>\n                                    USS has several opaque types, which are types that you can only interact with via functions.\n                                    For example, colors are opaque types, and you can only create them using functions like\n                                    {' '}\n                                    <code>rgb()</code>\n                                    {', '}\n                                    <code>hsv()</code>\n                                    , or one of the predefined colors.\n                                </p>\n                                <StandaloneEditor ident=\"opaque-types\" getCode={() => 'x = rgb(0, 0, 1)' + '\\n' + 'y = hsv(0, 1, 1)' + '\\n' + '[x, y, colorRed]'} />\n                                <p>\n                                    And you can only interact with them using functions like\n                                    {' '}\n                                    <code>renderColor()</code>\n                                    {' '}\n                                    or in other contexts that use color objects.\n                                </p>\n                                <StandaloneEditor ident=\"opaque-types\" getCode={() => 'x = rgb(0, 0, 1)' + '\\n' + 'y = hsv(0, 1, 1)' + '\\n' + 'renderColor([x, y, colorRed])'} />\n                            </Header>\n                            <Header title=\"Regressions\" header=\"h2\" ident=\"regressions\">\n                                <p>\n                                    USS supports linear regression via the\n                                    {' '}\n                                    <code>regress(y, x1, x2, ..., weight)</code>\n                                    {' '}\n                                    function, which returns an object with several properties:\n                                </p>\n                                <ul>\n                                    <li>\n                                        <code>b</code>\n                                        : The intercept of the regression line.\n                                    </li>\n                                    <li>\n                                        <code>m1, m2, m3...</code>\n                                        : The coefficients for each independent variable.\n                                    </li>\n                                    <li>\n                                        <code>r2</code>\n                                        : The R-squared value of the regression.\n                                    </li>\n                                    <li>\n                                        <code>residuals</code>\n                                        : The residuals of the regression.\n                                    </li>\n                                </ul>\n                                <p>\n                                    For example, to perform a regression of y on x1 and x2, with the last point weighted more heavily, you could do:\n                                </p>\n                                <StandaloneEditor\n                                    ident=\"regression\"\n                                    getCode={\n                                        () =>\n                                            'x1 = [1, 2, 3, 4, 5]' + '\\n'\n                                            + 'x2 = [2, 3, 2, 3, 2]' + '\\n'\n                                            + 'y = [2.2, 2.8, 3.6, 4.5, 5.1]' + '\\n'\n                                            + 'w = [1, 1, 1, 1, 10]' + '\\n'\n                                            + 'model = regression(y=y, x1=x1, x2=x2, weight=w)' + '\\n'\n                                            + 'model'\n                                    }\n                                />\n                                <p>\n                                    Note that the inputs are all named arguments and the weight is optional.\n                                </p>\n                            </Header>\n                            <Header title=\"Aggregation\" header=\"h2\" ident=\"aggregation\">\n                                <p>\n                                    USS provides several functions for aggregating data, including mean, median, quantile, percentile,\n                                    min, max, sum, and more.\n                                </p>\n                                <p>\n                                    For example, to calculate the mean of a vector, you can do:\n                                </p>\n                                <StandaloneEditor ident=\"aggregation\" getCode={() => 'mean([1, 2, 3, 4, 50])'} />\n                                <p>\n                                    We can also weight the mean, for example:\n                                </p>\n                                <StandaloneEditor ident=\"aggregation\" getCode={() => 'mean([1, 2, 3, 4, 50], weights=[1, 1, 1, 1, 10])'} />\n                                <p>\n                                    The same works for median, quantile, and percentile.\n                                </p>\n                                <StandaloneEditor ident=\"aggregation\" getCode={() => 'percentile([1, 2, 3, 4, 50], 10, weights=[1, 1, 1, 1, 10])'} />\n                                <p>\n                                    On the other hand, min, max, and sum do not support weights.\n                                </p>\n                                <StandaloneEditor ident=\"aggregation\" getCode={() => 'min([1, 2, 3, 4, 50])'} />\n                            </Header>\n                            <Header title=\"Broadcasting\" header=\"h2\" ident=\"broadcasting\">\n                                <p>\n                                    Broadcasting is a feature of USS that allows you to operate on lists of values.\n                                </p>\n                                <Header title=\"Forward Broadcasting\" header=\"h3\" ident=\"forward-broadcasting\">\n                                    <p>\n                                        The main kind of broadcasting is\n                                        forward broadcasting, where you can apply operations to lists of elements. For example, if you have a list of numbers\n                                        and you want to add 1 to each of them, you can do:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting\" getCode={() => 'x = [1, 2, 3]' + '\\n' + 'y = x + 1' + '\\n' + 'y'} />\n                                    <p>\n                                        This will result in a list of numbers, where each element is 1 greater than the corresponding element in the original list.\n                                    </p>\n                                    <p>\n                                        This also works with function calls, for example:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting-function\" getCode={() => 'x = [1, 2, 3]' + '\\n' + 'y = sin(x)' + '\\n' + 'y'} />\n                                    <p>\n                                        Even when the list is of functions:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting-function-list\" getCode={() => 'x = [sin, cos, tan]' + '\\n' + 'y = x(pi)' + '\\n' + 'y'} />\n                                    <p>\n                                        You can also apply broadcasting to objects, for example:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting-object\" getCode={() => 'x = [{a: 1, b: 2}, {a: 3, b: 4}, {a: 5, b: 6}]' + '\\n' + 'y = x.a' + '\\n' + 'y'} />\n                                    <p>\n                                        And even assigning to a property:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting-object-property\" getCode={() => 'x = [{a: 1, b: 2}, {a: 3, b: 4}, {a: 5, b: 6}]' + '\\n' + 'x.a = [10, 20, 30]' + '\\n' + 'x'} />\n                                </Header>\n                                <Header title=\"Split Broadcasting\" header=\"h3\" ident=\"backward-broadcasting\">\n                                    There is also split broadcasting, which is what happens when you use an if statement.\n                                    For example, in the following code, the if statement is split into two branches, one for when y is greater than 65 and one for when it is not.\n                                    <StandaloneEditor ident=\"broadcasting\" getCode={() => 'x = [1, 2, 3]' + '\\n' + 'y = [50, 61, 70]' + '\\n' + 'if (y > 65) { x = x * 10 } else { x = x + 1 }' + '\\n' + 'x'} />\n                                    <p>\n                                        The if statement is split into two branches, one for when y is greater than 65 and one for when it is not.\n                                    </p>\n                                    <p>\n                                        Keep in mind that this is exactly two cases, rather than one for each element. Using mean() reveals this:\n                                    </p>\n                                    <StandaloneEditor ident=\"broadcasting\" getCode={() => 'x = [1, 2, 3]' + '\\n' + 'y = [50, 61, 70]' + '\\n' + 'if (y > 65) { x = mean(x) } else { x = mean(x) }' + '\\n' + 'x'} />\n                                </Header>\n                            </Header>\n                            <Header title=\"Detailed Tables\" header=\"h2\" ident=\"detailed-tables\">\n                                <Header title=\"All Operators\" header=\"h3\" ident=\"all-operators\">\n                                    <p>\n                                        The following is a list of all operators that are available in USS.\n                                    </p>\n                                    <OperatorTable />\n                                </Header>\n                            </Header>\n                            <Header title=\"Constants and Functions\" header=\"h2\" ident=\"constants\">\n                                <p>\n                                    USS provides several built-in constants and functions for mathematical operations,\n                                    data visualization, and data analysis. These are organized by category below.\n                                </p>\n                                <ConstantsDocumentation hash={hash} />\n                            </Header>\n                        </Header>\n                    </div>\n                    <Footnotes />\n                </FootnotesProvider>\n            </PageTemplate>\n        </MathJaxContext>\n    )\n}\n\nfunction createTable(colors: ReturnType<typeof useColors>, headers: string[], cells: { id?: string, row: ReactNode[] }[]): ReactNode {\n    const tableStyles = {\n        table: {\n            width: '100%',\n            borderCollapse: 'collapse' as const,\n            margin: '20px 0',\n            fontSize: '14px',\n            color: colors.textMain,\n        },\n        header: {\n            border: `1px solid ${colors.borderNonShadow}`,\n            padding: '12px',\n            textAlign: 'left' as const,\n            verticalAlign: 'top' as const,\n            backgroundColor: colors.background,\n            fontWeight: 'bold' as const,\n        },\n        cell: {\n            border: `1px solid ${colors.borderNonShadow}`,\n            padding: '12px',\n            textAlign: 'left' as const,\n            verticalAlign: 'top' as const,\n        },\n        code: {\n            backgroundColor: colors.slightlyDifferentBackground,\n            padding: '2px 4px',\n            borderRadius: '3px',\n            fontFamily: '\\'Courier New\\', monospace',\n            fontSize: '13px',\n        },\n        rowColors: {\n            even: colors.slightlyDifferentBackground,\n            odd: colors.background,\n        },\n    }\n\n    return (\n        <table style={tableStyles.table}>\n            <thead>\n                <tr>\n                    {headers.map((header, index) => (\n                        <th key={index} style={tableStyles.header}>\n                            {header}\n                        </th>\n                    ))}\n                </tr>\n            </thead>\n            <tbody>\n                {cells.map(({ row, id }, rowIndex) => (\n                    <tr\n                        id={id}\n                        key={rowIndex}\n                        style={{\n                            backgroundColor: rowIndex % 2 === 0 ? tableStyles.rowColors.even : tableStyles.rowColors.odd,\n                        }}\n                    >\n                        {row.map((cell, cellIndex) => (\n                            <td key={cellIndex} style={tableStyles.cell}>\n                                {cell}\n                            </td>\n                        ))}\n                    </tr>\n                ))}\n            </tbody>\n        </table>\n    )\n}\n\nfunction OperatorTable(): ReactNode {\n    const colors = useColors()\n\n    const headers = ['Operator', 'Type', 'Precedence', 'Description', 'Example']\n    const cells = Array.from(expressionOperatorMap.entries()).map(([operator, info]) => ({\n        row: [\n            <code key=\"operator\" style={{ backgroundColor: colors.slightlyDifferentBackground, padding: '2px 4px', borderRadius: '3px', fontFamily: '\\'Courier New\\', monospace', fontSize: '13px' }}>\n                {operator}\n            </code>,\n            info.unary && info.binary\n                ? 'Unary/Binary'\n                : info.unary\n                    ? 'Unary'\n                    : info.binary\n                        ? 'Binary'\n                        : 'Unknown',\n            info.precedence,\n            info.description,\n            info.examples.map((example, exampleIndex) => (\n                <span key={exampleIndex}>\n                    <code style={{ backgroundColor: colors.slightlyDifferentBackground, padding: '2px 4px', borderRadius: '3px', fontFamily: '\\'Courier New\\', monospace', fontSize: '13px' }}>\n                        {example}\n                    </code>\n                    {exampleIndex < info.examples.length - 1 && ', '}\n                </span>\n            )),\n        ],\n    }))\n\n    return createTable(colors, headers, cells)\n}\n\nfunction ConstantsDocumentation({ hash }: { hash: string }): ReactNode {\n    const [collapsedCategories, setCollapsedCategories] = useState<Set<string>>(new Set(constantCategories))\n\n    const mapperContext = defaultTypeEnvironment('world')\n\n    // Group constants by category\n    const constantsByCategory = new DefaultMap<ConstantCategory, [string, USSDocumentedType][]>(() => [])\n    const constantToCategory = new Map<string, ConstantCategory>()\n\n    // Add default constants\n    for (const [name, value] of defaultConstants) {\n        const category = value.documentation?.category\n        assert(category !== undefined, `Constant ${name} does not have a category defined.`)\n        constantsByCategory.get(category).push([name, value])\n        constantToCategory.set(name, category)\n    }\n\n    // Add mapper context elements\n    for (const [name, value] of mapperContext) {\n        // Skip if already added from default constants\n        if (defaultConstants.has(name)) continue\n\n        const category = value.documentation?.category\n        assert(category !== undefined, `Constant ${name} does not have a category defined.`)\n        if (constantCategories.includes(category)) {\n            constantsByCategory.get(category).push([name, value])\n            constantToCategory.set(name, category)\n        }\n    }\n\n    // Group constants by documentationTable for table display\n    const constantsByTable = new DefaultMap<DocumentationTable, [string, USSValue][]>(() => [])\n    for (const [name, value] of defaultConstants) {\n        const tableName = value.documentation?.documentationTable\n        if (tableName !== undefined) {\n            constantsByTable.get(tableName).push([name, value])\n        }\n    }\n\n    // Sort categories for consistent display\n    const categoryOrder = constantCategories\n    const sortedCategories = Array.from(constantsByCategory.entries()).sort((a, b) => {\n        const aIndex = categoryOrder.indexOf(a[0])\n        const bIndex = categoryOrder.indexOf(b[0])\n        return aIndex - bIndex\n    })\n\n    const toggleCategory = (category: ConstantCategory): void => {\n        setCollapsedCategories((prev) => {\n            const newSet = new Set(prev)\n            if (newSet.has(category)) {\n                newSet.delete(category)\n            }\n            else {\n                newSet.add(category)\n            }\n            return newSet\n        })\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- This doesn't inf loop since a new value is only returned in the set conditionally\n    useEffect(() => {\n        if (hash.startsWith(`#${constantPrefix}`)) {\n            const constantIdentifier = hash.slice(`#${constantPrefix}`.length)\n            const category = constantToCategory.get(constantIdentifier)\n            assert(category !== undefined, 'Constant does not have a category')\n            setCollapsedCategories((prev) => {\n                if (prev.has(category)) {\n                    const newSet = new Set(prev)\n                    newSet.delete(category)\n                    return newSet\n                }\n                return prev\n            })\n        }\n    })\n\n    return (\n        <div>\n            {sortedCategories.map(([category, constants]) => {\n                const isCollapsed = collapsedCategories.has(category)\n                return (\n                    <div key={category}>\n                        <div\n                            style={{\n                                cursor: 'pointer',\n                                display: 'flex',\n                                alignItems: 'center',\n                                gap: '10px',\n                                marginBottom: '10px',\n                            }}\n                            onClick={() => { toggleCategory(category) }}\n                        >\n                            <span style={{\n                                fontSize: '16px',\n                                transition: 'transform 0.2s',\n                                transform: isCollapsed ? 'rotate(0deg)' : 'rotate(90deg)',\n                            }}\n                            >\n                                \n                            </span>\n                            <h3 id={`constants-${category}`} style={{ margin: 0 }}>\n                                {getCategoryTitle(category)}\n                            </h3>\n                        </div>\n                        {!isCollapsed && (<DocumentationForCategory category={category} constants={constants} />)}\n                    </div>\n                )\n            })}\n\n        </div>\n    )\n}\n\nfunction DocumentationForCategory(props: { category: ConstantCategory, constants: [string, USSDocumentedType][] }): ReactNode {\n    const withoutTable: [string, USSDocumentedType][] = []\n    const categoryTables = new Map<DocumentationTable, [string, USSDocumentedType][]>()\n    for (const [name, value] of props.constants) {\n        const tableName = value.documentation?.documentationTable\n        if (tableName !== undefined) {\n            let cat = categoryTables.get(tableName)\n            if (cat === undefined) {\n                cat = []\n                categoryTables.set(tableName, cat)\n            }\n            cat.push([name, value])\n        }\n        else {\n            withoutTable.push([name, value])\n        }\n    }\n\n    return (\n        <>\n            <p style={{ marginLeft: '20px' }}>{getCategoryDescription(props.category)}</p>\n            {withoutTable.map(([name, value]) => (\n                <LongFormDocumentation key={name} name={name} value={value} />\n            ))}\n\n            {/* Add tables for constants with documentationTable */}\n            {(() => {\n                return Array.from(categoryTables.entries()).map(([tableName, tableConstants]) =>\n                    <ShortFormTableDocumentation key={tableName} tableName={tableName} tableConstants={tableConstants} />,\n                )\n            })()}\n        </>\n    )\n}\n\nconst constantPrefix = 'constant-'\n\nexport function LongFormDocumentation(props: { name: string, value: USSDocumentedType }): ReactNode {\n    const colors = useColors()\n    return (\n        <Header key={props.name} title={props.name} header=\"h4\" ident={`${constantPrefix}${props.name}`}>\n            <div style={{ marginBottom: '20px', marginLeft: '20px' }}>\n                <div style={{ marginBottom: '10px' }}>\n                    Type:\n                    <code style={{\n                        backgroundColor: colors.slightlyDifferentBackground,\n                        padding: '4px 8px',\n                        borderRadius: '3px',\n                        fontFamily: '\\'Courier New\\', monospace',\n                        fontSize: '13px',\n                        marginLeft: '10px',\n                    }}\n                    >\n                        {renderType(props.value.type)}\n                    </code>\n                </div>\n                <div style={{ marginBottom: '10px' }}>\n                    {props.value.documentation?.longDescription ?? 'No description available.'}\n                </div>\n                {props.value.documentation?.namedArgs && Object.keys(props.value.documentation.namedArgs).length > 0 && (\n                    <div style={{ marginBottom: '10px' }}>\n                        <strong>Named Arguments:</strong>\n                        <ul style={{ margin: '5px 0 0 20px' }}>\n                            {Object.entries(props.value.documentation.namedArgs).map(([argName, argDesc]) => (\n                                <li key={argName}>\n                                    <code style={{\n                                        backgroundColor: colors.slightlyDifferentBackground,\n                                        padding: '2px 4px',\n                                        borderRadius: '3px',\n                                        fontFamily: '\\'Courier New\\', monospace',\n                                        fontSize: '12px',\n                                    }}\n                                    >\n                                        {argName}\n                                    </code>\n                                    :\n                                    {' '}\n                                    {argDesc}\n                                </li>\n                            ))}\n                        </ul>\n                    </div>\n                )}\n                {props.value.documentation?.isDefault && (\n                    <div\n                        style={{\n                            marginBottom: '10px',\n                            color: colors.textMain,\n                            fontStyle: 'italic',\n                        }}\n                    >\n                        Default value for this type\n                    </div>\n                )}\n            </div>\n        </Header>\n    )\n}\n\nfunction ShortFormTableDocumentation(props: { tableName: DocumentationTable, tableConstants: [string, USSDocumentedType][] }): ReactNode {\n    const colors = useColors()\n    const headers = ['Name', 'Type', 'Description']\n    const cells = props.tableConstants.map(([name, value]) => ({\n        id: `${constantPrefix}${name}`,\n        row: [\n            <span key=\"name\" style={{ fontFamily: '\\'Courier New\\', monospace' }}>{name}</span>,\n            <code\n                key=\"type\"\n                style={{\n                    backgroundColor: colors.slightlyDifferentBackground,\n                    padding: '2px 4px',\n                    borderRadius: '3px',\n                    fontFamily: '\\'Courier New\\', monospace',\n                    fontSize: '12px',\n                }}\n            >\n                {renderType(value.type)}\n            </code>,\n            <span key=\"description\">\n                {value.documentation?.longDescription ?? 'No description available.'}\n                {value.documentation?.isDefault && (\n                    <span key=\"default-indicator\" style={{ fontStyle: 'italic', color: colors.textMain }}>\n                        {' '}\n                        (default)\n                    </span>\n                )}\n            </span>,\n        ],\n    }))\n\n    return (\n        <div key={props.tableName} style={{ marginTop: '20px', marginLeft: '20px' }}>\n            <h4 style={{ marginBottom: '15px' }}>{getTableTitle(props.tableName)}</h4>\n            <p style={{ marginBottom: '15px' }}>{getTableDescription(props.tableName)}</p>\n            {createTable(colors, headers, cells)}\n        </div>\n    )\n}\n\nfunction getCategoryTitle(category: ConstantCategory): string {\n    switch (category) {\n        case 'logic':\n            return 'Logic and Control'\n        case 'math':\n            return 'Mathematical Functions'\n        case 'color':\n            return 'Color Functions'\n        case 'unit':\n            return 'Unit Types'\n        case 'map':\n            return 'Map and Visualization'\n        case 'scale':\n            return 'Scaling Functions'\n        case 'ramp':\n            return 'Color Ramps'\n        case 'inset':\n            return 'Map Insets'\n        case 'regression':\n            return 'Statistical Analysis'\n        case 'basic':\n            return 'Basic Functions'\n        case 'mapper':\n            return 'Mapper Data Variables'\n        case 'richText':\n            return 'Rich Text Formatting'\n    }\n}\n\nfunction getCategoryDescription(category: ConstantCategory): string {\n    switch (category) {\n        case 'logic':\n            return 'Boolean values and control flow constants.'\n        case 'math':\n            return 'Mathematical functions for arithmetic, trigonometry, and statistical operations.'\n        case 'color':\n            return 'Functions for creating and manipulating colors using RGB, HSV, and predefined color palettes.'\n        case 'unit':\n            return 'Unit type constants for specifying measurement units in data visualization.'\n        case 'map':\n            return 'Functions for creating choropleth maps, point maps, and map styling.'\n        case 'scale':\n            return 'Functions for scaling numeric data to visualization ranges.'\n        case 'ramp':\n            return 'Functions for creating and manipulating color ramps for data visualization.'\n        case 'inset':\n            return 'Functions for creating map insets and managing multiple map views.'\n        case 'regression':\n            return 'Statistical analysis functions for linear regression.'\n        case 'basic':\n            return 'Basic utility functions for type conversion and common operations.'\n        case 'mapper':\n            return 'The mapper provides several variables relevant to the current universe and set of geographic features.'\n        case 'richText':\n            return 'Functions for rich text formatting.'\n    }\n}\n\nfunction getTableTitle(tableName: DocumentationTable): string {\n    switch (tableName) {\n        case 'predefined-colors':\n            return 'Predefined Color Constants'\n        case 'unit-types':\n            return 'Unit Type Constants'\n        case 'predefined-ramps':\n            return 'Predefined Color Ramps'\n        case 'predefined-insets':\n            return 'Predefined Map Insets'\n        case 'logarithm-functions':\n            return 'Logarithm Functions'\n        case 'trigonometric-functions':\n            return 'Trigonometric Functions'\n        case 'mapper-data-variables':\n            return 'Mapper Data Variables'\n    }\n}\n\nfunction getTableDescription(tableName: DocumentationTable): string {\n    switch (tableName) {\n        case 'predefined-colors':\n            return 'Built-in color constants for common colors like red, blue, green, etc. Each color can be used directly in USS expressions.'\n        case 'unit-types':\n            return 'Unit type constants for specifying measurement units in data visualization and analysis.'\n        case 'predefined-ramps':\n            return 'Predefined color ramps for mapping numeric values to colors in data visualizations.'\n        case 'predefined-insets':\n            return 'Predefined map inset configurations for common geographic regions and territories.'\n        case 'logarithm-functions':\n            return 'Mathematical functions for computing logarithms with different bases (natural, base-10, base-2).'\n        case 'trigonometric-functions':\n            return 'Mathematical functions for trigonometric calculations (sine, cosine, arccosine, etc.).'\n        case 'mapper-data-variables':\n            return 'Variables used in the mapper.'\n    }\n}\n\nfunction Header(props: { title: string, header: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6', ident: string, children: ReactNode }): ReactNode {\n    const linkKind = useContext(linkContext)\n\n    return (\n        <>\n            <props.header id={props.ident}>\n                {linkKind === 'link'\n                    ? (\n                            <a href={urlFromPageDescriptor({ kind: 'ussDocumentation', hash: props.ident }).toString()} target=\"_blank\" rel=\"noreferrer\">\n                                {props.title}\n                            </a>\n                        )\n                    : props.title}\n            </props.header>\n            {props.children}\n        </>\n    )\n}\n\nexport const linkContext = React.createContext<'reference' | 'link'>('reference')\n"],"names":["defaultTypeEnvironment","universe","te","Map","_iteratorError","defaultConstants","key","value","undefined","loadInsetExpression","_iteratorError1","statistic_variables_info","variableInfo","order","_iteratorError2","_Math","name","info","individualPriorities","varName","v","assert","minPriority","loadInsets","insetsU","insets","inset","exprs","names","x","expr","insetNameToConstantName","noLocation","Editor","param","uss","setUss","typeEnvironment","results","placeholder","selection","setSelection","eRef","setSelectionRef","useRef","script","useMemo","makeScript","colors","useColors","editorRef","_useState","popoverState","setPopoverState","_useState1","autocompleteSelectionIdx","setAutocompleteSelectionIdx","spanTokenMapRef","renderScript","useCallback","newScript","fragment","renderCode","r","token","content","text","span","document","t","createPlaceholder","editor","_editor","lastRenderScript","lastScript","useEffect","setRange","editScript","newUss","newRange","listener","range","getRange","s","nodeContent","tokenValue","options","getAutocompleteOptions","createAutocompleteMenu","apply","optionIdx","option","delta","e","i","range1","hoveredToken","event","elem","opts","elemOffset","totalOffset","setTimeout","createDocumentationPopover","borderColor","useResultsColor","colorKey","codeStyle","TestUtils","DisplayResults","createPortal","Autocomplete","linkContext","LongFormDocumentation","cKey","props","color","border","style","error","_","errors","longMessage","index","AutocompleteOption","hovering","setHovering","optionRef","_optionRef_current","StandaloneEditor","_useStandaloneEditorState","undoRedoUi","useStandaloneEditorState","ident","getCode","onChange","getSelection","undoRedoOptions","setResults","ussVersion","_useState2","updateUss","version","stmts","exec","parse","executeAsync","_useUndoRedo","addState","updateCurrentSelection","newSelection","instantiate","descriptor","min","max","_instantiate","forward","inverse","Math","scaleType","linearScale","values","center","isNaN","isFinite","_Math1","computedMin","computedMax","Error","linearScaleValue","createConstantExpression","ctx","posArgs","namedArgs","logScaleValue","sharedUSSWorker","request","createUSSWorker","terminationTimer","worker","Worker","URL","messageQueue","resetTerminationTimer","clearTimeout","message","counter","id","Promise","resolve","USSDocumentationPanel","hash","textHeaderClass","useHeaderTextClass","MathJaxContext","PageTemplate","FootnotesProvider","Header","OperatorTable","ConstantsDocumentation","Footnotes","createTable","headers","cells","tableStyles","header","rowIndex","row","cell","cellIndex","Array","expressionOperatorMap","operator","example","exampleIndex","Set","constantCategories","collapsedCategories","setCollapsedCategories","mapperContext","constantsByCategory","DefaultMap","constantToCategory","_value_documentation","category","_value_documentation1","name1","value1","category1","constantsByTable","_value_documentation2","name2","value2","tableName","categoryOrder","sortedCategories","a","b","aIndex","toggleCategory","prev","newSet","constantPrefix","constantIdentifier","constants","isCollapsed","getCategoryTitle","DocumentationForCategory","withoutTable","categoryTables","cat","getCategoryDescription","tableConstants","ShortFormTableDocumentation","_props_value_documentation_longDescription","_props_value_documentation1","_props_value_documentation2","renderType","Object","argName","argDesc","_value_documentation_longDescription","getTableTitle","getTableDescription","linkKind","useContext","urlFromPageDescriptor","React"],"mappings":"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"}