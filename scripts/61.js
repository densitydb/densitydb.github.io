"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([["61"],{37099:function(e,t,n){n.r(t),n.d(t,{ScreenshotDiffViewerPanel:()=>g});var r=n(74318),o=n(72668),a=n(88609),i=n(6381),c=n(41623),l=n(79074),u=n(2414);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){n(e);return}c.done?t(l):Promise.resolve(l).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,c,"next",e)}function c(e){f(a,r,o,i,c,"throw",e)}i(void 0)})}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}})(e,t,n||e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}function v(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){var u=[c,l];if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}}function g(e){var t=e.hash,n=e.artifactId,a=e.index,i=(0,o.useMemo)(function(){return h(function(){return v(this,function(e){switch(e.label){case 0:var t;return[4,(t=n,new r.Mr(new k(t))).getEntries()];case 1:return[2,e.sent().filter(function(e){return!e.directory})]}})})()},[n]);return o.createElement(o.Fragment,null,o.createElement("style",null,"\n\n.wrapper {\n    container-type: size;\n    inset: 0;\n    position: absolute;\n}\n\n.container {\n    display: flex;\n    gap: 10px;\n}\n\n@container (aspect-ratio < 1) {\n    .container {\n        flex-direction: column;\n    }\n    \n    img {\n        max-height: 30vh;\n        max-width: 90vw;\n    }\n}\n\n@container (aspect-ratio >= 1) {\n    .container {\n        flex-direction: row;\n    }\n\n    img {\n        max-width: 30vw;\n        max-height: 90vh;\n    }\n}\n"),o.createElement(E,{node:i.then(function(e){return o.createElement(w,{hash:t,entries:e,index:a,artifactId:n})})}))}function w(e){var t,n,r=e.hash,a=e.entries,c=e.index,l=e.artifactId,u=(0,o.useMemo)(function(){return a.map(function(e){return{entry:e,match:/changed_screenshots\/([^\/]+)\/[^\/]+\/(.+)\.png$/.exec(e.filename)}}).filter(function(e){return null!==e.match}).sort(function(e,t){return e.entry.filename.localeCompare(t.entry.filename)}).map(function(e){var t,n=e.entry,r=(t=e.match,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,c=!1;try{for(o=o.call(e);!(i=(n=o.next()).done)&&(a.push(n.value),a.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(c)throw r}}return a}}(t,3)||function(e,t){if(e){if("string"==typeof e)return s(e,3);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(t,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[1],i=r[2],c=a.find(function(e){var t,n;return e.filename===(t=o,n=i,"delta/".concat(t,"/Chrome/").concat(n,".png"))});return{changed:j(n),delta:c?j(c):void 0,test:o,file:i}})},[a]),f=(0,o.useContext)(i.C.Context);return((0,o.useEffect)(function(){var e=function(e){"ArrowLeft"===e.key?c>0&&f.navigate({kind:"screenshotDiffViewer",hash:r,artifactId:l,index:c-1},{history:"push",scroll:{kind:"position",top:0}}):"ArrowRight"===e.key&&c<u.length-1&&f.navigate({kind:"screenshotDiffViewer",hash:r,artifactId:l,index:c+1},{history:"push",scroll:{kind:"position",top:0}})};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[u.length,f,l,r,c]),(0,o.useEffect)(function(){u.slice(Math.max(0,c-2),Math.min(u.length,c+2+1)).forEach(function(e){var t;e.changed.load(),null==(t=e.delta)||t.load()})},[u,c]),0===u.length)?o.createElement("div",null,o.createElement("h1",null,"No Entries")):c>=u.length||c<0?o.createElement("div",null,o.createElement("h1",null,"Out of Range")):o.createElement(O,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){p(e,t,n[t])})}return e}({},u[c]),n=n={hash:r,index:c,total:u.length},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}function O(e){var t,n,r,a=e.test,i=e.file,c=e.hash,l=e.delta,u=e.changed,s=e.index,f=e.total;return o.createElement("div",{className:"wrapper"},o.createElement("div",null,o.createElement("h2",null,"(",s+1," ","/"," ",f,")"," ",a," ","/"," ",i)),o.createElement("div",{className:"container"},l?o.createElement(o.Fragment,null,o.createElement("div",null,o.createElement("img",{src:(t=c,n=a,r=i,encodeURI("https://raw.githubusercontent.com/kavigupta/urbanstats/".concat(t,"/reference_test_screenshots/").concat(n,"/Chrome/").concat(r,".png")))})),o.createElement("div",null,o.createElement(E,{node:l.get}))):o.createElement("div",null,o.createElement("h1",null,"New File")),o.createElement("div",null,o.createElement(E,{node:u.get}))))}function E(e){var t=e.node,n=(0,u.a)(t),r=n.result,a=n.loading;return void 0===r||a?o.createElement(c.WU,null):r}var k=function(e){var t;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function n(e){var t,r,o;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");return r=y(r=n),p(t=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,b()?Reflect.construct(r,[],y(this).constructor):r.apply(this,o)),"artifactId",void 0),p(t,"size",void 0),p(t,"url",void 0),p(t,"blockSize",void 0),p(t,"blocks",void 0),t.artifactId=e,t.size=0,t.url="",t.blockSize=1e6,t.blocks=new l.G(function(e){return h(function(){var n,r,o,a;return v(this,function(i){switch(i.label){case 0:return r=Math.min((n=e*t.blockSize)+t.blockSize-1,t.size-1),[4,fetch(t.url,{headers:{Range:"bytes=".concat(n,"-").concat(r)}})];case 1:if(!(o=i.sent()).ok)throw Error("HTTP error! status: ".concat(o.status));return a=Uint8Array.bind,[4,o.arrayBuffer()];case 2:return[2,new(a.apply(Uint8Array,[void 0,i.sent()]))]}})})()}),t}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&m(n,e),t=[{key:"init",value:function(){var e=this;return h(function(){var t,r;return v(this,function(o){switch(o.label){case 0:return[4,null==(t=d(y(n.prototype),"init",e))?void 0:t.call(this)];case 1:return o.sent(),[4,fetch("https://api.github.com/repos/kavigupta/urbanstats/actions/artifacts/".concat(this.artifactId,"/zip"),{method:"HEAD",headers:{Authorization:"Bearer ".concat(function(){for(var e=localStorage.getItem("github-personal-access-token");null===e;)e=prompt("Github Personal Access Token");return localStorage.setItem("github-personal-access-token",e),e}())}})];case 2:return r=o.sent(),this.size=a.z.coerce.number().parse(r.headers.get("Content-Length")),this.url=r.url,[2]}})}).call(this)}},{key:"readUint8Array",value:function(e,t){return h(function(){var n,r,o,a,i,c,l;return v(this,function(u){switch(u.label){case 0:n=new Uint8Array(t),r=0,u.label=1;case 1:if(!(r<t))return[3,3];return a=Math.floor((o=e+r)/this.blockSize),i=o%this.blockSize,[4,this.blocks.get(a)];case 2:return c=u.sent(),l=Math.min(t-r,this.blockSize-i,c.length-i),n.set(c.slice(i,i+l),r),r+=l,[3,1];case 3:return[2,n]}})}).call(this)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,t),n}(r.Ej);function j(e){var t;return{load:function(){t()},get:h(function(){var n,a;return v(this,function(i){switch(i.label){case 0:return[4,new Promise(function(e){t=e})];case 1:return i.sent(),n=new r._1("image/png"),[4,e.getData(n)];case 2:return i.sent(),[4,n.getData()];case 3:return a=i.sent(),[2,o.createElement("img",{src:a})]}})})()}}},2414:function(e,t,n){n.d(t,{a:()=>i});var r=n(72668),o=n(51647);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t,n=(t=(0,r.useState)({promise:e,result:void 0,loading:!0}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,c=!1;try{for(o=o.call(e);!(i=(n=o.next()).done)&&(a.push(n.value),a.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(c)throw r}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return a(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],c=n[1];return(0,r.useEffect)(function(){c(function(t){return{promise:e,result:t.result,loading:!0}}),o.k.shared.startLoading(),e.then(function(t){c(function(n){return n.promise===e?{promise:e,result:t,loading:!1}:n})},function(){c(function(t){return t.promise===e?{promise:e,result:void 0,loading:!1}:t})}).finally(function(){o.k.shared.finishLoading()})},[e]),i}}}]);
//# sourceMappingURL=61.js.map